<!DOCTYPE html>
<!-- Generated by Cython 0.29.32 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: asymm_scroll_geo.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.32</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="asymm_scroll_geo.cpp">asymm_scroll_geo.cpp</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: cimport PDSim.scroll.common_scroll_geo as common</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: from PDSim.scroll.common_scroll_geo cimport _dcoords_inv_dphi_int,_coords_inv_d, coords_inv, coords_inv_dtheta, coords_norm, get_compression_chamber_index</pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: from PDSim.scroll.common_scroll_geo cimport Gr, dGr_dtheta, dGr_dphi, INVOLUTE_FI, INVOLUTE_FO, INVOLUTE_OI, INVOLUTE_OO</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: from PDSim.scroll.common_scroll_geo cimport fFx_p,fFy_p,fMO_p</pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: cimport PDSim.scroll.symm_scroll_geo as symm_scroll_geo</pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">007</span>: from PDSim.scroll.common_scroll_geo import polycentroid, polyarea</pre>
<pre class='cython code score-29 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_polycentroid);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_polycentroid);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_polycentroid);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_polyarea);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_polyarea);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_polyarea);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_PDSim_scroll_common_scroll_geo, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_polycentroid);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_polycentroid, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_polyarea);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_polyarea, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: from libc.math cimport sqrt,sin,cos,tan,atan2,acos,floor,M_PI as pi,pow,atan</pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">011</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">012</span>: cimport numpy as np</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">013</span>: import matplotlib.pyplot as plt</pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s__9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s__9);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_matplotlib_pyplot, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_plt, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">014</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">015</span>: # Define python variables in this module for the integer</pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>: # constants for the control volumes</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">017</span>: keyIsa = common.keyIsa</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIsa);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIsa, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">018</span>: keyIs1 = common.keyIs1</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIs1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIs1, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">019</span>: keyIs2 = common.keyIs2</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIs2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIs2, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">020</span>: keyId1 = common.keyId1</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyId1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyId1, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">021</span>: keyId2 = common.keyId2</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyId2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyId2, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">022</span>: keyIdd = common.keyIdd</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIdd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIdd, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">023</span>: keyIddd = common.keyIddd</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIddd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIddd, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">024</span>: keyIc1_1 = common.keyIc1_1</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIc1_1, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">025</span>: keyIc1_2 = common.keyIc1_2</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIc1_2, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">026</span>: keyIc1_3 = common.keyIc1_3</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIc1_3, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">027</span>: keyIc1_4 = common.keyIc1_4</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 27, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIc1_4, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 27, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">028</span>: keyIc1_5 = common.keyIc1_5</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIc1_5, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">029</span>: keyIc2_1 = common.keyIc2_1</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIc2_1, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">030</span>: keyIc2_2 = common.keyIc2_2</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIc2_2, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">031</span>: keyIc2_3 = common.keyIc2_3</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIc2_3, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">032</span>: keyIc2_4 = common.keyIc2_4</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIc2_4, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">033</span>: keyIc2_5 = common.keyIc2_5</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = __Pyx_PyInt_From_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices(__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_keyIc2_5, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">034</span>: </pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">035</span>: cpdef inline double Danfossmin2(double a, double b):</pre>
<pre class='cython code score-55 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_1Danfossmin2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static CYTHON_INLINE double __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Danfossmin2(double __pyx_v_a, double __pyx_v_b, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Danfossmin2", 0);
  <span class='trace'>__Pyx_TraceCall</span>("Danfossmin2", __pyx_f[0], 35, 0, <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("DanfossPDSim.asymm_scroll_geo.Danfossmin2", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_1Danfossmin2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_Danfossmin2[] = "Danfossmin2(double a, double b) -&gt; double";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_1Danfossmin2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_a;
  double __pyx_v_b;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Danfossmin2 (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_a,&amp;__pyx_n_s_b,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_b)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Danfossmin2", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Danfossmin2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_a = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_a == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L3_error)</span>
    __pyx_v_b = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_b == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Danfossmin2", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.Danfossmin2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_Danfossmin2(__pyx_self, __pyx_v_a, __pyx_v_b);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_Danfossmin2(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_a, double __pyx_v_b) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Danfossmin2", 0);
  <span class='trace'>__Pyx_TraceCall</span>("Danfossmin2 (wrapper)", __pyx_f[0], 35, 0, <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Danfossmin2(__pyx_v_a, __pyx_v_b, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.Danfossmin2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">036</span>:     return a if a&lt;b else b</pre>
<pre class='cython code score-0 '>  if (((__pyx_v_a &lt; __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">037</span>: </pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">038</span>: cpdef inline double Danfossmax2(double a, double b):</pre>
<pre class='cython code score-55 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_3Danfossmax2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static CYTHON_INLINE double __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Danfossmax2(double __pyx_v_a, double __pyx_v_b, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Danfossmax2", 0);
  <span class='trace'>__Pyx_TraceCall</span>("Danfossmax2", __pyx_f[0], 38, 0, <span class='error_goto'>__PYX_ERR(0, 38, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("DanfossPDSim.asymm_scroll_geo.Danfossmax2", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_3Danfossmax2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_2Danfossmax2[] = "Danfossmax2(double a, double b) -&gt; double";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_3Danfossmax2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_a;
  double __pyx_v_b;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Danfossmax2 (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_a,&amp;__pyx_n_s_b,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_b)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Danfossmax2", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 38, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Danfossmax2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 38, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_a = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_a == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 38, __pyx_L3_error)</span>
    __pyx_v_b = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_b == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 38, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Danfossmax2", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 38, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.Danfossmax2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_2Danfossmax2(__pyx_self, __pyx_v_a, __pyx_v_b);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_2Danfossmax2(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_a, double __pyx_v_b) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Danfossmax2", 0);
  <span class='trace'>__Pyx_TraceCall</span>("Danfossmax2 (wrapper)", __pyx_f[0], 38, 0, <span class='error_goto'>__PYX_ERR(0, 38, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Danfossmax2(__pyx_v_a, __pyx_v_b, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.Danfossmax2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">039</span>:     return a if a&gt;b else b</pre>
<pre class='cython code score-0 '>  if (((__pyx_v_a &gt; __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">040</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">041</span>: cdef bint overlap(double minv1, double maxv1, double minv2, double maxv2, double *min, double *max):</pre>
<pre class='cython code score-2 '>static int __pyx_f_12DanfossPDSim_16asymm_scroll_geo_overlap(double __pyx_v_minv1, double __pyx_v_maxv1, double __pyx_v_minv2, double __pyx_v_maxv2, double *__pyx_v_min, double *__pyx_v_max) {
  double __pyx_v_e;
  double __pyx_v__min;
  double __pyx_v__max;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("overlap", 0);
  <span class='trace'>__Pyx_TraceCall</span>("overlap", __pyx_f[0], 41, 0, <span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("DanfossPDSim.asymm_scroll_geo.overlap", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">042</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>:     Returns True if the ranges overlap, with the pointers to the overlap range</pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">045</span>:     cdef double e = 1e-14 #epsilon to deal with floating point accuracy</pre>
<pre class='cython code score-0 '>  __pyx_v_e = 1e-14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">046</span>:     cdef double _min = Danfossmax2(minv1, minv2)</pre>
<pre class='cython code score-0 '>  __pyx_v__min = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Danfossmax2(__pyx_v_minv1, __pyx_v_minv2, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">047</span>:     cdef double _max = Danfossmin2(maxv1, maxv2)</pre>
<pre class='cython code score-0 '>  __pyx_v__max = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Danfossmin2(__pyx_v_maxv1, __pyx_v_maxv2, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">048</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>:     if minv1-e &lt;= _max &lt;= maxv1+e and minv2-e &lt;= _max &lt;= maxv2+e and minv1-e &lt;= _min &lt;= maxv2+e and minv2-e &lt;= _min &lt;= maxv2+e:</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_minv1 - __pyx_v_e) &lt;= __pyx_v__max);
  if (__pyx_t_2) {
    __pyx_t_2 = (__pyx_v__max &lt;= (__pyx_v_maxv1 + __pyx_v_e));
  }
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
  } else {
    __pyx_t_1 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = ((__pyx_v_minv2 - __pyx_v_e) &lt;= __pyx_v__max);
  if (__pyx_t_3) {
    __pyx_t_3 = (__pyx_v__max &lt;= (__pyx_v_maxv2 + __pyx_v_e));
  }
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_minv1 - __pyx_v_e) &lt;= __pyx_v__min);
  if (__pyx_t_2) {
    __pyx_t_2 = (__pyx_v__min &lt;= (__pyx_v_maxv2 + __pyx_v_e));
  }
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
  } else {
    __pyx_t_1 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = ((__pyx_v_minv2 - __pyx_v_e) &lt;= __pyx_v__min);
  if (__pyx_t_3) {
    __pyx_t_3 = (__pyx_v__min &lt;= (__pyx_v_maxv2 + __pyx_v_e));
  }
  __pyx_t_2 = (__pyx_t_3 != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">050</span>:         min[0] = _min</pre>
<pre class='cython code score-0 '>    (__pyx_v_min[0]) = __pyx_v__min;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">051</span>:         max[0] = _max</pre>
<pre class='cython code score-0 '>    (__pyx_v_max[0]) = __pyx_v__max;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">052</span>:         return True</pre>
<pre class='cython code score-0 '>    __pyx_r = 1;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">053</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">054</span>:         return False</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">055</span>: </pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">056</span>: cpdef tuple sortAnglesCCW(double t1, double t2):</pre>
<pre class='cython code score-53 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_5sortAnglesCCW(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_sortAnglesCCW(double __pyx_v_t1, double __pyx_v_t2, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sortAnglesCCW", 0);
  <span class='trace'>__Pyx_TraceCall</span>("sortAnglesCCW", __pyx_f[0], 56, 0, <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.sortAnglesCCW", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_5sortAnglesCCW(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_4sortAnglesCCW[] = "sortAnglesCCW(double t1, double t2) -&gt; tuple\n\n    Sort angles so that t2&gt;t1 in a counter-clockwise sense\n    idea from `StackOverflow &lt;http://stackoverflow.com/questions/242404/sort-four-points-in-clockwise-order&gt;`_\n    more description: `SoftSurfer &lt;http://softsurfer.com/Archive/algorithm_0101/algorithm_0101.htm&gt;`_\n\n    If the signed area of the triangle formed between the points on a unit circle with angles t1 and t2\n    and the origin is positive, the angles are sorted counterclockwise. Otherwise, the angles\n    are sorted in a counter-clockwise manner.  Here we want the angles to be sorted CCW, so\n    if area is negative, swap angles\n    \n    Area obtained from the cross product of a vector from origin \n    to 1 and a vector to point 2, so use right hand rule to get \n    sign of cross product with unit length\n    ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_5sortAnglesCCW(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_t1;
  double __pyx_v_t2;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sortAnglesCCW (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_t1,&amp;__pyx_n_s_t2,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_t1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_t2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sortAnglesCCW", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sortAnglesCCW") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_t1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_t1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L3_error)</span>
    __pyx_v_t2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_t2 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sortAnglesCCW", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.sortAnglesCCW", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_4sortAnglesCCW(__pyx_self, __pyx_v_t1, __pyx_v_t2);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_4sortAnglesCCW(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_t1, double __pyx_v_t2) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sortAnglesCCW", 0);
  <span class='trace'>__Pyx_TraceCall</span>("sortAnglesCCW (wrapper)", __pyx_f[0], 56, 0, <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_sortAnglesCCW(__pyx_v_t1, __pyx_v_t2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.sortAnglesCCW", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">057</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>:     Sort angles so that t2&gt;t1 in a counter-clockwise sense</pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>:     idea from `StackOverflow &lt;http://stackoverflow.com/questions/242404/sort-four-points-in-clockwise-order&gt;`_</pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>:     more description: `SoftSurfer &lt;http://softsurfer.com/Archive/algorithm_0101/algorithm_0101.htm&gt;`_</pre>
<pre class="cython line score-0">&#xA0;<span class="">061</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">062</span>:     If the signed area of the triangle formed between the points on a unit circle with angles t1 and t2</pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>:     and the origin is positive, the angles are sorted counterclockwise. Otherwise, the angles</pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>:     are sorted in a counter-clockwise manner.  Here we want the angles to be sorted CCW, so</pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>:     if area is negative, swap angles</pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>:     Area obtained from the cross product of a vector from origin</pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>:     to 1 and a vector to point 2, so use right hand rule to get</pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>:     sign of cross product with unit length</pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">072</span>:     if (cos(t1)*sin(t2)-cos(t2)*sin(t1)&lt;0):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((((cos(__pyx_v_t1) * sin(__pyx_v_t2)) - (cos(__pyx_v_t2) * sin(__pyx_v_t1))) &lt; 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">073</span>:         # Swap angles</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">074</span>:         t1,t2 = t2,t1</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_t2;
    __pyx_t_3 = __pyx_v_t1;
    __pyx_v_t1 = __pyx_t_2;
    __pyx_v_t2 = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">075</span>:     while (t1 &gt; t2):</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = ((__pyx_v_t1 &gt; __pyx_v_t2) != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">076</span>:         # Make t2 bigger than t1</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">077</span>:         t2=t2 + 2*pi;</pre>
<pre class='cython code score-0 '>    __pyx_v_t2 = (__pyx_v_t2 + (2.0 * M_PI));
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">078</span>:     return (t1,t2)</pre>
<pre class='cython code score-18 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_t1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_t2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_r = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">079</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">080</span>: cdef class DanfossGeoVals(geoVals):</pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals {
  struct __pyx_vtabstruct_5PDSim_6scroll_17common_scroll_geo_geoVals __pyx_base;
};
static struct __pyx_vtabstruct_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_vtabptr_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals;
</pre><pre class="cython line score-0">&#xA0;<span class="">081</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">082</span>:     This is a custom class that add the geometric parameters that are</pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>:     required for the three-arc PMP</pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>:     def __repr__(self):</pre>
<pre class='cython code score-8 '>/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_14DanfossGeoVals_1__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_14DanfossGeoVals_1__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_14DanfossGeoVals___repr__(((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_14DanfossGeoVals___repr__(struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_self) {
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_v_atr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__repr__", __pyx_f[0], 86, 0, <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DanfossGeoVals.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_atr);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">087</span>:         s = "(Danfoss-hybrid)" + geoVals.__repr__(self)</pre>
<pre class='cython code score-22 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals), __pyx_n_s_repr);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_v_self)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_Danfoss_hybrid, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_s = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">088</span>:         for atr in ['xa_arc3','ya_arc3','ra_arc3','t1_arc3','t2_arc3']:</pre>
<pre class='cython code score-11 '>  __pyx_t_2 = __pyx_tuple_; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4 = 0;
  for (;;) {
    if (__pyx_t_4 &gt;= 5) break;
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L1_error)</span>
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 88, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atr, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_xa_arc3, __pyx_n_s_ya_arc3, __pyx_n_s_ra_arc3, __pyx_n_s_t1_arc3, __pyx_n_s_t2_arc3);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 88, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">089</span>:             s += atr+': '+str(getattr(self,atr))+'\n'</pre>
<pre class='cython code score-30 '>    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_atr, __pyx_kp_s__2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_v_atr);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_kp_s__3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">090</span>:         return s</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_s);
  __pyx_r = __pyx_v_s;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">091</span>: </pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">092</span>: cpdef tuple phi_s1_sa(double theta, DanfossGeoVals geo):</pre>
<pre class='cython code score-45 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_7phi_s1_sa(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_phi_s1_sa(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_A;
  double __pyx_v_B;
  double __pyx_v_C;
  double __pyx_v_S;
  double __pyx_v_u1;
  double __pyx_v_u2;
  double __pyx_v_ro_rb;
  double __pyx_v_dA_dtheta;
  double __pyx_v_dB_dtheta;
  double __pyx_v_delta1;
  double __pyx_v_delta2;
  double __pyx_v_du1_dA;
  double __pyx_v_du2_dA;
  double __pyx_v_du1_dB;
  double __pyx_v_du2_dB;
  double __pyx_v_ddelta1_dtheta;
  double __pyx_v_ddelta2_dtheta;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("phi_s1_sa", 0);
  <span class='trace'>__Pyx_TraceCall</span>("phi_s1_sa", __pyx_f[0], 92, 0, <span class='error_goto'>__PYX_ERR(0, 92, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.phi_s1_sa", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_7phi_s1_sa(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_6phi_s1_sa[] = "phi_s1_sa(double theta, DanfossGeoVals geo) -&gt; tuple\n\n    # As in Bell, DOI: 10.1016/j.ijrefrig.2014.05.029 - typo in published work, C=-1, not C=1\n    r_b,ro,phi_oie,phi_i0,phi_o0,phi_fie,theta,delta = symbols('r_b,ro,phi_oie,phi_i0,phi_o0,phi_fie,theta,delta')\n    ro = r_b*pi - r_b*(phi_i0-phi_o0) #rb*pi-t\n    om = phi_fie - theta + 3*pi/2\n    # End point on fixed scroll\n    xfi = r_b*cos(phi_fie)+r_b*(phi_fie-phi_i0)*sin(phi_fie)\n    yfi = r_b*sin(phi_fie)-r_b*(phi_fie-phi_i0)*cos(phi_fie)\n    # Other point on orbiting scroll\n    phi_ssa = phi_fie - pi + delta\n    xssa = -r_b*cos(phi_ssa)-r_b*(phi_ssa-phi_o0)*sin(phi_ssa)+ro*cos(om)\n    yssa = -r_b*sin(phi_ssa)+r_b*(phi_ssa-phi_o0)*cos(phi_ssa)+ro*sin(om)\n    d2 = (xfi-xssa)**2+(yfi-yssa)**2 # squared distance\n    factor(expand_trig(simplify((diff(d2, delta)))),[sin(delta),cos(delta)])\n    ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_7phi_s1_sa(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("phi_s1_sa (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("phi_s1_sa", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 92, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "phi_s1_sa") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 92, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 92, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("phi_s1_sa", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 92, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.phi_s1_sa", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 92, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_6phi_s1_sa(__pyx_self, __pyx_v_theta, __pyx_v_geo);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_6phi_s1_sa(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("phi_s1_sa", 0);
  <span class='trace'>__Pyx_TraceCall</span>("phi_s1_sa (wrapper)", __pyx_f[0], 92, 0, <span class='error_goto'>__PYX_ERR(0, 92, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_phi_s1_sa(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.phi_s1_sa", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">093</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">094</span>:     # As in Bell, DOI: 10.1016/j.ijrefrig.2014.05.029 - typo in published work, C=-1, not C=1</pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>:     r_b,ro,phi_oie,phi_i0,phi_o0,phi_fie,theta,delta = symbols('r_b,ro,phi_oie,phi_i0,phi_o0,phi_fie,theta,delta')</pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>:     ro = r_b*pi - r_b*(phi_i0-phi_o0) #rb*pi-t</pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>:     om = phi_fie - theta + 3*pi/2</pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>:     # End point on fixed scroll</pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>:     xfi = r_b*cos(phi_fie)+r_b*(phi_fie-phi_i0)*sin(phi_fie)</pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>:     yfi = r_b*sin(phi_fie)-r_b*(phi_fie-phi_i0)*cos(phi_fie)</pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>:     # Other point on orbiting scroll</pre>
<pre class="cython line score-0">&#xA0;<span class="">102</span>:     phi_ssa = phi_fie - pi + delta</pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>:     xssa = -r_b*cos(phi_ssa)-r_b*(phi_ssa-phi_o0)*sin(phi_ssa)+ro*cos(om)</pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>:     yssa = -r_b*sin(phi_ssa)+r_b*(phi_ssa-phi_o0)*cos(phi_ssa)+ro*sin(om)</pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>:     d2 = (xfi-xssa)**2+(yfi-yssa)**2 # squared distance</pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>:     factor(expand_trig(simplify((diff(d2, delta)))),[sin(delta),cos(delta)])</pre>
<pre class="cython line score-0">&#xA0;<span class="">107</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>:     cdef double A,B,C,S,u1,u2</pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">110</span>:     ro_rb = geo.ro/geo.rb</pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_geo-&gt;__pyx_base.rb == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span>
  }
  __pyx_v_ro_rb = (__pyx_v_geo-&gt;__pyx_base.ro / __pyx_v_geo-&gt;__pyx_base.rb);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">111</span>:     A = (geo.phi_fi0-geo.phi_fie)+ro_rb*cos(theta)</pre>
<pre class='cython code score-0 '>  __pyx_v_A = ((__pyx_v_geo-&gt;__pyx_base.phi_fi0 - __pyx_v_geo-&gt;__pyx_base.phi_fie) + (__pyx_v_ro_rb * cos(__pyx_v_theta)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">112</span>:     dA_dtheta = -ro_rb*sin(theta)</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_dtheta = ((-__pyx_v_ro_rb) * sin(__pyx_v_theta));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">113</span>:     B = 1+ro_rb*sin(theta)</pre>
<pre class='cython code score-0 '>  __pyx_v_B = (1.0 + (__pyx_v_ro_rb * sin(__pyx_v_theta)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>:     dB_dtheta = ro_rb*cos(theta)</pre>
<pre class='cython code score-0 '>  __pyx_v_dB_dtheta = (__pyx_v_ro_rb * cos(__pyx_v_theta));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:     C = -1</pre>
<pre class='cython code score-0 '>  __pyx_v_C = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">116</span>:     S = sqrt(A**2 + B**2 - C**2)</pre>
<pre class='cython code score-0 '>  __pyx_v_S = sqrt(((pow(__pyx_v_A, 2.0) + pow(__pyx_v_B, 2.0)) - pow(__pyx_v_C, 2.0)));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">117</span>:     u1 = (A - S)/(B-C)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = (__pyx_v_A - __pyx_v_S);
  __pyx_t_2 = (__pyx_v_B - __pyx_v_C);
  if (unlikely(__pyx_t_2 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L1_error)</span>
  }
  __pyx_v_u1 = (__pyx_t_1 / __pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:     u2 = (A + S)/(B-C)</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = (__pyx_v_A + __pyx_v_S);
  __pyx_t_1 = (__pyx_v_B - __pyx_v_C);
  if (unlikely(__pyx_t_1 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>
  }
  __pyx_v_u2 = (__pyx_t_2 / __pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">119</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:     delta1 = 2*atan(u1)</pre>
<pre class='cython code score-0 '>  __pyx_v_delta1 = (2.0 * atan(__pyx_v_u1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>:     delta2 = 2*atan(u2)</pre>
<pre class='cython code score-0 '>  __pyx_v_delta2 = (2.0 * atan(__pyx_v_u2));
</pre><pre class="cython line score-0">&#xA0;<span class="">122</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:     du1_dA = (S-A)/(B-C)/S</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = (__pyx_v_S - __pyx_v_A);
  __pyx_t_2 = (__pyx_v_B - __pyx_v_C);
  if (unlikely(__pyx_t_2 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  }
  __pyx_t_3 = (__pyx_t_1 / __pyx_t_2);
  if (unlikely(__pyx_v_S == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  }
  __pyx_v_du1_dA = (__pyx_t_3 / __pyx_v_S);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">124</span>:     du2_dA = (S+A)/(B-C)/S</pre>
<pre class='cython code score-10 '>  __pyx_t_3 = (__pyx_v_S + __pyx_v_A);
  __pyx_t_2 = (__pyx_v_B - __pyx_v_C);
  if (unlikely(__pyx_t_2 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L1_error)</span>
  }
  __pyx_t_1 = (__pyx_t_3 / __pyx_t_2);
  if (unlikely(__pyx_v_S == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L1_error)</span>
  }
  __pyx_v_du2_dA = (__pyx_t_1 / __pyx_v_S);
</pre><pre class="cython line score-0">&#xA0;<span class="">125</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>:     du1_dB = ((B-C)*(-B/S)-(A-S))/(B-C)**2</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = (-__pyx_v_B);
  if (unlikely(__pyx_v_S == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 126, __pyx_L1_error)</span>
  }
  __pyx_t_2 = (((__pyx_v_B - __pyx_v_C) * (__pyx_t_1 / __pyx_v_S)) - (__pyx_v_A - __pyx_v_S));
  __pyx_t_1 = pow((__pyx_v_B - __pyx_v_C), 2.0);
  if (unlikely(__pyx_t_1 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 126, __pyx_L1_error)</span>
  }
  __pyx_v_du1_dB = (__pyx_t_2 / __pyx_t_1);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:     du2_dB = ((B-C)*(+B/S)-(A+S))/(B-C)**2</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = __pyx_v_B;
  if (unlikely(__pyx_v_S == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
  }
  __pyx_t_2 = (((__pyx_v_B - __pyx_v_C) * (__pyx_t_1 / __pyx_v_S)) - (__pyx_v_A + __pyx_v_S));
  __pyx_t_1 = pow((__pyx_v_B - __pyx_v_C), 2.0);
  if (unlikely(__pyx_t_1 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
  }
  __pyx_v_du2_dB = (__pyx_t_2 / __pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">128</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>:     ddelta1_dtheta = 2/(1+u1**2)*(du1_dA*dA_dtheta + du1_dB*dB_dtheta)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = (1.0 + pow(__pyx_v_u1, 2.0));
  if (unlikely(__pyx_t_1 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L1_error)</span>
  }
  __pyx_v_ddelta1_dtheta = ((2.0 / __pyx_t_1) * ((__pyx_v_du1_dA * __pyx_v_dA_dtheta) + (__pyx_v_du1_dB * __pyx_v_dB_dtheta)));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">130</span>:     ddelta2_dtheta = 2/(1+u2**2)*(du2_dA*dA_dtheta + du2_dB*dB_dtheta)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = (1.0 + pow(__pyx_v_u2, 2.0));
  if (unlikely(__pyx_t_1 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L1_error)</span>
  }
  __pyx_v_ddelta2_dtheta = ((2.0 / __pyx_t_1) * ((__pyx_v_du2_dA * __pyx_v_dA_dtheta) + (__pyx_v_du2_dB * __pyx_v_dB_dtheta)));
</pre><pre class="cython line score-0">&#xA0;<span class="">131</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">132</span>:     if abs(delta1) &lt; 1:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((fabs(__pyx_v_delta1) &lt; 1.0) != 0);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>:         return geo.phi_fie - pi + delta1, ddelta1_dtheta</pre>
<pre class='cython code score-18 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_geo-&gt;__pyx_base.phi_fie - M_PI) + __pyx_v_delta1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ddelta1_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_6);
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    __pyx_r = ((PyObject*)__pyx_t_7);
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">134</span>:     elif abs(delta2) &lt; 1:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((fabs(__pyx_v_delta2) &lt; 1.0) != 0);
  if (likely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:         return geo.phi_fie - pi + delta2, ddelta2_dtheta</pre>
<pre class='cython code score-18 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_geo-&gt;__pyx_base.phi_fie - M_PI) + __pyx_v_delta2));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ddelta2_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_6);
    __pyx_t_7 = 0;
    __pyx_t_6 = 0;
    __pyx_r = ((PyObject*)__pyx_t_5);
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">136</span>:     else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">137</span>:         raise ValueError</pre>
<pre class='cython code score-2 '>  /*else*/ {
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_builtin_ValueError, 0, 0, 0);
    <span class='error_goto'>__PYX_ERR(0, 137, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">138</span>: </pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">139</span>: cpdef tuple phi_s2_sa(double theta, DanfossGeoVals geo):</pre>
<pre class='cython code score-45 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_9phi_s2_sa(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_phi_s2_sa(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_A;
  double __pyx_v_B;
  double __pyx_v_C;
  double __pyx_v_S;
  double __pyx_v_u1;
  double __pyx_v_u2;
  double __pyx_v_ro_rb;
  double __pyx_v_dA_dtheta;
  double __pyx_v_dB_dtheta;
  double __pyx_v_delta1;
  double __pyx_v_delta2;
  double __pyx_v_du1_dA;
  double __pyx_v_du2_dA;
  double __pyx_v_du1_dB;
  double __pyx_v_du2_dB;
  double __pyx_v_ddelta1_dtheta;
  double __pyx_v_ddelta2_dtheta;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("phi_s2_sa", 0);
  <span class='trace'>__Pyx_TraceCall</span>("phi_s2_sa", __pyx_f[0], 139, 0, <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.phi_s2_sa", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_9phi_s2_sa(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_8phi_s2_sa[] = "phi_s2_sa(double theta, DanfossGeoVals geo) -&gt; tuple\n\n    Formulate the problem like in Bell, DOI: 10.1016/j.ijrefrig.2014.05.029, see the appendix.\n    Basically problem ends up being quite similar to the symmetric scroll problem with a different\n    argument in the trig functions.  In the symmetric scroll case, cos(-geo.phi_fie+geo.phi_oie+theta)\n    turns into cos(theta)\n\n    Sympy code:\n    r_b,ro,phi_oie,phi_i0,phi_o0,phi_fie,theta,delta = symbols('r_b,ro,phi_oie,phi_i0,phi_o0,phi_fie,theta,delta',real=True)\n    om = phi_fie - theta + 3*pi/2\n    ro = r_b*pi - r_b*(phi_i0-phi_o0) #rb*pi-t\n    # End point on orbiting scroll\n    xoi = -r_b*cos(phi_oie)-r_b*(phi_oie-phi_i0)*sin(phi_oie)+ro*cos(om)\n    yoi = -r_b*sin(phi_oie)+r_b*(phi_oie-phi_i0)*cos(phi_oie)+ro*sin(om)\n    # Other end point on fixed scroll\n    phi_ssa = phi_oie-pi+delta\n    xssa = r_b*cos(phi_ssa)+r_b*(phi_ssa-phi_o0)*sin(phi_ssa)\n    yssa = r_b*sin(phi_ssa)-r_b*(phi_ssa-phi_o0)*cos(phi_ssa)\n    d2 = (xoi-xssa)**2+(yoi-yssa)**2 # squared distance\n    trigsimp(factor(expand_trig(simplify(diff(d2, delta))),[sin(delta),cos(delta)]))\n    ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_9phi_s2_sa(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("phi_s2_sa (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("phi_s2_sa", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "phi_s2_sa") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("phi_s2_sa", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.phi_s2_sa", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_8phi_s2_sa(__pyx_self, __pyx_v_theta, __pyx_v_geo);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_8phi_s2_sa(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("phi_s2_sa", 0);
  <span class='trace'>__Pyx_TraceCall</span>("phi_s2_sa (wrapper)", __pyx_f[0], 139, 0, <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_phi_s2_sa(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 139, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.phi_s2_sa", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">140</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">141</span>:     Formulate the problem like in Bell, DOI: 10.1016/j.ijrefrig.2014.05.029, see the appendix.</pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>:     Basically problem ends up being quite similar to the symmetric scroll problem with a different</pre>
<pre class="cython line score-0">&#xA0;<span class="">143</span>:     argument in the trig functions.  In the symmetric scroll case, cos(-geo.phi_fie+geo.phi_oie+theta)</pre>
<pre class="cython line score-0">&#xA0;<span class="">144</span>:     turns into cos(theta)</pre>
<pre class="cython line score-0">&#xA0;<span class="">145</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">146</span>:     Sympy code:</pre>
<pre class="cython line score-0">&#xA0;<span class="">147</span>:     r_b,ro,phi_oie,phi_i0,phi_o0,phi_fie,theta,delta = symbols('r_b,ro,phi_oie,phi_i0,phi_o0,phi_fie,theta,delta',real=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">148</span>:     om = phi_fie - theta + 3*pi/2</pre>
<pre class="cython line score-0">&#xA0;<span class="">149</span>:     ro = r_b*pi - r_b*(phi_i0-phi_o0) #rb*pi-t</pre>
<pre class="cython line score-0">&#xA0;<span class="">150</span>:     # End point on orbiting scroll</pre>
<pre class="cython line score-0">&#xA0;<span class="">151</span>:     xoi = -r_b*cos(phi_oie)-r_b*(phi_oie-phi_i0)*sin(phi_oie)+ro*cos(om)</pre>
<pre class="cython line score-0">&#xA0;<span class="">152</span>:     yoi = -r_b*sin(phi_oie)+r_b*(phi_oie-phi_i0)*cos(phi_oie)+ro*sin(om)</pre>
<pre class="cython line score-0">&#xA0;<span class="">153</span>:     # Other end point on fixed scroll</pre>
<pre class="cython line score-0">&#xA0;<span class="">154</span>:     phi_ssa = phi_oie-pi+delta</pre>
<pre class="cython line score-0">&#xA0;<span class="">155</span>:     xssa = r_b*cos(phi_ssa)+r_b*(phi_ssa-phi_o0)*sin(phi_ssa)</pre>
<pre class="cython line score-0">&#xA0;<span class="">156</span>:     yssa = r_b*sin(phi_ssa)-r_b*(phi_ssa-phi_o0)*cos(phi_ssa)</pre>
<pre class="cython line score-0">&#xA0;<span class="">157</span>:     d2 = (xoi-xssa)**2+(yoi-yssa)**2 # squared distance</pre>
<pre class="cython line score-0">&#xA0;<span class="">158</span>:     trigsimp(factor(expand_trig(simplify(diff(d2, delta))),[sin(delta),cos(delta)]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">159</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>:     cdef double A,B,C,S,u1,u2</pre>
<pre class="cython line score-0">&#xA0;<span class="">161</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>:     ro_rb = geo.ro/geo.rb</pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_geo-&gt;__pyx_base.rb == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 162, __pyx_L1_error)</span>
  }
  __pyx_v_ro_rb = (__pyx_v_geo-&gt;__pyx_base.ro / __pyx_v_geo-&gt;__pyx_base.rb);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>:     A = (geo.phi_oi0-geo.phi_oie)+ro_rb*cos(-geo.phi_fie+geo.phi_oie+theta)</pre>
<pre class='cython code score-0 '>  __pyx_v_A = ((__pyx_v_geo-&gt;__pyx_base.phi_oi0 - __pyx_v_geo-&gt;__pyx_base.phi_oie) + (__pyx_v_ro_rb * cos((((-__pyx_v_geo-&gt;__pyx_base.phi_fie) + __pyx_v_geo-&gt;__pyx_base.phi_oie) + __pyx_v_theta))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:     dA_dtheta = -ro_rb*sin(-geo.phi_fie+geo.phi_oie+theta)</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_dtheta = ((-__pyx_v_ro_rb) * sin((((-__pyx_v_geo-&gt;__pyx_base.phi_fie) + __pyx_v_geo-&gt;__pyx_base.phi_oie) + __pyx_v_theta)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">165</span>:     B = 1+ro_rb*sin(-geo.phi_fie+geo.phi_oie+theta)</pre>
<pre class='cython code score-0 '>  __pyx_v_B = (1.0 + (__pyx_v_ro_rb * sin((((-__pyx_v_geo-&gt;__pyx_base.phi_fie) + __pyx_v_geo-&gt;__pyx_base.phi_oie) + __pyx_v_theta))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:     dB_dtheta = ro_rb*cos(-geo.phi_fie+geo.phi_oie+theta)</pre>
<pre class='cython code score-0 '>  __pyx_v_dB_dtheta = (__pyx_v_ro_rb * cos((((-__pyx_v_geo-&gt;__pyx_base.phi_fie) + __pyx_v_geo-&gt;__pyx_base.phi_oie) + __pyx_v_theta)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">167</span>:     C = -1</pre>
<pre class='cython code score-0 '>  __pyx_v_C = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">168</span>:     S = sqrt(A**2 + B**2 - C**2)</pre>
<pre class='cython code score-0 '>  __pyx_v_S = sqrt(((pow(__pyx_v_A, 2.0) + pow(__pyx_v_B, 2.0)) - pow(__pyx_v_C, 2.0)));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">169</span>:     u1 = (A - S)/(B-C)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = (__pyx_v_A - __pyx_v_S);
  __pyx_t_2 = (__pyx_v_B - __pyx_v_C);
  if (unlikely(__pyx_t_2 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>
  }
  __pyx_v_u1 = (__pyx_t_1 / __pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">170</span>:     u2 = (A + S)/(B-C)</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = (__pyx_v_A + __pyx_v_S);
  __pyx_t_1 = (__pyx_v_B - __pyx_v_C);
  if (unlikely(__pyx_t_1 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 170, __pyx_L1_error)</span>
  }
  __pyx_v_u2 = (__pyx_t_2 / __pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">171</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">172</span>:     delta1 = 2*atan(u1)</pre>
<pre class='cython code score-0 '>  __pyx_v_delta1 = (2.0 * atan(__pyx_v_u1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>:     delta2 = 2*atan(u2)</pre>
<pre class='cython code score-0 '>  __pyx_v_delta2 = (2.0 * atan(__pyx_v_u2));
</pre><pre class="cython line score-0">&#xA0;<span class="">174</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">175</span>:     du1_dA = (S-A)/(B-C)/S</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = (__pyx_v_S - __pyx_v_A);
  __pyx_t_2 = (__pyx_v_B - __pyx_v_C);
  if (unlikely(__pyx_t_2 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 175, __pyx_L1_error)</span>
  }
  __pyx_t_3 = (__pyx_t_1 / __pyx_t_2);
  if (unlikely(__pyx_v_S == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 175, __pyx_L1_error)</span>
  }
  __pyx_v_du1_dA = (__pyx_t_3 / __pyx_v_S);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">176</span>:     du2_dA = (S+A)/(B-C)/S</pre>
<pre class='cython code score-10 '>  __pyx_t_3 = (__pyx_v_S + __pyx_v_A);
  __pyx_t_2 = (__pyx_v_B - __pyx_v_C);
  if (unlikely(__pyx_t_2 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 176, __pyx_L1_error)</span>
  }
  __pyx_t_1 = (__pyx_t_3 / __pyx_t_2);
  if (unlikely(__pyx_v_S == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 176, __pyx_L1_error)</span>
  }
  __pyx_v_du2_dA = (__pyx_t_1 / __pyx_v_S);
</pre><pre class="cython line score-0">&#xA0;<span class="">177</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">178</span>:     du1_dB = ((B-C)*(-B/S)-(A-S))/(B-C)**2</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = (-__pyx_v_B);
  if (unlikely(__pyx_v_S == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 178, __pyx_L1_error)</span>
  }
  __pyx_t_2 = (((__pyx_v_B - __pyx_v_C) * (__pyx_t_1 / __pyx_v_S)) - (__pyx_v_A - __pyx_v_S));
  __pyx_t_1 = pow((__pyx_v_B - __pyx_v_C), 2.0);
  if (unlikely(__pyx_t_1 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 178, __pyx_L1_error)</span>
  }
  __pyx_v_du1_dB = (__pyx_t_2 / __pyx_t_1);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">179</span>:     du2_dB = ((B-C)*(+B/S)-(A+S))/(B-C)**2</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = __pyx_v_B;
  if (unlikely(__pyx_v_S == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
  }
  __pyx_t_2 = (((__pyx_v_B - __pyx_v_C) * (__pyx_t_1 / __pyx_v_S)) - (__pyx_v_A + __pyx_v_S));
  __pyx_t_1 = pow((__pyx_v_B - __pyx_v_C), 2.0);
  if (unlikely(__pyx_t_1 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
  }
  __pyx_v_du2_dB = (__pyx_t_2 / __pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">180</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">181</span>:     ddelta1_dtheta = 2/(1+u1**2)*(du1_dA*dA_dtheta + du1_dB*dB_dtheta)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = (1.0 + pow(__pyx_v_u1, 2.0));
  if (unlikely(__pyx_t_1 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 181, __pyx_L1_error)</span>
  }
  __pyx_v_ddelta1_dtheta = ((2.0 / __pyx_t_1) * ((__pyx_v_du1_dA * __pyx_v_dA_dtheta) + (__pyx_v_du1_dB * __pyx_v_dB_dtheta)));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">182</span>:     ddelta2_dtheta = 2/(1+u2**2)*(du2_dA*dA_dtheta + du2_dB*dB_dtheta)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = (1.0 + pow(__pyx_v_u2, 2.0));
  if (unlikely(__pyx_t_1 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 182, __pyx_L1_error)</span>
  }
  __pyx_v_ddelta2_dtheta = ((2.0 / __pyx_t_1) * ((__pyx_v_du2_dA * __pyx_v_dA_dtheta) + (__pyx_v_du2_dB * __pyx_v_dB_dtheta)));
</pre><pre class="cython line score-0">&#xA0;<span class="">183</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">184</span>:     if abs(delta1) &lt; 1:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((fabs(__pyx_v_delta1) &lt; 1.0) != 0);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">185</span>:         return geo.phi_oie - pi + delta1, ddelta1_dtheta</pre>
<pre class='cython code score-18 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_geo-&gt;__pyx_base.phi_oie - M_PI) + __pyx_v_delta1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ddelta1_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_6);
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    __pyx_r = ((PyObject*)__pyx_t_7);
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">186</span>:     elif abs(delta2) &lt; 1:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((fabs(__pyx_v_delta2) &lt; 1.0) != 0);
  if (likely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">187</span>:         return geo.phi_oie - pi + delta2, ddelta2_dtheta</pre>
<pre class='cython code score-18 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_geo-&gt;__pyx_base.phi_oie - M_PI) + __pyx_v_delta2));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 187, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ddelta2_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 187, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 187, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_6);
    __pyx_t_7 = 0;
    __pyx_t_6 = 0;
    __pyx_r = ((PyObject*)__pyx_t_5);
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">188</span>:     else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>:         raise ValueError</pre>
<pre class='cython code score-2 '>  /*else*/ {
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_builtin_ValueError, 0, 0, 0);
    <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">190</span>: </pre>
<pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">191</span>: cpdef CVInvolutes CVangles(double theta, DanfossGeoVals geo, int index):</pre>
<pre class='cython code score-62 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_11CVangles(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, int __pyx_v_index, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_Nc1;
  int __pyx_v_Nc2;
  int __pyx_v_alpha;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_CV = 0;
  double __pyx_v_theta_star;
  double __pyx_v_phi_s_sa;
  double __pyx_v_d_phi_s_sa_dtheta;
  double __pyx_v_theta_break;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("CVangles", 0);
  <span class='trace'>__Pyx_TraceCall</span>("CVangles", __pyx_f[0], 191, 0, <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.CVangles", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_CV);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_11CVangles(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_10CVangles[] = "CVangles(double theta, DanfossGeoVals geo, int index) -&gt; CVInvolutes\n\n    Get the involute angles for the inner and outer involutes which form the given control volume\n\n    Returns\n    -------\n    CVInvolutes : a :class:`PDSim.scroll.common_scroll_geo.CVInvolutes` class instance\n    ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_11CVangles(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  int __pyx_v_index;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("CVangles (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_index,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CVangles", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_index)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CVangles", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "CVangles") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
    __pyx_v_index = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]); if (unlikely((__pyx_v_index == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CVangles", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.CVangles", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_10CVangles(__pyx_self, __pyx_v_theta, __pyx_v_geo, __pyx_v_index);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_10CVangles(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, int __pyx_v_index) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("CVangles", 0);
  <span class='trace'>__Pyx_TraceCall</span>("CVangles (wrapper)", __pyx_f[0], 191, 0, <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_v_index, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 191, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.CVangles", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">192</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">193</span>:     Get the involute angles for the inner and outer involutes which form the given control volume</pre>
<pre class="cython line score-0">&#xA0;<span class="">194</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">195</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">196</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">197</span>:     CVInvolutes : a :class:`PDSim.scroll.common_scroll_geo.CVInvolutes` class instance</pre>
<pre class="cython line score-0">&#xA0;<span class="">198</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">199</span>:     cdef int Nc1, Nc2, alpha</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">200</span>:     cdef CVInvolutes CV = CVInvolutes()</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(((PyObject *)__pyx_ptype_5PDSim_6scroll_17common_scroll_geo_CVInvolutes));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 200, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_CV = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">201</span>:     cdef double theta_star</pre>
<pre class="cython line score-0">&#xA0;<span class="">202</span>:     cdef double phi_s_sa,  d_phi_s_sa_dtheta</pre>
<pre class="cython line score-0">&#xA0;<span class="">203</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">204</span>:     # The break angle where the s2 chamber just begins</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">205</span>:     theta_break = geo.phi_fie - geo.phi_oie</pre>
<pre class='cython code score-0 '>  __pyx_v_theta_break = (__pyx_v_geo-&gt;__pyx_base.phi_fie - __pyx_v_geo-&gt;__pyx_base.phi_oie);
</pre><pre class="cython line score-0">&#xA0;<span class="">206</span>:     # Define the effective crank angle for path 2</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:     if theta_break &lt; 1e-14:</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_theta_break &lt; 1e-14) != 0);
  if (__pyx_t_2) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">208</span>:         # This means the geometry is actually symmetric, because the break angle is actually equal to zero</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:         theta_star = theta</pre>
<pre class='cython code score-0 '>    __pyx_v_theta_star = __pyx_v_theta;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:     elif theta &gt; theta_break:</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_theta &gt; __pyx_v_theta_break) != 0);
  if (__pyx_t_2) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">211</span>:         # At the break angle, the effective angle is zero</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">212</span>:         theta_star = theta - theta_break</pre>
<pre class='cython code score-0 '>    __pyx_v_theta_star = (__pyx_v_theta - __pyx_v_theta_break);
</pre><pre class="cython line score-0">&#xA0;<span class="">213</span>:     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">214</span>:         # At the break angle, the effective angle is a full rotation or 2*pi radians</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:         theta_star = theta + 2*pi - theta_break</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_theta_star = ((__pyx_v_theta + (2.0 * M_PI)) - __pyx_v_theta_break);
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">216</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>:     if index == common.keyIs1:</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_index == __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIs1) != 0);
  if (__pyx_t_2) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">218</span>:         phi_s_sa, d_phi_s_sa_dtheta = phi_s1_sa(theta, geo)</pre>
<pre class='cython code score-37 '>    __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_phi_s1_sa(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 218, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (likely(__pyx_t_1 != Py_None)) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 218, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 218, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
    }
    __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_6 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_phi_s_sa = __pyx_t_5;
    __pyx_v_d_phi_s_sa_dtheta = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>:         CV.Outer.involute = common.INVOLUTE_FI</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;involute = __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">220</span>:         CV.Outer.phi_0 = geo.phi_fi0</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_geo-&gt;__pyx_base.phi_fi0;
    __pyx_v_CV-&gt;Outer-&gt;phi_0 = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:         CV.Outer.phi_max = geo.phi_fie</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_geo-&gt;__pyx_base.phi_fie;
    __pyx_v_CV-&gt;Outer-&gt;phi_max = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:         CV.Outer.phi_min = geo.phi_fie-theta</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;phi_min = (__pyx_v_geo-&gt;__pyx_base.phi_fie - __pyx_v_theta);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>:         CV.Inner.involute = common.INVOLUTE_OO</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;involute = __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:         CV.Inner.phi_0 = geo.phi_oo0</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_geo-&gt;__pyx_base.phi_oo0;
    __pyx_v_CV-&gt;Inner-&gt;phi_0 = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:         CV.Inner.phi_max = phi_s_sa</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;phi_max = __pyx_v_phi_s_sa;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:         CV.Inner.phi_min = geo.phi_fie-pi-theta</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;phi_min = ((__pyx_v_geo-&gt;__pyx_base.phi_fie - M_PI) - __pyx_v_theta);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">227</span>:         CV.Inner.dphi_max_dtheta = d_phi_s_sa_dtheta</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;dphi_max_dtheta = __pyx_v_d_phi_s_sa_dtheta;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:         CV.Outer.dphi_max_dtheta = 0</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;dphi_max_dtheta = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:         CV.Inner.dphi_min_dtheta = CV.Outer.dphi_min_dtheta = -1</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;dphi_min_dtheta = -1.0;
    __pyx_v_CV-&gt;Outer-&gt;dphi_min_dtheta = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:         CV.has_line_1 = True</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;has_line_1 = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">231</span>:         CV.has_line_2 = False</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;has_line_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">232</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>:     elif common.keyIc1_1 &lt;= index &lt;= common.keyIc1_10:</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_1 &lt;= ((enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices)__pyx_v_index));
  if (__pyx_t_2) {
    __pyx_t_2 = (__pyx_v_index &lt;= __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_10);
  }
  __pyx_t_7 = (__pyx_t_2 != 0);
  if (__pyx_t_7) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">234</span>:         # index 1001 is c1.1, 1002 is c1.2, etc.</pre>
<pre class="cython line score-0">&#xA0;<span class="">235</span>:         # alpha is the index of the compression pocket,</pre>
<pre class="cython line score-0">&#xA0;<span class="">236</span>:         # alpha = 1 is the outermost chamber on the #1 path</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>:         alpha = index - 1000</pre>
<pre class='cython code score-0 '>    __pyx_v_alpha = (__pyx_v_index - 0x3E8);
</pre><pre class="cython line score-0">&#xA0;<span class="">238</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>:         if alpha &gt; Nc(theta, geo, 1):</pre>
<pre class='cython code score-0 '>    __pyx_t_7 = ((__pyx_v_alpha &gt; __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Nc(__pyx_v_theta, __pyx_v_geo, 1, 0)) != 0);
    if (unlikely(__pyx_t_7)) {
/* … */
    }
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">240</span>:             raise KeyError("Requested alpha [{0:d}] is not possible; N_c_max is {1:d}".format(alpha, Nc(theta, geo, 1)))</pre>
<pre class='cython code score-51 '>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Requested_alpha_0_d_is_not_possi, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_alpha);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Nc(__pyx_v_theta, __pyx_v_geo, 1, 0));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = NULL;
      __pyx_t_10 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_10 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_t_3, __pyx_t_8};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_t_3, __pyx_t_8};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      } else
      #endif
      {
        __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        if (__pyx_t_9) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_10, __pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_10, __pyx_t_8);
        __pyx_t_3 = 0;
        __pyx_t_8 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_KeyError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">241</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">242</span>:         CV.Outer.involute = common.INVOLUTE_FI</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;involute = __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:         CV.Outer.phi_0 = geo.phi_fi0</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_geo-&gt;__pyx_base.phi_fi0;
    __pyx_v_CV-&gt;Outer-&gt;phi_0 = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">244</span>:         CV.Outer.phi_max = geo.phi_fie-theta-2*pi*(alpha-1)</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;phi_max = ((__pyx_v_geo-&gt;__pyx_base.phi_fie - __pyx_v_theta) - ((2.0 * M_PI) * (__pyx_v_alpha - 1)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>:         CV.Outer.phi_min = geo.phi_fie-theta-2*pi*alpha</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;phi_min = ((__pyx_v_geo-&gt;__pyx_base.phi_fie - __pyx_v_theta) - ((2.0 * M_PI) * __pyx_v_alpha));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>:         CV.Inner.involute = common.INVOLUTE_OO</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;involute = __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">247</span>:         CV.Inner.phi_0 = geo.phi_oo0</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_geo-&gt;__pyx_base.phi_oo0;
    __pyx_v_CV-&gt;Inner-&gt;phi_0 = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">248</span>:         CV.Inner.phi_max = geo.phi_fie-pi-theta-2*pi*(alpha-1)</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;phi_max = (((__pyx_v_geo-&gt;__pyx_base.phi_fie - M_PI) - __pyx_v_theta) - ((2.0 * M_PI) * (__pyx_v_alpha - 1)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">249</span>:         CV.Inner.phi_min = geo.phi_fie-pi-theta-2*pi*alpha</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;phi_min = (((__pyx_v_geo-&gt;__pyx_base.phi_fie - M_PI) - __pyx_v_theta) - ((2.0 * M_PI) * __pyx_v_alpha));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">250</span>:         CV.Inner.dphi_max_dtheta = CV.Outer.dphi_max_dtheta = -1</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;dphi_max_dtheta = -1.0;
    __pyx_v_CV-&gt;Outer-&gt;dphi_max_dtheta = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">251</span>:         CV.Inner.dphi_min_dtheta = CV.Outer.dphi_min_dtheta = -1</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;dphi_min_dtheta = -1.0;
    __pyx_v_CV-&gt;Outer-&gt;dphi_min_dtheta = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">252</span>:         CV.has_line_1 = False</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;has_line_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>:         CV.has_line_2 = False</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;has_line_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">254</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">255</span>:     elif index == common.keyId1:</pre>
<pre class='cython code score-0 '>  __pyx_t_7 = ((__pyx_v_index == __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyId1) != 0);
  if (__pyx_t_7) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>:         Nc1 = Nc(theta, geo, 1)</pre>
<pre class='cython code score-0 '>    __pyx_v_Nc1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Nc(__pyx_v_theta, __pyx_v_geo, 1, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">257</span>:         CV.Outer.involute = common.INVOLUTE_FI</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;involute = __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">258</span>:         CV.Outer.phi_0 = geo.phi_fi0</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_geo-&gt;__pyx_base.phi_fi0;
    __pyx_v_CV-&gt;Outer-&gt;phi_0 = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:         CV.Outer.phi_max = geo.phi_fie-theta-2.0*pi*Nc1</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;phi_max = ((__pyx_v_geo-&gt;__pyx_base.phi_fie - __pyx_v_theta) - ((2.0 * M_PI) * __pyx_v_Nc1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:         CV.Outer.phi_min = geo.phi_oos + pi</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;phi_min = (__pyx_v_geo-&gt;__pyx_base.phi_oos + M_PI);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:         CV.Outer.dphi_max_dtheta = -1</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;dphi_max_dtheta = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">262</span>:         CV.Outer.dphi_min_dtheta = 0</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;dphi_min_dtheta = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">263</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>:         CV.Inner.involute = common.INVOLUTE_OO</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;involute = __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>:         CV.Inner.phi_0 = geo.phi_oo0</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_geo-&gt;__pyx_base.phi_oo0;
    __pyx_v_CV-&gt;Inner-&gt;phi_0 = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>:         CV.Inner.phi_max = geo.phi_fie-pi-theta-2.0*pi*Nc1</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;phi_max = (((__pyx_v_geo-&gt;__pyx_base.phi_fie - M_PI) - __pyx_v_theta) - ((2.0 * M_PI) * __pyx_v_Nc1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">267</span>:         CV.Inner.phi_min = geo.phi_oos</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_geo-&gt;__pyx_base.phi_oos;
    __pyx_v_CV-&gt;Inner-&gt;phi_min = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:         CV.Inner.dphi_max_dtheta = -1</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;dphi_max_dtheta = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">269</span>:         CV.Inner.dphi_min_dtheta = 0</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;dphi_min_dtheta = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">270</span>:         CV.has_line_1 = False</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;has_line_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:         CV.has_line_2 = True</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;has_line_2 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">272</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:     elif index == common.keyIs2:</pre>
<pre class='cython code score-0 '>  __pyx_t_7 = ((__pyx_v_index == __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIs2) != 0);
  if (__pyx_t_7) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">274</span>:         phi_s_sa, d_phi_s_sa_dtheta = phi_s2_sa(theta, geo)</pre>
<pre class='cython code score-37 '>    __pyx_t_4 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_phi_s2_sa(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (likely(__pyx_t_4 != Py_None)) {
      PyObject* sequence = __pyx_t_4;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
    }
    __pyx_t_6 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_6 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_11); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_v_phi_s_sa = __pyx_t_6;
    __pyx_v_d_phi_s_sa_dtheta = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:         CV.Outer.involute = common.INVOLUTE_OI</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;involute = __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>:         CV.Outer.phi_0 = geo.phi_oi0</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_geo-&gt;__pyx_base.phi_oi0;
    __pyx_v_CV-&gt;Outer-&gt;phi_0 = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>:         CV.Inner.involute = common.INVOLUTE_FO</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;involute = __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:         CV.Inner.phi_0 = geo.phi_fo0</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_geo-&gt;__pyx_base.phi_fo0;
    __pyx_v_CV-&gt;Inner-&gt;phi_0 = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:         CV.Outer.phi_max = geo.phi_oie</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_geo-&gt;__pyx_base.phi_oie;
    __pyx_v_CV-&gt;Outer-&gt;phi_max = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:         CV.Inner.phi_max = phi_s_sa #geo.phi_oie - pi # The point on the FO involute that is conjugate at theta_break</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;phi_max = __pyx_v_phi_s_sa;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">281</span>:         CV.Outer.phi_min = geo.phi_oie - theta_star</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;phi_min = (__pyx_v_geo-&gt;__pyx_base.phi_oie - __pyx_v_theta_star);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>:         CV.Inner.phi_min = geo.phi_oie - pi - theta_star</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;phi_min = ((__pyx_v_geo-&gt;__pyx_base.phi_oie - M_PI) - __pyx_v_theta_star);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>:         CV.Inner.dphi_max_dtheta = d_phi_s_sa_dtheta</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;dphi_max_dtheta = __pyx_v_d_phi_s_sa_dtheta;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">284</span>:         CV.Outer.dphi_max_dtheta = 0</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;dphi_max_dtheta = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:         CV.Inner.dphi_min_dtheta = CV.Outer.dphi_min_dtheta = -1</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;dphi_min_dtheta = -1.0;
    __pyx_v_CV-&gt;Outer-&gt;dphi_min_dtheta = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>:         CV.has_line_1 = True</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;has_line_1 = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">287</span>:         CV.has_line_2 = False</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;has_line_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">288</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>:     elif common.keyIc2_1 &lt;= index &lt;= common.keyIc2_10:</pre>
<pre class='cython code score-0 '>  __pyx_t_7 = (__pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_1 &lt;= ((enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_compressor_CV_indices)__pyx_v_index));
  if (__pyx_t_7) {
    __pyx_t_7 = (__pyx_v_index &lt;= __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_10);
  }
  __pyx_t_2 = (__pyx_t_7 != 0);
  if (__pyx_t_2) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">290</span>:         # index 2001 is c2.1, 2002 is c2.2, etc.</pre>
<pre class="cython line score-0">&#xA0;<span class="">291</span>:         # alpha is the index of the compression pocket,</pre>
<pre class="cython line score-0">&#xA0;<span class="">292</span>:         # alpha = 1 is the outermost chamber on the #2 path</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:         alpha = index - 2000</pre>
<pre class='cython code score-0 '>    __pyx_v_alpha = (__pyx_v_index - 0x7D0);
</pre><pre class="cython line score-0">&#xA0;<span class="">294</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:         if alpha &gt; Nc(theta, geo, 2):</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_alpha &gt; __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Nc(__pyx_v_theta, __pyx_v_geo, 2, 0)) != 0);
    if (unlikely(__pyx_t_2)) {
/* … */
    }
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:             raise KeyError("Requested alpha [{0:d}] is not possible; N_c_max is {1:d}".format(alpha, Nc(theta, geo, 2)))</pre>
<pre class='cython code score-51 '>      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Requested_alpha_0_d_is_not_possi, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_alpha);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Nc(__pyx_v_theta, __pyx_v_geo, 2, 0));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_3 = NULL;
      __pyx_t_10 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
          __pyx_t_10 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_11)) {
        PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_1, __pyx_t_8};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_11, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_11)) {
        PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_1, __pyx_t_8};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_11, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      } else
      #endif
      {
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        if (__pyx_t_3) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_3); __pyx_t_3 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_10, __pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_10, __pyx_t_8);
        __pyx_t_1 = 0;
        __pyx_t_8 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_KeyError, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_11, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">297</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>:         CV.Outer.involute = common.INVOLUTE_OI</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;involute = __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">299</span>:         CV.Outer.phi_0 = geo.phi_oi0</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_geo-&gt;__pyx_base.phi_oi0;
    __pyx_v_CV-&gt;Outer-&gt;phi_0 = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">300</span>:         CV.Inner.involute = common.INVOLUTE_FO</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;involute = __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">301</span>:         CV.Inner.phi_0 = geo.phi_fo0</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_geo-&gt;__pyx_base.phi_fo0;
    __pyx_v_CV-&gt;Inner-&gt;phi_0 = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">302</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">303</span>:         CV.Outer.phi_max = geo.phi_oie - theta_star - 2*pi*(alpha-1)</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;phi_max = ((__pyx_v_geo-&gt;__pyx_base.phi_oie - __pyx_v_theta_star) - ((2.0 * M_PI) * (__pyx_v_alpha - 1)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">304</span>:         CV.Inner.phi_max = geo.phi_oie - pi - theta_star - 2*pi*(alpha-1)</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;phi_max = (((__pyx_v_geo-&gt;__pyx_base.phi_oie - M_PI) - __pyx_v_theta_star) - ((2.0 * M_PI) * (__pyx_v_alpha - 1)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">305</span>:         CV.Outer.phi_min = CV.Outer.phi_max - 2*pi</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;phi_min = (__pyx_v_CV-&gt;Outer-&gt;phi_max - (2.0 * M_PI));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">306</span>:         CV.Inner.phi_min = CV.Inner.phi_max - 2*pi</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;phi_min = (__pyx_v_CV-&gt;Inner-&gt;phi_max - (2.0 * M_PI));
</pre><pre class="cython line score-0">&#xA0;<span class="">307</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">308</span>:         CV.Inner.dphi_max_dtheta = CV.Outer.dphi_max_dtheta = -1</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;dphi_max_dtheta = -1.0;
    __pyx_v_CV-&gt;Outer-&gt;dphi_max_dtheta = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">309</span>:         CV.Inner.dphi_min_dtheta = CV.Outer.dphi_min_dtheta = -1</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;dphi_min_dtheta = -1.0;
    __pyx_v_CV-&gt;Outer-&gt;dphi_min_dtheta = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">310</span>:         CV.has_line_1 = False</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;has_line_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">311</span>:         CV.has_line_2 = False</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;has_line_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">312</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">313</span>:     elif index == common.keyId2:</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_index == __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyId2) != 0);
  if (likely(__pyx_t_2)) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">314</span>:         Nc2 = Nc(theta, geo, 2)</pre>
<pre class='cython code score-0 '>    __pyx_v_Nc2 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Nc(__pyx_v_theta, __pyx_v_geo, 2, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>:         CV.Outer.involute = common.INVOLUTE_OI</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;involute = __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">316</span>:         CV.Outer.phi_0 = geo.phi_oi0</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_geo-&gt;__pyx_base.phi_oi0;
    __pyx_v_CV-&gt;Outer-&gt;phi_0 = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">317</span>:         CV.Outer.phi_max = geo.phi_oie - theta_star - 2*pi*(Nc2)</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;phi_max = ((__pyx_v_geo-&gt;__pyx_base.phi_oie - __pyx_v_theta_star) - ((2.0 * M_PI) * __pyx_v_Nc2));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:         CV.Outer.phi_min = geo.phi_fos + pi</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;phi_min = (__pyx_v_geo-&gt;__pyx_base.phi_fos + M_PI);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">319</span>:         CV.Outer.dphi_max_dtheta = -1</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;dphi_max_dtheta = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">320</span>:         CV.Outer.dphi_min_dtheta = 0</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Outer-&gt;dphi_min_dtheta = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">321</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">322</span>:         CV.Inner.involute = common.INVOLUTE_FO</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;involute = __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">323</span>:         CV.Inner.phi_0 = geo.phi_fo0</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_geo-&gt;__pyx_base.phi_fo0;
    __pyx_v_CV-&gt;Inner-&gt;phi_0 = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">324</span>:         CV.Inner.phi_max = geo.phi_oie - pi - theta_star - 2*pi*(Nc2)</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;phi_max = (((__pyx_v_geo-&gt;__pyx_base.phi_oie - M_PI) - __pyx_v_theta_star) - ((2.0 * M_PI) * __pyx_v_Nc2));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">325</span>:         CV.Inner.phi_min = geo.phi_fos</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_geo-&gt;__pyx_base.phi_fos;
    __pyx_v_CV-&gt;Inner-&gt;phi_min = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">326</span>:         CV.Inner.dphi_max_dtheta = -1</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;dphi_max_dtheta = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">327</span>:         CV.Inner.dphi_min_dtheta = 0</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;Inner-&gt;dphi_min_dtheta = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">328</span>:         CV.has_line_1 = False</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;has_line_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">329</span>:         CV.has_line_2 = True</pre>
<pre class='cython code score-0 '>    __pyx_v_CV-&gt;has_line_2 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">330</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">331</span>:     else:</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">332</span>:         raise KeyError("index [{s:d}] not valid".format(s=index))</pre>
<pre class='cython code score-22 '>  /*else*/ {
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_index_s_d_not_valid, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_index);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_s, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_KeyError, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
  }
  __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">333</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">334</span>:     return CV</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_CV));
  __pyx_r = __pyx_v_CV;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">335</span>: </pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">336</span>: cpdef double theta_d(DanfossGeoVals geo, int path) except *:</pre>
<pre class='cython code score-49 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_13theta_d(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_12DanfossPDSim_16asymm_scroll_geo_theta_d(struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, int __pyx_v_path, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_N_c_max;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("theta_d", 0);
  <span class='trace'>__Pyx_TraceCall</span>("theta_d", __pyx_f[0], 336, 0, <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.theta_d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_13theta_d(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_12theta_d[] = "theta_d(DanfossGeoVals geo, int path) -&gt; double\n\n    Discharge angle for the first path, s1, c1.x, d1 in the range 0,2*pi\n\n    Condition for discharge angle is:\n\n    geo.phi_ooe - theta - alpha*2*pi  = geo.phi_oos\n\n    NOTE:\n    For externally asymmetric scroll wrap, theta_d is the same for both paths.  You can\n    see this clearly from looking at a plot of the scroll wraps and their control volumes\n    ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_13theta_d(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  int __pyx_v_path;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("theta_d (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_geo,&amp;__pyx_n_s_path,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("theta_d", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "theta_d") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[0]);
    __pyx_v_path = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_path == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("theta_d", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.theta_d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_12theta_d(__pyx_self, __pyx_v_geo, __pyx_v_path);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_12theta_d(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, int __pyx_v_path) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("theta_d", 0);
  <span class='trace'>__Pyx_TraceCall</span>("theta_d (wrapper)", __pyx_f[0], 336, 0, <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_theta_d(__pyx_v_geo, __pyx_v_path, 0); if (unlikely(__pyx_t_1 == ((double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.theta_d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">337</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">338</span>:     Discharge angle for the first path, s1, c1.x, d1 in the range 0,2*pi</pre>
<pre class="cython line score-0">&#xA0;<span class="">339</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">340</span>:     Condition for discharge angle is:</pre>
<pre class="cython line score-0">&#xA0;<span class="">341</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">342</span>:     geo.phi_ooe - theta - alpha*2*pi  = geo.phi_oos</pre>
<pre class="cython line score-0">&#xA0;<span class="">343</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">344</span>:     NOTE:</pre>
<pre class="cython line score-0">&#xA0;<span class="">345</span>:     For externally asymmetric scroll wrap, theta_d is the same for both paths.  You can</pre>
<pre class="cython line score-0">&#xA0;<span class="">346</span>:     see this clearly from looking at a plot of the scroll wraps and their control volumes</pre>
<pre class="cython line score-0">&#xA0;<span class="">347</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">348</span>:     cdef CVInvolutes angles</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">349</span>:     if path == 1 or path == 2:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_path) {
    case 1:
    case 2:
/* … */
    break;
    default:
</pre><pre class="cython line score-0">&#xA0;<span class="">350</span>:         # Determine the "ending" angle on the orbiting scroll that is in</pre>
<pre class="cython line score-0">&#xA0;<span class="">351</span>:         # contact with the ending angle of the fixed scroll at theta=0</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">352</span>:         N_c_max = floor((geo.phi_fie-(geo.phi_oos+pi))/(2*pi)) # At theta = 0</pre>
<pre class='cython code score-5 '>    __pyx_t_1 = (__pyx_v_geo-&gt;__pyx_base.phi_fie - (__pyx_v_geo-&gt;__pyx_base.phi_oos + M_PI));
    __pyx_t_2 = (2.0 * M_PI);
    if (unlikely(__pyx_t_2 == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 352, __pyx_L1_error)</span>
    }
    __pyx_v_N_c_max = floor((__pyx_t_1 / __pyx_t_2));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">353</span>:         return geo.phi_fie - pi - 2*pi*N_c_max - geo.phi_oos</pre>
<pre class='cython code score-0 '>    __pyx_r = (((__pyx_v_geo-&gt;__pyx_base.phi_fie - M_PI) - ((2.0 * M_PI) * __pyx_v_N_c_max)) - __pyx_v_geo-&gt;__pyx_base.phi_oos);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">354</span>:     else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">355</span>:         raise ValueError</pre>
<pre class='cython code score-2 '>    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_builtin_ValueError, 0, 0, 0);
    <span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span>
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">356</span>: </pre>
<pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">357</span>: cpdef int Nc(double theta, DanfossGeoVals geo, int path):</pre>
<pre class='cython code score-60 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_15Nc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Nc(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, int __pyx_v_path, CYTHON_UNUSED int __pyx_skip_dispatch) {
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_angles = 0;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Nc", 0);
  <span class='trace'>__Pyx_TraceCall</span>("Nc", __pyx_f[0], 357, 0, <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("DanfossPDSim.asymm_scroll_geo.Nc", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_angles);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_15Nc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_14Nc[] = "Nc(double theta, DanfossGeoVals geo, int path) -&gt; int\n\n    The number of pairs of compression chambers in existence at a given\n    crank angle\n\n    Arguments:\n        theta : float\n            The crank angle in radians.\n        geo : DanfossGeoVals instance\n        path : int\n            The path index; 1 for s1, c1.x, d1\n\n    Returns:\n        Nc : int\n            Number of pairs of compressions chambers\n\n    NOTE:\n    For externally asymmetric scroll wrap, theta_d is the same for both paths.  You can\n    see this clearly from looking at a plot of the scroll wraps and their control volumes\n\n    ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_15Nc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  int __pyx_v_path;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Nc (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_path,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Nc", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Nc", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Nc") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
    __pyx_v_path = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]); if (unlikely((__pyx_v_path == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Nc", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.Nc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_14Nc(__pyx_self, __pyx_v_theta, __pyx_v_geo, __pyx_v_path);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_14Nc(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, int __pyx_v_path) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Nc", 0);
  <span class='trace'>__Pyx_TraceCall</span>("Nc (wrapper)", __pyx_f[0], 357, 0, <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Nc(__pyx_v_theta, __pyx_v_geo, __pyx_v_path, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.Nc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">358</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">359</span>:     The number of pairs of compression chambers in existence at a given</pre>
<pre class="cython line score-0">&#xA0;<span class="">360</span>:     crank angle</pre>
<pre class="cython line score-0">&#xA0;<span class="">361</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">362</span>:     Arguments:</pre>
<pre class="cython line score-0">&#xA0;<span class="">363</span>:         theta : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">364</span>:             The crank angle in radians.</pre>
<pre class="cython line score-0">&#xA0;<span class="">365</span>:         geo : DanfossGeoVals instance</pre>
<pre class="cython line score-0">&#xA0;<span class="">366</span>:         path : int</pre>
<pre class="cython line score-0">&#xA0;<span class="">367</span>:             The path index; 1 for s1, c1.x, d1</pre>
<pre class="cython line score-0">&#xA0;<span class="">368</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">369</span>:     Returns:</pre>
<pre class="cython line score-0">&#xA0;<span class="">370</span>:         Nc : int</pre>
<pre class="cython line score-0">&#xA0;<span class="">371</span>:             Number of pairs of compressions chambers</pre>
<pre class="cython line score-0">&#xA0;<span class="">372</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">373</span>:     NOTE:</pre>
<pre class="cython line score-0">&#xA0;<span class="">374</span>:     For externally asymmetric scroll wrap, theta_d is the same for both paths.  You can</pre>
<pre class="cython line score-0">&#xA0;<span class="">375</span>:     see this clearly from looking at a plot of the scroll wraps and their control volumes</pre>
<pre class="cython line score-0">&#xA0;<span class="">376</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">377</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">378</span>:     cdef CVInvolutes angles</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">379</span>:     if path == 1:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_path) {
    case 1:
/* … */
    break;
    case 2:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">380</span>:         angles = CVangles(theta, geo, common.keyIs1)</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIs1, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 380, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_v_angles = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">381</span>:         return int(floor((angles.Inner.phi_min-geo.phi_oos)/(2*pi)))</pre>
<pre class='cython code score-5 '>    __pyx_t_2 = (__pyx_v_angles-&gt;Inner-&gt;phi_min - __pyx_v_geo-&gt;__pyx_base.phi_oos);
    __pyx_t_3 = (2.0 * M_PI);
    if (unlikely(__pyx_t_3 == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>
    }
    __pyx_r = ((int)floor((__pyx_t_2 / __pyx_t_3)));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">382</span>:     elif path == 2:</pre>
<pre class='cython code score-0 '>    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">383</span>:         angles = CVangles(theta, geo, common.keyIs2)</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIs2, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 383, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_v_angles = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">384</span>:         return int(floor((angles.Inner.phi_min-geo.phi_fos)/(2*pi)))</pre>
<pre class='cython code score-5 '>    __pyx_t_3 = (__pyx_v_angles-&gt;Inner-&gt;phi_min - __pyx_v_geo-&gt;__pyx_base.phi_fos);
    __pyx_t_2 = (2.0 * M_PI);
    if (unlikely(__pyx_t_2 == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 384, __pyx_L1_error)</span>
    }
    __pyx_r = ((int)floor((__pyx_t_3 / __pyx_t_2)));
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">385</span>:     else:</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">386</span>:         raise ValueError("path is invalid: "+str(path))</pre>
<pre class='cython code score-17 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_path);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 386, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 386, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_path_is_invalid, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 386, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 386, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 386, __pyx_L1_error)</span>
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">387</span>: </pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">388</span>: cpdef int getNc(double theta, DanfossGeoVals geo, int path):</pre>
<pre class='cython code score-57 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_17getNc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_12DanfossPDSim_16asymm_scroll_geo_getNc(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, int __pyx_v_path, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("getNc", 0);
  <span class='trace'>__Pyx_TraceCall</span>("getNc", __pyx_f[0], 388, 0, <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("DanfossPDSim.asymm_scroll_geo.getNc", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_17getNc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_16getNc[] = "getNc(double theta, DanfossGeoVals geo, int path) -&gt; int\n\n    A passthrough alias to be the same as the symmetric geometry module\n\n    See Nc()\n    ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_17getNc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  int __pyx_v_path;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("getNc (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_path,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("getNc", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("getNc", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "getNc") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
    __pyx_v_path = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]); if (unlikely((__pyx_v_path == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("getNc", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.getNc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_16getNc(__pyx_self, __pyx_v_theta, __pyx_v_geo, __pyx_v_path);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_16getNc(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, int __pyx_v_path) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("getNc", 0);
  <span class='trace'>__Pyx_TraceCall</span>("getNc (wrapper)", __pyx_f[0], 388, 0, <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_12DanfossPDSim_16asymm_scroll_geo_getNc(__pyx_v_theta, __pyx_v_geo, __pyx_v_path, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.getNc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">389</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">390</span>:     A passthrough alias to be the same as the symmetric geometry module</pre>
<pre class="cython line score-0">&#xA0;<span class="">391</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">392</span>:     See Nc()</pre>
<pre class="cython line score-0">&#xA0;<span class="">393</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">394</span>:     return Nc(theta, geo, path)</pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Nc(__pyx_v_theta, __pyx_v_geo, __pyx_v_path, 0);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">395</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">396</span>: </pre>
<pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">397</span>: cpdef double Green_circle(double t, double r, double x0, double y0):</pre>
<pre class='cython code score-87 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_19Green_circle(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle(double __pyx_v_t, double __pyx_v_r, double __pyx_v_x0, double __pyx_v_y0, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Green_circle", 0);
  <span class='trace'>__Pyx_TraceCall</span>("Green_circle", __pyx_f[0], 397, 0, <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("DanfossPDSim.asymm_scroll_geo.Green_circle", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_19Green_circle(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_18Green_circle[] = "Green_circle(double t, double r, double x0, double y0) -&gt; double\n Anti-derivative for arc segment on fixed scroll ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_19Green_circle(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_t;
  double __pyx_v_r;
  double __pyx_v_x0;
  double __pyx_v_y0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Green_circle (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_t,&amp;__pyx_n_s_r,&amp;__pyx_n_s_x0,&amp;__pyx_n_s_y0,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Green_circle", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Green_circle", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Green_circle", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Green_circle") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_t = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_t == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L3_error)</span>
    __pyx_v_r = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_r == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L3_error)</span>
    __pyx_v_x0 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_x0 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L3_error)</span>
    __pyx_v_y0 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_y0 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Green_circle", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.Green_circle", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_18Green_circle(__pyx_self, __pyx_v_t, __pyx_v_r, __pyx_v_x0, __pyx_v_y0);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_18Green_circle(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_t, double __pyx_v_r, double __pyx_v_x0, double __pyx_v_y0) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Green_circle", 0);
  <span class='trace'>__Pyx_TraceCall</span>("Green_circle (wrapper)", __pyx_f[0], 397, 0, <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle(__pyx_v_t, __pyx_v_r, __pyx_v_x0, __pyx_v_y0, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 397, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.Green_circle", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">398</span>:     """ Anti-derivative for arc segment on fixed scroll """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">399</span>:     return r*(r*t + x0*sin(t) - y0*cos(t))</pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_r * (((__pyx_v_r * __pyx_v_t) + (__pyx_v_x0 * sin(__pyx_v_t))) - (__pyx_v_y0 * cos(__pyx_v_t))));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">400</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">401</span>: cdef double Green_circle_orb(double t, double r, double x0, double y0, double r_o, double Theta):</pre>
<pre class='cython code score-2 '>static double __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle_orb(double __pyx_v_t, double __pyx_v_r, double __pyx_v_x0, double __pyx_v_y0, double __pyx_v_r_o, double __pyx_v_Theta) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Green_circle_orb", 0);
  <span class='trace'>__Pyx_TraceCall</span>("Green_circle_orb", __pyx_f[0], 401, 0, <span class='error_goto'>__PYX_ERR(0, 401, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("DanfossPDSim.asymm_scroll_geo.Green_circle_orb", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">402</span>:     """ Anti-derivative for arc segment on orbiting scroll """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">403</span>:     return r*(r*t - r_o*sin(t - Theta) + x0*sin(t) - y0*cos(t))</pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_r * ((((__pyx_v_r * __pyx_v_t) - (__pyx_v_r_o * sin((__pyx_v_t - __pyx_v_Theta)))) + (__pyx_v_x0 * sin(__pyx_v_t))) - (__pyx_v_y0 * cos(__pyx_v_t))));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">404</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">405</span>: cdef double dGreen_circle_orb_dtheta(double t, double r, double x0, double y0, double r_o, double Theta):</pre>
<pre class='cython code score-2 '>static double __pyx_f_12DanfossPDSim_16asymm_scroll_geo_dGreen_circle_orb_dtheta(double __pyx_v_t, double __pyx_v_r, CYTHON_UNUSED double __pyx_v_x0, CYTHON_UNUSED double __pyx_v_y0, double __pyx_v_r_o, double __pyx_v_Theta) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dGreen_circle_orb_dtheta", 0);
  <span class='trace'>__Pyx_TraceCall</span>("dGreen_circle_orb_dtheta", __pyx_f[0], 405, 0, <span class='error_goto'>__PYX_ERR(0, 405, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("DanfossPDSim.asymm_scroll_geo.dGreen_circle_orb_dtheta", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">406</span>:     """ Derivative of anti-derivative for arc segment on fixed scroll with respect to crank angle """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">407</span>:     return -r*r_o*cos(t-Theta)</pre>
<pre class='cython code score-0 '>  __pyx_r = (((-__pyx_v_r) * __pyx_v_r_o) * cos((__pyx_v_t - __pyx_v_Theta)));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">408</span>: </pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">409</span>: cpdef VdVstruct SA(double theta, DanfossGeoVals geo):</pre>
<pre class='cython code score-52 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_21SA(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_SA(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_r;
  double __pyx_v_xee;
  double __pyx_v_yee;
  double __pyx_v_xse;
  double __pyx_v_yse;
  double __pyx_v_xoie;
  double __pyx_v_yoie;
  double __pyx_v_xooe;
  double __pyx_v_yooe;
  double __pyx_v_xfie;
  double __pyx_v_yfie;
  double __pyx_v_xssa;
  double __pyx_v_yssa;
  double __pyx_v_dx_2_dtheta;
  double __pyx_v_dy_2_dtheta;
  double __pyx_v_dx_3_dtheta;
  double __pyx_v_dy_3_dtheta;
  double __pyx_v_dxssa_dphi;
  double __pyx_v_dyssa_dphi;
  double __pyx_v_dxssa_dtheta;
  double __pyx_v_dyssa_dtheta;
  double __pyx_v_dxfie_dtheta;
  double __pyx_v_dyfie_dtheta;
  PyObject *__pyx_v_phi_s_sa = NULL;
  PyObject *__pyx_v_d_phi_s_sa_dtheta = NULL;
  double __pyx_v_x0;
  double __pyx_v_y0;
  double __pyx_v_x_1;
  double __pyx_v_y_1;
  double __pyx_v_x_2;
  double __pyx_v_y_2;
  double __pyx_v_x_3;
  double __pyx_v_y_3;
  CYTHON_UNUSED double __pyx_v_x_4;
  CYTHON_UNUSED double __pyx_v_y_4;
  double __pyx_v_beta;
  double __pyx_v_A_wall;
  double __pyx_v_A_circle;
  double __pyx_v_A_line1;
  double __pyx_v_A_line2;
  double __pyx_v_A_oo;
  double __pyx_v_A_line3;
  double __pyx_v_V;
  double __pyx_v_dx_1_dtheta;
  double __pyx_v_dy_1_dtheta;
  CYTHON_UNUSED double __pyx_v_dx_4_dtheta;
  CYTHON_UNUSED double __pyx_v_dy_4_dtheta;
  PyObject *__pyx_v_dA_wall_dtheta = NULL;
  double __pyx_v_dA_circle_dtheta;
  double __pyx_v_dA_line1_dtheta;
  double __pyx_v_dA_line2_dtheta;
  PyObject *__pyx_v_dA_oo_dtheta = NULL;
  double __pyx_v_dA_line3_dtheta;
  PyObject *__pyx_v_dV = NULL;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_v_VdV = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SA", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SA", __pyx_f[0], 409, 0, <span class='error_goto'>__PYX_ERR(0, 409, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.SA", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_phi_s_sa);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_d_phi_s_sa_dtheta);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dA_wall_dtheta);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dA_oo_dtheta);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dV);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_VdV);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_21SA(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_20SA[] = "SA(double theta, DanfossGeoVals geo) -&gt; VdVstruct";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_21SA(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SA (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SA", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 409, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "SA") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 409, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 409, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SA", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 409, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.SA", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 409, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_20SA(__pyx_self, __pyx_v_theta, __pyx_v_geo);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_20SA(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SA", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SA (wrapper)", __pyx_f[0], 409, 0, <span class='error_goto'>__PYX_ERR(0, 409, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_SA(__pyx_v_theta, __pyx_v_geo, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 409, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.SA", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">410</span>:     r = (2*pi*geo.rb-geo.t)/2.0</pre>
<pre class='cython code score-0 '>  __pyx_v_r = ((((2.0 * M_PI) * __pyx_v_geo-&gt;__pyx_base.rb) - __pyx_v_geo-&gt;__pyx_base.t) / 2.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">411</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">412</span>:     cdef double xee,yee,xse,yse,xoie,yoie,xooe,yooe,xfie,yfie,xssa,yssa</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">413</span>:     cdef double dx_2_dtheta, dy_2_dtheta, dx_3_dtheta, dy_3_dtheta, dxssa_dphi=0, dyssa_dphi=0, dxssa_dtheta=0, dyssa_dtheta=0, dxfie_dtheta=0, dyfie_dtheta=0</pre>
<pre class='cython code score-0 '>  __pyx_v_dxssa_dphi = 0.0;
  __pyx_v_dyssa_dphi = 0.0;
  __pyx_v_dxssa_dtheta = 0.0;
  __pyx_v_dyssa_dtheta = 0.0;
  __pyx_v_dxfie_dtheta = 0.0;
  __pyx_v_dyfie_dtheta = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">414</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">415</span>:     phi_s_sa, d_phi_s_sa_dtheta = phi_s1_sa(theta, geo)</pre>
<pre class='cython code score-15 '>  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_phi_s1_sa(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 415, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(__pyx_t_1 != Py_None)) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 415, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 415, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 415, __pyx_L1_error)</span>
  }
  __pyx_v_phi_s_sa = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_d_phi_s_sa_dtheta = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">416</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">417</span>:     common._coords_inv_d_int(geo.phi_oie + pi,geo,0.0,common.INVOLUTE_FI, &amp;xee, &amp;yee)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int((__pyx_v_geo-&gt;__pyx_base.phi_oie + M_PI), ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), 0.0, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI, (&amp;__pyx_v_xee), (&amp;__pyx_v_yee));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 417, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">418</span>:     common._coords_inv_d_int(geo.phi_oie - pi,geo,0.0,common.INVOLUTE_FO, &amp;xse, &amp;yse)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int((__pyx_v_geo-&gt;__pyx_base.phi_oie - M_PI), ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), 0.0, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO, (&amp;__pyx_v_xse), (&amp;__pyx_v_yse));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">419</span>:     common._coords_inv_d_int(geo.phi_oie,geo,theta,common.INVOLUTE_OI, &amp;xoie, &amp;yoie)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(__pyx_v_geo-&gt;__pyx_base.phi_oie, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI, (&amp;__pyx_v_xoie), (&amp;__pyx_v_yoie));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 419, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">420</span>:     common._coords_inv_d_int(geo.phi_ooe,geo,theta,common.INVOLUTE_OO, &amp;xooe, &amp;yooe)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(__pyx_v_geo-&gt;__pyx_base.phi_ooe, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO, (&amp;__pyx_v_xooe), (&amp;__pyx_v_yooe));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">421</span>:     common._coords_inv_d_int(geo.phi_fie,geo,theta,common.INVOLUTE_FI, &amp;xfie, &amp;yfie)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(__pyx_v_geo-&gt;__pyx_base.phi_fie, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI, (&amp;__pyx_v_xfie), (&amp;__pyx_v_yfie));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 421, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">422</span>:     common._coords_inv_d_int(phi_s_sa,geo,theta,common.INVOLUTE_OO, &amp;xssa, &amp;yssa)</pre>
<pre class='cython code score-11 '>  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi_s_sa); if (unlikely((__pyx_t_4 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 422, __pyx_L1_error)</span>
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(__pyx_t_4, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO, (&amp;__pyx_v_xssa), (&amp;__pyx_v_yssa));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 422, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">423</span>:     x0, y0 = (xee+xse)/2, (yee+yse)/2</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_xee + __pyx_v_xse) / 2.0);
  __pyx_t_5 = ((__pyx_v_yee + __pyx_v_yse) / 2.0);
  __pyx_v_x0 = __pyx_t_4;
  __pyx_v_y0 = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">424</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">425</span>:     x_1 = xse; y_1 = yse</pre>
<pre class='cython code score-0 '>  __pyx_v_x_1 = __pyx_v_xse;
  __pyx_v_y_1 = __pyx_v_yse;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">426</span>:     x_2 = xoie; y_2 = yoie</pre>
<pre class='cython code score-0 '>  __pyx_v_x_2 = __pyx_v_xoie;
  __pyx_v_y_2 = __pyx_v_yoie;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">427</span>:     x_3 = xooe; y_3 = yooe</pre>
<pre class='cython code score-0 '>  __pyx_v_x_3 = __pyx_v_xooe;
  __pyx_v_y_3 = __pyx_v_yooe;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">428</span>:     x_4 = xee; y_4 = yee</pre>
<pre class='cython code score-0 '>  __pyx_v_x_4 = __pyx_v_xee;
  __pyx_v_y_4 = __pyx_v_yee;
</pre><pre class="cython line score-0">&#xA0;<span class="">429</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">430</span>:     beta = atan2(yee-y0,xee-x0)</pre>
<pre class='cython code score-0 '>  __pyx_v_beta = atan2((__pyx_v_yee - __pyx_v_y0), (__pyx_v_xee - __pyx_v_x0));
</pre><pre class="cython line score-0">&#xA0;<span class="">431</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">432</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">433</span>:     ## ------------------------ VOLUME -------------------------------</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">434</span>:     A_wall = 0.5*(Gr(geo.phi_oie + pi, geo, theta, INVOLUTE_FI) - Gr(geo.phi_fie, geo, theta, INVOLUTE_FI))</pre>
<pre class='cython code score-0 '>  __pyx_v_A_wall = (0.5 * (__pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr((__pyx_v_geo-&gt;__pyx_base.phi_oie + M_PI), ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr(__pyx_v_geo-&gt;__pyx_base.phi_fie, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI, 0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">435</span>:     A_circle = 0.5*(Green_circle(beta+pi, r, x0, y0) - Green_circle(beta, r, x0, y0))</pre>
<pre class='cython code score-0 '>  __pyx_v_A_circle = (0.5 * (__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle((__pyx_v_beta + M_PI), __pyx_v_r, __pyx_v_x0, __pyx_v_y0, 0) - __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle(__pyx_v_beta, __pyx_v_r, __pyx_v_x0, __pyx_v_y0, 0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">436</span>:     A_line1 = 0.5*(x_1*y_2 - x_2*y_1)</pre>
<pre class='cython code score-0 '>  __pyx_v_A_line1 = (0.5 * ((__pyx_v_x_1 * __pyx_v_y_2) - (__pyx_v_x_2 * __pyx_v_y_1)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">437</span>:     A_line2 = 0.5*(x_2*y_3 - x_3*y_2)</pre>
<pre class='cython code score-0 '>  __pyx_v_A_line2 = (0.5 * ((__pyx_v_x_2 * __pyx_v_y_3) - (__pyx_v_x_3 * __pyx_v_y_2)));
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">438</span>:     A_oo = 0.5*(Gr(geo.phi_oie, geo, theta, INVOLUTE_OO) - Gr(phi_s_sa, geo, theta, INVOLUTE_OO))</pre>
<pre class='cython code score-10 '>  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi_s_sa); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 438, __pyx_L1_error)</span>
  __pyx_v_A_oo = (0.5 * (__pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr(__pyx_v_geo-&gt;__pyx_base.phi_oie, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr(__pyx_t_5, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO, 0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">439</span>:     A_line3 = 0.5*(xssa*yfie - yssa*xfie)</pre>
<pre class='cython code score-0 '>  __pyx_v_A_line3 = (0.5 * ((__pyx_v_xssa * __pyx_v_yfie) - (__pyx_v_yssa * __pyx_v_xfie)));
</pre><pre class="cython line score-0">&#xA0;<span class="">440</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">441</span>:     V = geo.h*(A_wall + A_circle + A_line1 + A_line2 + A_oo + A_line3)</pre>
<pre class='cython code score-0 '>  __pyx_v_V = (__pyx_v_geo-&gt;__pyx_base.h * (((((__pyx_v_A_wall + __pyx_v_A_circle) + __pyx_v_A_line1) + __pyx_v_A_line2) + __pyx_v_A_oo) + __pyx_v_A_line3));
</pre><pre class="cython line score-0">&#xA0;<span class="">442</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">443</span>:     dx_1_dtheta, dy_1_dtheta = 0.0, 0.0</pre>
<pre class='cython code score-0 '>  __pyx_t_5 = 0.0;
  __pyx_t_4 = 0.0;
  __pyx_v_dx_1_dtheta = __pyx_t_5;
  __pyx_v_dy_1_dtheta = __pyx_t_4;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">444</span>:     common.coords_inv_dtheta(geo.phi_oie, geo, theta, INVOLUTE_OI, &amp;dx_2_dtheta, &amp;dy_2_dtheta)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv_dtheta(__pyx_v_geo-&gt;__pyx_base.phi_oie, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI, (&amp;__pyx_v_dx_2_dtheta), (&amp;__pyx_v_dy_2_dtheta));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">445</span>:     common.coords_inv_dtheta(geo.phi_ooe, geo, theta, INVOLUTE_OO, &amp;dx_3_dtheta, &amp;dy_3_dtheta)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv_dtheta(__pyx_v_geo-&gt;__pyx_base.phi_ooe, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO, (&amp;__pyx_v_dx_3_dtheta), (&amp;__pyx_v_dy_3_dtheta));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">446</span>:     dx_4_dtheta, dy_4_dtheta = 0.0, 0.0</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0.0;
  __pyx_t_5 = 0.0;
  __pyx_v_dx_4_dtheta = __pyx_t_4;
  __pyx_v_dy_4_dtheta = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">447</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">448</span>:     dA_wall_dtheta = 0</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_v_dA_wall_dtheta = __pyx_int_0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">449</span>:     dA_circle_dtheta = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_circle_dtheta = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">450</span>:     dA_line1_dtheta = 0.5*(x_1*dy_2_dtheta + y_2*dx_1_dtheta - x_2*dy_1_dtheta - y_1*dx_2_dtheta)</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_line1_dtheta = (0.5 * ((((__pyx_v_x_1 * __pyx_v_dy_2_dtheta) + (__pyx_v_y_2 * __pyx_v_dx_1_dtheta)) - (__pyx_v_x_2 * __pyx_v_dy_1_dtheta)) - (__pyx_v_y_1 * __pyx_v_dx_2_dtheta)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">451</span>:     dA_line2_dtheta = 0.5*(x_2*dy_3_dtheta + y_3*dx_2_dtheta - x_3*dy_2_dtheta - y_2*dx_3_dtheta)</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_line2_dtheta = (0.5 * ((((__pyx_v_x_2 * __pyx_v_dy_3_dtheta) + (__pyx_v_y_3 * __pyx_v_dx_2_dtheta)) - (__pyx_v_x_3 * __pyx_v_dy_2_dtheta)) - (__pyx_v_y_2 * __pyx_v_dx_3_dtheta)));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">452</span>:     dA_oo_dtheta = 0.5*(0</pre>
<pre class='cython code score-6 '>  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dA_oo_dtheta = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">453</span>:                       +dGr_dtheta(geo.phi_oie, geo, theta, INVOLUTE_OO)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((0.0 + __pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dtheta(__pyx_v_geo-&gt;__pyx_base.phi_oie, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO, 0)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 453, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">454</span>:                       -dGr_dphi(phi_s_sa, geo, theta, INVOLUTE_OO)*d_phi_s_sa_dtheta</pre>
<pre class='cython code score-28 '>  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi_s_sa); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dphi(__pyx_t_5, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO, 0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 454, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_v_d_phi_s_sa_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 454, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 454, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">455</span>:                       -dGr_dtheta(phi_s_sa, geo, theta, INVOLUTE_OO)</pre>
<pre class='cython code score-22 '>  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi_s_sa); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 455, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dtheta(__pyx_t_5, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO, 0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 455, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 455, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">456</span>:                       )</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">457</span>:     dxfie_dtheta = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_dxfie_dtheta = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">458</span>:     dyfie_dtheta = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_dyfie_dtheta = 0.0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">459</span>:     coords_inv_dtheta(phi_s_sa, geo, theta, INVOLUTE_OO, &amp;dxssa_dtheta, &amp;dyssa_dtheta)</pre>
<pre class='cython code score-11 '>  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi_s_sa); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 459, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv_dtheta(__pyx_t_5, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO, (&amp;__pyx_v_dxssa_dtheta), (&amp;__pyx_v_dyssa_dtheta));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">460</span>:     _dcoords_inv_dphi_int(phi_s_sa, geo, theta, INVOLUTE_OO, &amp;dxssa_dphi, &amp;dyssa_dphi)</pre>
<pre class='cython code score-11 '>  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi_s_sa); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 460, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__dcoords_inv_dphi_int(__pyx_t_5, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO, (&amp;__pyx_v_dxssa_dphi), (&amp;__pyx_v_dyssa_dphi));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">461</span>:     dxssa_dtheta += dxssa_dphi*d_phi_s_sa_dtheta</pre>
<pre class='cython code score-34 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dxssa_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 461, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dxssa_dphi);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 461, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_d_phi_s_sa_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 461, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 461, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 461, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dxssa_dtheta = __pyx_t_5;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">462</span>:     dyssa_dtheta += dyssa_dphi*d_phi_s_sa_dtheta</pre>
<pre class='cython code score-34 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dyssa_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dyssa_dphi);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_v_d_phi_s_sa_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 462, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dyssa_dtheta = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">463</span>:     dA_line3_dtheta = 0.5*(xssa*dyfie_dtheta + yfie*dxssa_dtheta - xfie*dyssa_dtheta - yssa*dxfie_dtheta)</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_line3_dtheta = (0.5 * ((((__pyx_v_xssa * __pyx_v_dyfie_dtheta) + (__pyx_v_yfie * __pyx_v_dxssa_dtheta)) - (__pyx_v_xfie * __pyx_v_dyssa_dtheta)) - (__pyx_v_yssa * __pyx_v_dxfie_dtheta)));
</pre><pre class="cython line score-0">&#xA0;<span class="">464</span>: </pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">465</span>:     dV = geo.h*(dA_wall_dtheta + dA_circle_dtheta + dA_line1_dtheta + dA_line2_dtheta + dA_oo_dtheta + dA_line3_dtheta)</pre>
<pre class='cython code score-65 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.h);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dA_circle_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_dA_wall_dtheta, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dA_line1_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dA_line2_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_dA_oo_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dA_line3_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_dV = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">466</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">467</span>:     cdef VdVstruct VdV = VdVstruct.__new__(VdVstruct)</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = __Pyx_tp_new(((PyObject *)__pyx_ptype_5PDSim_6scroll_17common_scroll_geo_VdVstruct), __pyx_empty_tuple);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 467, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_VdVstruct)))) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>
  __pyx_v_VdV = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">468</span>:     VdV.V = V</pre>
<pre class='cython code score-0 '>  __pyx_v_VdV-&gt;V = __pyx_v_V;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">469</span>:     VdV.dV = dV</pre>
<pre class='cython code score-10 '>  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_dV); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 469, __pyx_L1_error)</span>
  __pyx_v_VdV-&gt;dV = __pyx_t_5;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">470</span>:     return VdV</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_VdV));
  __pyx_r = __pyx_v_VdV;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">471</span>: </pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">472</span>: cpdef dict SA_forces(double theta, DanfossGeoVals geo):</pre>
<pre class='cython code score-73 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_23SA_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_SA_forces(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, CYTHON_UNUSED int __pyx_skip_dispatch) {
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_angles = 0;
  CYTHON_UNUSED double __pyx_v_r;
  PyObject *__pyx_v_xee = NULL;
  PyObject *__pyx_v_yee = NULL;
  PyObject *__pyx_v_xse = NULL;
  PyObject *__pyx_v_yse = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_xoie = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_yoie = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_xooe = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_yooe = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_x0 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_y0 = NULL;
  PyObject *__pyx_v_fx_p = NULL;
  PyObject *__pyx_v_fy_p = NULL;
  PyObject *__pyx_v_M_O_p = NULL;
  PyObject *__pyx_v_x1 = NULL;
  PyObject *__pyx_v_y1 = NULL;
  PyObject *__pyx_v_x2 = NULL;
  PyObject *__pyx_v_y2 = NULL;
  PyObject *__pyx_v_xmid = NULL;
  PyObject *__pyx_v_ymid = NULL;
  PyObject *__pyx_v_nx1 = NULL;
  PyObject *__pyx_v_ny1 = NULL;
  double __pyx_v_A_line;
  PyObject *__pyx_v_fO_p_line = NULL;
  double __pyx_v_THETA;
  PyObject *__pyx_v_r_line = NULL;
  PyObject *__pyx_v_cross = NULL;
  long __pyx_v_cx;
  long __pyx_v_cy;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SA_forces", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SA_forces", __pyx_f[0], 472, 0, <span class='error_goto'>__PYX_ERR(0, 472, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.SA_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_angles);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xee);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yee);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xse);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yse);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xoie);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yoie);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xooe);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yooe);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fx_p);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fy_p);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_M_O_p);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xmid);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ymid);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fO_p_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cross);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_23SA_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_22SA_forces[] = "SA_forces(double theta, DanfossGeoVals geo) -&gt; dict";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_23SA_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SA_forces (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SA_forces", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 472, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "SA_forces") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 472, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 472, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SA_forces", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 472, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.SA_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 472, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_22SA_forces(__pyx_self, __pyx_v_theta, __pyx_v_geo);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_22SA_forces(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SA_forces", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SA_forces (wrapper)", __pyx_f[0], 472, 0, <span class='error_goto'>__PYX_ERR(0, 472, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_SA_forces(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.SA_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">473</span>:     cdef CVInvolutes angles = CVangles(theta, geo, keyIs1)</pre>
<pre class='cython code score-10 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_keyIs1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 473, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 473, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_t_2, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 473, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_angles = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">474</span>:     r = (2*pi*geo.rb-geo.t)/2.0</pre>
<pre class='cython code score-0 '>  __pyx_v_r = ((((2.0 * M_PI) * __pyx_v_geo-&gt;__pyx_base.rb) - __pyx_v_geo-&gt;__pyx_base.t) / 2.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">475</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">476</span>:     xee,yee = coords_inv(geo.phi_fie,geo,0.0,'fi')</pre>
<pre class='cython code score-21 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_fie);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 476, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4.__pyx_n = 1;
  __pyx_t_4.flag = __pyx_n_s_fi;
  __pyx_t_3 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_1, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), 0.0, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 476, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(__pyx_t_3 != Py_None)) {
    PyObject* sequence = __pyx_t_3;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 476, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 476, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 476, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 476, __pyx_L1_error)</span>
  }
  __pyx_v_xee = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_v_yee = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">477</span>:     xse,yse = coords_inv(geo.phi_foe-2*pi,geo,0.0,'fo')</pre>
<pre class='cython code score-21 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.phi_foe - (2.0 * M_PI)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4.__pyx_n = 1;
  __pyx_t_4.flag = __pyx_n_s_fo;
  __pyx_t_5 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_3, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), 0.0, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(__pyx_t_5 != Py_None)) {
    PyObject* sequence = __pyx_t_5;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 477, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 477, __pyx_L1_error)</span>
  }
  __pyx_v_xse = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_yse = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">478</span>:     xoie,yoie = coords_inv(geo.phi_oie,geo,theta,'oi')</pre>
<pre class='cython code score-21 '>  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_oie);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 478, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4.__pyx_n = 1;
  __pyx_t_4.flag = __pyx_n_s_oi;
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_5, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 478, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (likely(__pyx_t_1 != Py_None)) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 478, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 478, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 478, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 478, __pyx_L1_error)</span>
  }
  __pyx_v_xoie = __pyx_t_5;
  __pyx_t_5 = 0;
  __pyx_v_yoie = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">479</span>:     xooe,yooe = coords_inv(geo.phi_ooe,geo,theta,'oo')</pre>
<pre class='cython code score-21 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_ooe);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4.__pyx_n = 1;
  __pyx_t_4.flag = __pyx_n_s_oo;
  __pyx_t_3 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_1, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(__pyx_t_3 != Py_None)) {
    PyObject* sequence = __pyx_t_3;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>
  }
  __pyx_v_xooe = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_v_yooe = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">480</span>:     x0, y0 = (xee+xse)/2, (yee+yse)/2</pre>
<pre class='cython code score-16 '>  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_xee, __pyx_v_xse);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_yee, __pyx_v_yse);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_x0 = __pyx_t_5;
  __pyx_t_5 = 0;
  __pyx_v_y0 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">481</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">482</span>:     # Calculate the force terms divided by the pressure acting on the outer edge of the orbiting scroll</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">483</span>:     fx_p = fFx_p(geo.phi_ooe, geo, theta, angles.Inner.involute) - fFx_p(angles.Inner.phi_max, geo, theta, angles.Inner.involute)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_f_5PDSim_6scroll_17common_scroll_geo_fFx_p(__pyx_v_geo-&gt;__pyx_base.phi_ooe, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_v_angles-&gt;Inner-&gt;involute, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_fFx_p(__pyx_v_angles-&gt;Inner-&gt;phi_max, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_v_angles-&gt;Inner-&gt;involute, 0)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 483, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_fx_p = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">484</span>:     fy_p = fFy_p(geo.phi_ooe, geo, theta, angles.Inner.involute) - fFy_p(angles.Inner.phi_max, geo, theta, angles.Inner.involute)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_f_5PDSim_6scroll_17common_scroll_geo_fFy_p(__pyx_v_geo-&gt;__pyx_base.phi_ooe, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_v_angles-&gt;Inner-&gt;involute, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_fFy_p(__pyx_v_angles-&gt;Inner-&gt;phi_max, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_v_angles-&gt;Inner-&gt;involute, 0)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 484, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_fy_p = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">485</span>:     M_O_p = fMO_p(geo.phi_ooe, geo, theta, angles.Inner.involute) - fMO_p(angles.Inner.phi_max, geo, theta, angles.Inner.involute)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_f_5PDSim_6scroll_17common_scroll_geo_fMO_p(__pyx_v_geo-&gt;__pyx_base.phi_ooe, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_v_angles-&gt;Inner-&gt;involute, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_fMO_p(__pyx_v_angles-&gt;Inner-&gt;phi_max, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_v_angles-&gt;Inner-&gt;involute, 0)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 485, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_M_O_p = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">486</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">487</span>:     # Add contribution from the end of the scroll, connecting the inner and outer involutes</pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">488</span>:     x1, y1 = coords_inv(geo.phi_ooe, geo, theta, 'oo')</pre>
<pre class='cython code score-21 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_ooe);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4.__pyx_n = 1;
  __pyx_t_4.flag = __pyx_n_s_oo;
  __pyx_t_5 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_1, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(__pyx_t_5 != Py_None)) {
    PyObject* sequence = __pyx_t_5;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 488, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 488, __pyx_L1_error)</span>
  }
  __pyx_v_x1 = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_v_y1 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">489</span>:     x2, y2 = coords_inv(geo.phi_oie, geo, theta, 'oi')</pre>
<pre class='cython code score-21 '>  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_oie);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4.__pyx_n = 1;
  __pyx_t_4.flag = __pyx_n_s_oi;
  __pyx_t_3 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_5, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (likely(__pyx_t_3 != Py_None)) {
    PyObject* sequence = __pyx_t_3;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 489, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    #else
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 489, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 489, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 489, __pyx_L1_error)</span>
  }
  __pyx_v_x2 = __pyx_t_5;
  __pyx_t_5 = 0;
  __pyx_v_y2 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">490</span>:     xmid = (x1+x2)/2; ymid = (y1+y2)/2</pre>
<pre class='cython code score-16 '>  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_x1, __pyx_v_x2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_xmid = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_y1, __pyx_v_y2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ymid = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">491</span>:     nx1, ny1 = coords_norm(geo.phi_ooe, geo, theta, 'oo')</pre>
<pre class='cython code score-21 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_ooe);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6.__pyx_n = 1;
  __pyx_t_6.flag = __pyx_n_s_oo;
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_norm(__pyx_t_3, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(__pyx_t_1 != Py_None)) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 491, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 491, __pyx_L1_error)</span>
  }
  __pyx_v_nx1 = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_ny1 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">492</span>:     ny1, nx1 = -nx1[0], ny1[0]</pre>
<pre class='cython code score-12 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_nx1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ny1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ny1, __pyx_t_5);
  __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_nx1, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">493</span>:     # Make sure you get the normal pointing towards the orbiting scroll!</pre>
<pre class="cython line score-0">&#xA0;<span class="">494</span>:     # The cross product of line going from inner to outer scroll wrap ends</pre>
<pre class="cython line score-0">&#xA0;<span class="">495</span>:     # with normal should be negative</pre>
<pre class="cython line score-86" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">496</span>:     if np.cross([x1-x2,y1-y2,0],[nx1, ny1, 0])[2] &gt; 0:</pre>
<pre class='cython code score-86 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_cross);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_x1, __pyx_v_x2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_y1, __pyx_v_y2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 2, __pyx_int_0);
  __pyx_t_5 = 0;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_nx1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_ny1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 2, __pyx_int_0);
  __pyx_t_5 = NULL;
  __pyx_t_2 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_2 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_8, __pyx_t_7};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_2, 2+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_8, __pyx_t_7};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_2, 2+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_2, __pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_2, __pyx_t_7);
    __pyx_t_8 = 0;
    __pyx_t_7 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">497</span>:         nx1 *= -1</pre>
<pre class='cython code score-6 '>    __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_v_nx1, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 497, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_nx1, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">498</span>:         ny1 *= -1</pre>
<pre class='cython code score-6 '>    __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_v_ny1, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ny1, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">499</span>:     # Length is the thickness of scroll, height is scroll height</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">500</span>:     A_line = geo.t*geo.h</pre>
<pre class='cython code score-0 '>  __pyx_v_A_line = (__pyx_v_geo-&gt;__pyx_base.t * __pyx_v_geo-&gt;__pyx_base.h);
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">501</span>:     fx_p += A_line*nx1</pre>
<pre class='cython code score-18 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_A_line);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_nx1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 501, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_fx_p, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_fx_p, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">502</span>:     fy_p += A_line*ny1</pre>
<pre class='cython code score-18 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_A_line);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 502, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_ny1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 502, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_fy_p, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 502, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_fy_p, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">503</span>:     fO_p_line = [A_line*nx1, A_line*ny1, 0.0]</pre>
<pre class='cython code score-31 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_A_line);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_nx1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_A_line);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_ny1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_float_0_0);
  __pyx_t_3 = 0;
  __pyx_t_9 = 0;
  __pyx_v_fO_p_line = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">504</span>:     THETA = geo.phi_fie-theta-pi/2</pre>
<pre class='cython code score-0 '>  __pyx_v_THETA = ((__pyx_v_geo-&gt;__pyx_base.phi_fie - __pyx_v_theta) - (M_PI / 2.0));
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">505</span>:     r_line = [xmid - geo.ro*cos(THETA), ymid - geo.ro*sin(THETA), 0.0]</pre>
<pre class='cython code score-31 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.ro * cos(__pyx_v_THETA)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_xmid, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.ro * sin(__pyx_v_THETA)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_ymid, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_float_0_0);
  __pyx_t_9 = 0;
  __pyx_t_3 = 0;
  __pyx_v_r_line = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">506</span>:     cross = np.cross(r_line, fO_p_line)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cross);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 506, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_2 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_2 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_9)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_r_line, __pyx_v_fO_p_line};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_2, 2+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_9)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_r_line, __pyx_v_fO_p_line};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_2, 2+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 506, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r_line);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r_line);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_2, __pyx_v_r_line);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fO_p_line);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fO_p_line);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_2, __pyx_v_fO_p_line);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_cross = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">507</span>:     M_O_p += cross[2]</pre>
<pre class='cython code score-9 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_cross, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_9 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_M_O_p, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_M_O_p, __pyx_t_9);
  __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">508</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">509</span>:     cx = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_cx = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">510</span>:     cy = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_cy = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">511</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">512</span>:     return dict(cx = cx,</pre>
<pre class='cython code score-11 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_cx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_cx, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">513</span>:                 cy = cy,</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_cy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_cy, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">514</span>:                 fz_p = SA(theta,geo).V/geo.h,</pre>
<pre class='cython code score-17 '>  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_SA(__pyx_v_theta, __pyx_v_geo, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_11 = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_1)-&gt;V;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(__pyx_v_geo-&gt;__pyx_base.h == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L1_error)</span>
  }
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_11 / __pyx_v_geo-&gt;__pyx_base.h));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_fz_p, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">515</span>:                 fx_p = fx_p,</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_fx_p, __pyx_v_fx_p) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">516</span>:                 fy_p = fy_p,</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_fy_p, __pyx_v_fy_p) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">517</span>:                 M_O_p = M_O_p</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_M_O_p, __pyx_v_M_O_p) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
  __pyx_r = ((PyObject*)__pyx_t_9);
  __pyx_t_9 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">518</span>:                 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">519</span>: </pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">520</span>: cpdef VdVstruct DD(double theta, DanfossGeoVals geo):</pre>
<pre class='cython code score-61 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_25DD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_DD(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_theta_m;
  double __pyx_v_Ainv_fi;
  double __pyx_v_A_farc2;
  double __pyx_v_x_1;
  double __pyx_v_y_1;
  double __pyx_v_x_2;
  double __pyx_v_y_2;
  double __pyx_v_A_line1;
  double __pyx_v_A_farc3;
  double __pyx_v_A_farc1;
  PyObject *__pyx_v_x1_fixorb = NULL;
  PyObject *__pyx_v_y1_fixorb = NULL;
  PyObject *__pyx_v_x2_fixorb = NULL;
  PyObject *__pyx_v_y2_fixorb = NULL;
  PyObject *__pyx_v_A_line_fixorb = NULL;
  double __pyx_v_A_oarc2;
  double __pyx_v_x_5;
  double __pyx_v_y_5;
  double __pyx_v_x_6;
  double __pyx_v_y_6;
  double __pyx_v_A_line3;
  double __pyx_v_A_oarc3;
  double __pyx_v_A_oarc1;
  PyObject *__pyx_v_x1_orbfix = NULL;
  PyObject *__pyx_v_y1_orbfix = NULL;
  PyObject *__pyx_v_x2_orbfix = NULL;
  PyObject *__pyx_v_y2_orbfix = NULL;
  PyObject *__pyx_v_A_line_orbfix = NULL;
  double __pyx_v_Ainv_oi;
  PyObject *__pyx_v_V = NULL;
  double __pyx_v_dAinv_fi_dtheta;
  double __pyx_v_dA_farc2_dtheta;
  double __pyx_v_dA_line1_dtheta;
  double __pyx_v_dA_farc1_dtheta;
  double __pyx_v_dA_farc3_dtheta;
  double __pyx_v_dx1_fixorb_dtheta;
  double __pyx_v_dy1_fixorb_dtheta;
  double __pyx_v_dx2_orbfix_dtheta;
  double __pyx_v_dy2_orbfix_dtheta;
  double __pyx_v_dx2_fixorb_dtheta;
  double __pyx_v_dx_5_dtheta;
  double __pyx_v_dx_6_dtheta;
  double __pyx_v_dx1_orbfix_dtheta;
  double __pyx_v_dy2_fixorb_dtheta;
  double __pyx_v_dy_5_dtheta;
  double __pyx_v_dy_6_dtheta;
  double __pyx_v_dy1_orbfix_dtheta;
  PyObject *__pyx_v_dA_line_fixorb_dtheta = NULL;
  double __pyx_v_dA_oarc2_dtheta;
  double __pyx_v_dA_line3_dtheta;
  double __pyx_v_dA_oarc3_dtheta;
  double __pyx_v_dA_oarc1_dtheta;
  PyObject *__pyx_v_dA_line_orbfix_dtheta = NULL;
  double __pyx_v_dAinv_oi_dtheta;
  PyObject *__pyx_v_dV = NULL;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_v_VdV = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DD", 0);
  <span class='trace'>__Pyx_TraceCall</span>("DD", __pyx_f[0], 520, 0, <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DD", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x1_fixorb);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y1_fixorb);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x2_fixorb);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y2_fixorb);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_A_line_fixorb);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x1_orbfix);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y1_orbfix);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x2_orbfix);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y2_orbfix);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_A_line_orbfix);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_V);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dA_line_fixorb_dtheta);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dA_line_orbfix_dtheta);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dV);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_VdV);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_25DD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_24DD[] = "DD(double theta, DanfossGeoVals geo) -&gt; VdVstruct";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_25DD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DD (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DD", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "DD") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DD", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DD", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_24DD(__pyx_self, __pyx_v_theta, __pyx_v_geo);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_24DD(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DD", 0);
  <span class='trace'>__Pyx_TraceCall</span>("DD (wrapper)", __pyx_f[0], 520, 0, <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_DD(__pyx_v_theta, __pyx_v_geo, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DD", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">521</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">522</span>:     theta_m = geo.phi_fie - theta - pi/2</pre>
<pre class='cython code score-0 '>  __pyx_v_theta_m = ((__pyx_v_geo-&gt;__pyx_base.phi_fie - __pyx_v_theta) - (M_PI / 2.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">523</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">524</span>:     Ainv_fi = 0.5*(Gr(geo.phi_oos + pi, geo, theta, common.INVOLUTE_FI)</pre>
<pre class='cython code score-0 '>  __pyx_v_Ainv_fi = (0.5 * (__pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr((__pyx_v_geo-&gt;__pyx_base.phi_oos + M_PI), ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr(__pyx_v_geo-&gt;__pyx_base.phi_fis, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI, 0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">525</span>:                   -Gr(geo.phi_fis, geo, theta, common.INVOLUTE_FI))</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">526</span>:     A_farc2 = 0.5*(Green_circle(geo.t1_arc2,geo.ra_arc2,geo.xa_arc2,geo.ya_arc2)</pre>
<pre class='cython code score-0 '>  __pyx_v_A_farc2 = (0.5 * (__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle(__pyx_v_geo-&gt;__pyx_base.t1_arc2, __pyx_v_geo-&gt;__pyx_base.ra_arc2, __pyx_v_geo-&gt;__pyx_base.xa_arc2, __pyx_v_geo-&gt;__pyx_base.ya_arc2, 0) - __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle(__pyx_v_geo-&gt;__pyx_base.t2_arc2, __pyx_v_geo-&gt;__pyx_base.ra_arc2, __pyx_v_geo-&gt;__pyx_base.xa_arc2, __pyx_v_geo-&gt;__pyx_base.ya_arc2, 0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">527</span>:                   -Green_circle(geo.t2_arc2,geo.ra_arc2,geo.xa_arc2,geo.ya_arc2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">528</span>:                   )</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">529</span>:     x_1 = geo.xa_arc2 + geo.ra_arc2*cos(geo.t1_arc2)</pre>
<pre class='cython code score-0 '>  __pyx_v_x_1 = (__pyx_v_geo-&gt;__pyx_base.xa_arc2 + (__pyx_v_geo-&gt;__pyx_base.ra_arc2 * cos(__pyx_v_geo-&gt;__pyx_base.t1_arc2)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">530</span>:     y_1 = geo.ya_arc2 + geo.ra_arc2*sin(geo.t1_arc2)</pre>
<pre class='cython code score-0 '>  __pyx_v_y_1 = (__pyx_v_geo-&gt;__pyx_base.ya_arc2 + (__pyx_v_geo-&gt;__pyx_base.ra_arc2 * sin(__pyx_v_geo-&gt;__pyx_base.t1_arc2)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">531</span>:     x_2 = geo.xa_arc1 + geo.ra_arc1*cos(geo.t1_arc1)</pre>
<pre class='cython code score-0 '>  __pyx_v_x_2 = (__pyx_v_geo-&gt;__pyx_base.xa_arc1 + (__pyx_v_geo-&gt;__pyx_base.ra_arc1 * cos(__pyx_v_geo-&gt;__pyx_base.t1_arc1)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">532</span>:     y_2 = geo.ya_arc1 + geo.ra_arc1*sin(geo.t1_arc1)</pre>
<pre class='cython code score-0 '>  __pyx_v_y_2 = (__pyx_v_geo-&gt;__pyx_base.ya_arc1 + (__pyx_v_geo-&gt;__pyx_base.ra_arc1 * sin(__pyx_v_geo-&gt;__pyx_base.t1_arc1)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">533</span>:     A_line1 = 0.5*(x_1*y_2 - x_2*y_1)</pre>
<pre class='cython code score-0 '>  __pyx_v_A_line1 = (0.5 * ((__pyx_v_x_1 * __pyx_v_y_2) - (__pyx_v_x_2 * __pyx_v_y_1)));
</pre><pre class="cython line score-0">&#xA0;<span class="">534</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">535</span>:     A_farc3 = 0.5*(Green_circle(geo.t2_arc3,geo.ra_arc3,geo.xa_arc3,geo.ya_arc3)</pre>
<pre class='cython code score-0 '>  __pyx_v_A_farc3 = (0.5 * (__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle(__pyx_v_geo-&gt;t2_arc3, __pyx_v_geo-&gt;ra_arc3, __pyx_v_geo-&gt;xa_arc3, __pyx_v_geo-&gt;ya_arc3, 0) - __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle(__pyx_v_geo-&gt;t1_arc3, __pyx_v_geo-&gt;ra_arc3, __pyx_v_geo-&gt;xa_arc3, __pyx_v_geo-&gt;ya_arc3, 0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">536</span>:                   -Green_circle(geo.t1_arc3,geo.ra_arc3,geo.xa_arc3,geo.ya_arc3)</pre>
<pre class="cython line score-0">&#xA0;<span class="">537</span>:                   )</pre>
<pre class="cython line score-0">&#xA0;<span class="">538</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">539</span>:     A_farc1 = 0.5*(Green_circle(geo.t2_arc1,geo.ra_arc1,geo.xa_arc1,geo.ya_arc1)</pre>
<pre class='cython code score-0 '>  __pyx_v_A_farc1 = (0.5 * (__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle(__pyx_v_geo-&gt;__pyx_base.t2_arc1, __pyx_v_geo-&gt;__pyx_base.ra_arc1, __pyx_v_geo-&gt;__pyx_base.xa_arc1, __pyx_v_geo-&gt;__pyx_base.ya_arc1, 0) - __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle(__pyx_v_geo-&gt;__pyx_base.t1_arc1, __pyx_v_geo-&gt;__pyx_base.ra_arc1, __pyx_v_geo-&gt;__pyx_base.xa_arc1, __pyx_v_geo-&gt;__pyx_base.ya_arc1, 0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">540</span>:                   -Green_circle(geo.t1_arc1,geo.ra_arc1,geo.xa_arc1,geo.ya_arc1)</pre>
<pre class="cython line score-0">&#xA0;<span class="">541</span>:                   )</pre>
<pre class="cython line score-0">&#xA0;<span class="">542</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">543</span>:     # Line from fixed scroll to orbiting scroll</pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">544</span>:     x1_fixorb, y1_fixorb = coords_inv(geo.phi_oos+pi, geo, theta, 'fi')</pre>
<pre class='cython code score-21 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.phi_oos + M_PI));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3.__pyx_n = 1;
  __pyx_t_3.flag = __pyx_n_s_fi;
  __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_1, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 544, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(__pyx_t_2 != Py_None)) {
    PyObject* sequence = __pyx_t_2;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 544, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 544, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 544, __pyx_L1_error)</span>
  }
  __pyx_v_x1_fixorb = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_v_y1_fixorb = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">545</span>:     x2_fixorb, y2_fixorb = coords_inv(geo.phi_oos, geo, theta, 'oo')</pre>
<pre class='cython code score-21 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_oos);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 545, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3.__pyx_n = 1;
  __pyx_t_3.flag = __pyx_n_s_oo;
  __pyx_t_4 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_2, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 545, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(__pyx_t_4 != Py_None)) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 545, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 545, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L1_error)</span>
  }
  __pyx_v_x2_fixorb = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_y2_fixorb = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">546</span>:     A_line_fixorb = 0.5*(x1_fixorb*y2_fixorb - x2_fixorb*y1_fixorb)</pre>
<pre class='cython code score-23 '>  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_x1_fixorb, __pyx_v_y2_fixorb);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 546, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_x2_fixorb, __pyx_v_y1_fixorb);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 546, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 546, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 546, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_A_line_fixorb = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">547</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">548</span>:     A_oarc2 = 0.5*(Green_circle_orb(geo.t1_arc2,geo.ra_arc2,geo.xa_arc2,geo.ya_arc2, geo.ro, theta_m)</pre>
<pre class='cython code score-0 '>  __pyx_v_A_oarc2 = (0.5 * (__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle_orb(__pyx_v_geo-&gt;__pyx_base.t1_arc2, __pyx_v_geo-&gt;__pyx_base.ra_arc2, __pyx_v_geo-&gt;__pyx_base.xa_arc2, __pyx_v_geo-&gt;__pyx_base.ya_arc2, __pyx_v_geo-&gt;__pyx_base.ro, __pyx_v_theta_m) - __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle_orb(__pyx_v_geo-&gt;__pyx_base.t2_arc2, __pyx_v_geo-&gt;__pyx_base.ra_arc2, __pyx_v_geo-&gt;__pyx_base.xa_arc2, __pyx_v_geo-&gt;__pyx_base.ya_arc2, __pyx_v_geo-&gt;__pyx_base.ro, __pyx_v_theta_m)));
</pre><pre class="cython line score-0">&#xA0;<span class="">549</span>:                   -Green_circle_orb(geo.t2_arc2,geo.ra_arc2,geo.xa_arc2,geo.ya_arc2, geo.ro, theta_m)</pre>
<pre class="cython line score-0">&#xA0;<span class="">550</span>:                   )</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">551</span>:     x_5 = -geo.xa_arc2 - geo.ra_arc2*cos(geo.t1_arc2) + geo.ro*cos(theta_m)</pre>
<pre class='cython code score-0 '>  __pyx_v_x_5 = (((-__pyx_v_geo-&gt;__pyx_base.xa_arc2) - (__pyx_v_geo-&gt;__pyx_base.ra_arc2 * cos(__pyx_v_geo-&gt;__pyx_base.t1_arc2))) + (__pyx_v_geo-&gt;__pyx_base.ro * cos(__pyx_v_theta_m)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">552</span>:     y_5 = -geo.ya_arc2 - geo.ra_arc2*sin(geo.t1_arc2) + geo.ro*sin(theta_m)</pre>
<pre class='cython code score-0 '>  __pyx_v_y_5 = (((-__pyx_v_geo-&gt;__pyx_base.ya_arc2) - (__pyx_v_geo-&gt;__pyx_base.ra_arc2 * sin(__pyx_v_geo-&gt;__pyx_base.t1_arc2))) + (__pyx_v_geo-&gt;__pyx_base.ro * sin(__pyx_v_theta_m)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">553</span>:     x_6 = -geo.xa_arc1 - geo.ra_arc1*cos(geo.t1_arc1) + geo.ro*cos(theta_m)</pre>
<pre class='cython code score-0 '>  __pyx_v_x_6 = (((-__pyx_v_geo-&gt;__pyx_base.xa_arc1) - (__pyx_v_geo-&gt;__pyx_base.ra_arc1 * cos(__pyx_v_geo-&gt;__pyx_base.t1_arc1))) + (__pyx_v_geo-&gt;__pyx_base.ro * cos(__pyx_v_theta_m)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">554</span>:     y_6 = -geo.ya_arc1 - geo.ra_arc1*sin(geo.t1_arc1) + geo.ro*sin(theta_m)</pre>
<pre class='cython code score-0 '>  __pyx_v_y_6 = (((-__pyx_v_geo-&gt;__pyx_base.ya_arc1) - (__pyx_v_geo-&gt;__pyx_base.ra_arc1 * sin(__pyx_v_geo-&gt;__pyx_base.t1_arc1))) + (__pyx_v_geo-&gt;__pyx_base.ro * sin(__pyx_v_theta_m)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">555</span>:     A_line3 = 0.5*(x_5*y_6 - x_6*y_5)</pre>
<pre class='cython code score-0 '>  __pyx_v_A_line3 = (0.5 * ((__pyx_v_x_5 * __pyx_v_y_6) - (__pyx_v_x_6 * __pyx_v_y_5)));
</pre><pre class="cython line score-0">&#xA0;<span class="">556</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">557</span>:     A_oarc3 = 0.5*(Green_circle_orb(geo.t2_arc3,geo.ra_arc3,geo.xa_arc3,geo.ya_arc3, geo.ro, theta_m)</pre>
<pre class='cython code score-0 '>  __pyx_v_A_oarc3 = (0.5 * (__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle_orb(__pyx_v_geo-&gt;t2_arc3, __pyx_v_geo-&gt;ra_arc3, __pyx_v_geo-&gt;xa_arc3, __pyx_v_geo-&gt;ya_arc3, __pyx_v_geo-&gt;__pyx_base.ro, __pyx_v_theta_m) - __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle_orb(__pyx_v_geo-&gt;t1_arc3, __pyx_v_geo-&gt;ra_arc3, __pyx_v_geo-&gt;xa_arc3, __pyx_v_geo-&gt;ya_arc3, __pyx_v_geo-&gt;__pyx_base.ro, __pyx_v_theta_m)));
</pre><pre class="cython line score-0">&#xA0;<span class="">558</span>:                   -Green_circle_orb(geo.t1_arc3,geo.ra_arc3,geo.xa_arc3,geo.ya_arc3, geo.ro, theta_m)</pre>
<pre class="cython line score-0">&#xA0;<span class="">559</span>:                  )</pre>
<pre class="cython line score-0">&#xA0;<span class="">560</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">561</span>:     A_oarc1 = 0.5*(Green_circle_orb(geo.t2_arc1,geo.ra_arc1,geo.xa_arc1,geo.ya_arc1, geo.ro, theta_m)</pre>
<pre class='cython code score-0 '>  __pyx_v_A_oarc1 = (0.5 * (__pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle_orb(__pyx_v_geo-&gt;__pyx_base.t2_arc1, __pyx_v_geo-&gt;__pyx_base.ra_arc1, __pyx_v_geo-&gt;__pyx_base.xa_arc1, __pyx_v_geo-&gt;__pyx_base.ya_arc1, __pyx_v_geo-&gt;__pyx_base.ro, __pyx_v_theta_m) - __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Green_circle_orb(__pyx_v_geo-&gt;__pyx_base.t1_arc1, __pyx_v_geo-&gt;__pyx_base.ra_arc1, __pyx_v_geo-&gt;__pyx_base.xa_arc1, __pyx_v_geo-&gt;__pyx_base.ya_arc1, __pyx_v_geo-&gt;__pyx_base.ro, __pyx_v_theta_m)));
</pre><pre class="cython line score-0">&#xA0;<span class="">562</span>:                   -Green_circle_orb(geo.t1_arc1,geo.ra_arc1,geo.xa_arc1,geo.ya_arc1, geo.ro, theta_m)</pre>
<pre class="cython line score-0">&#xA0;<span class="">563</span>:                  )</pre>
<pre class="cython line score-0">&#xA0;<span class="">564</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">565</span>:     # Line from orbiting scroll to fixed scroll</pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">566</span>:     x1_orbfix, y1_orbfix = coords_inv(geo.phi_fos+pi, geo, theta, 'oi')</pre>
<pre class='cython code score-21 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.phi_fos + M_PI));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3.__pyx_n = 1;
  __pyx_t_3.flag = __pyx_n_s_oi;
  __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_1, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(__pyx_t_2 != Py_None)) {
    PyObject* sequence = __pyx_t_2;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>
  }
  __pyx_v_x1_orbfix = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_v_y1_orbfix = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">567</span>:     x2_orbfix, y2_orbfix = coords_inv(geo.phi_fos, geo, theta, 'fo')</pre>
<pre class='cython code score-21 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_fos);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3.__pyx_n = 1;
  __pyx_t_3.flag = __pyx_n_s_fo;
  __pyx_t_4 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_2, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(__pyx_t_4 != Py_None)) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 567, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 567, __pyx_L1_error)</span>
  }
  __pyx_v_x2_orbfix = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_y2_orbfix = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">568</span>:     A_line_orbfix = 0.5*(x1_orbfix*y2_orbfix - x2_orbfix*y1_orbfix)</pre>
<pre class='cython code score-23 '>  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_x1_orbfix, __pyx_v_y2_orbfix);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_x2_orbfix, __pyx_v_y1_orbfix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_A_line_orbfix = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">569</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">570</span>:     Ainv_oi = 0.5*(Gr(geo.phi_fos + pi, geo, theta, common.INVOLUTE_OI)</pre>
<pre class='cython code score-0 '>  __pyx_v_Ainv_oi = (0.5 * (__pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr((__pyx_v_geo-&gt;__pyx_base.phi_fos + M_PI), ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr(__pyx_v_geo-&gt;__pyx_base.phi_ois, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI, 0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">571</span>:                   -Gr(geo.phi_ois, geo, theta, common.INVOLUTE_OI))</pre>
<pre class="cython line score-0">&#xA0;<span class="">572</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">573</span>:     V = geo.h*(Ainv_fi + A_farc2 + A_line1 + A_farc3 + A_farc1 + A_line_fixorb</pre>
<pre class='cython code score-23 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.h);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_Ainv_fi + __pyx_v_A_farc2) + __pyx_v_A_line1) + __pyx_v_A_farc3) + __pyx_v_A_farc1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_v_A_line_fixorb);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_V = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">574</span>:              + A_oarc2 + A_line3 + A_oarc3 + A_oarc1 + A_line_orbfix + Ainv_oi)</pre>
<pre class='cython code score-66 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_A_oarc2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_A_line3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_A_oarc3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_A_oarc1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_v_A_line_orbfix);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_Ainv_oi);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">575</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">576</span>:     ## ------------------------ DERIVATIVE -------------------------------</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">577</span>:     dAinv_fi_dtheta = 0.5*(dGr_dtheta(geo.phi_oos+pi, geo, theta, common.INVOLUTE_FI)</pre>
<pre class='cython code score-0 '>  __pyx_v_dAinv_fi_dtheta = (0.5 * (__pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dtheta((__pyx_v_geo-&gt;__pyx_base.phi_oos + M_PI), ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dtheta(__pyx_v_geo-&gt;__pyx_base.phi_fis, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI, 0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">578</span>:                           -dGr_dtheta(geo.phi_fis, geo, theta, common.INVOLUTE_FI)</pre>
<pre class="cython line score-0">&#xA0;<span class="">579</span>:                        )</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">580</span>:     dA_farc2_dtheta = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_farc2_dtheta = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">581</span>:     dA_line1_dtheta = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_line1_dtheta = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">582</span>:     dA_farc1_dtheta = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_farc1_dtheta = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">583</span>:     dA_farc3_dtheta = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_farc3_dtheta = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">584</span>:     dx1_fixorb_dtheta, dy1_fixorb_dtheta, dx2_orbfix_dtheta, dy2_orbfix_dtheta = 0.0, 0.0, 0.0, 0.0</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = 0.0;
  __pyx_t_7 = 0.0;
  __pyx_t_8 = 0.0;
  __pyx_t_9 = 0.0;
  __pyx_v_dx1_fixorb_dtheta = __pyx_t_6;
  __pyx_v_dy1_fixorb_dtheta = __pyx_t_7;
  __pyx_v_dx2_orbfix_dtheta = __pyx_t_8;
  __pyx_v_dy2_orbfix_dtheta = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">585</span>:     dx2_fixorb_dtheta = dx_5_dtheta = dx_6_dtheta = dx1_orbfix_dtheta = -geo.ro*sin(theta_m)*(-1)</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = (((-__pyx_v_geo-&gt;__pyx_base.ro) * sin(__pyx_v_theta_m)) * -1.0);
  __pyx_v_dx2_fixorb_dtheta = __pyx_t_9;
  __pyx_v_dx_5_dtheta = __pyx_t_9;
  __pyx_v_dx_6_dtheta = __pyx_t_9;
  __pyx_v_dx1_orbfix_dtheta = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">586</span>:     dy2_fixorb_dtheta = dy_5_dtheta = dy_6_dtheta = dy1_orbfix_dtheta = geo.ro*cos(theta_m)*(-1)</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = ((__pyx_v_geo-&gt;__pyx_base.ro * cos(__pyx_v_theta_m)) * -1.0);
  __pyx_v_dy2_fixorb_dtheta = __pyx_t_9;
  __pyx_v_dy_5_dtheta = __pyx_t_9;
  __pyx_v_dy_6_dtheta = __pyx_t_9;
  __pyx_v_dy1_orbfix_dtheta = __pyx_t_9;
</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">587</span>:     dA_line_fixorb_dtheta = 0.5*(x1_fixorb*dy2_fixorb_dtheta + y2_fixorb*dx1_fixorb_dtheta - x2_fixorb*dy1_fixorb_dtheta - y1_fixorb*dx2_fixorb_dtheta)</pre>
<pre class='cython code score-71 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dy2_fixorb_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_x1_fixorb, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dx1_fixorb_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_y2_fixorb, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dy1_fixorb_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_x2_fixorb, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dx2_fixorb_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_y1_fixorb, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_dA_line_fixorb_dtheta = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">588</span>:     dA_oarc2_dtheta = 0.5*(dGreen_circle_orb_dtheta(geo.t1_arc2,geo.ra_arc2,geo.xa_arc2,geo.ya_arc2, geo.ro, theta_m)</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_oarc2_dtheta = (0.5 * (__pyx_f_12DanfossPDSim_16asymm_scroll_geo_dGreen_circle_orb_dtheta(__pyx_v_geo-&gt;__pyx_base.t1_arc2, __pyx_v_geo-&gt;__pyx_base.ra_arc2, __pyx_v_geo-&gt;__pyx_base.xa_arc2, __pyx_v_geo-&gt;__pyx_base.ya_arc2, __pyx_v_geo-&gt;__pyx_base.ro, __pyx_v_theta_m) - __pyx_f_12DanfossPDSim_16asymm_scroll_geo_dGreen_circle_orb_dtheta(__pyx_v_geo-&gt;__pyx_base.t2_arc2, __pyx_v_geo-&gt;__pyx_base.ra_arc2, __pyx_v_geo-&gt;__pyx_base.xa_arc2, __pyx_v_geo-&gt;__pyx_base.ya_arc2, __pyx_v_geo-&gt;__pyx_base.ro, __pyx_v_theta_m)));
</pre><pre class="cython line score-0">&#xA0;<span class="">589</span>:                           -dGreen_circle_orb_dtheta(geo.t2_arc2,geo.ra_arc2,geo.xa_arc2,geo.ya_arc2, geo.ro, theta_m)</pre>
<pre class="cython line score-0">&#xA0;<span class="">590</span>:                            )</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">591</span>:     dA_line3_dtheta = 0.5*(x_5*dy_6_dtheta + y_6*dx_5_dtheta - x_6*dy_5_dtheta - y_5*dx_6_dtheta)</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_line3_dtheta = (0.5 * ((((__pyx_v_x_5 * __pyx_v_dy_6_dtheta) + (__pyx_v_y_6 * __pyx_v_dx_5_dtheta)) - (__pyx_v_x_6 * __pyx_v_dy_5_dtheta)) - (__pyx_v_y_5 * __pyx_v_dx_6_dtheta)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">592</span>:     dA_oarc3_dtheta = 0.5*(dGreen_circle_orb_dtheta(geo.t2_arc3,geo.ra_arc3,geo.xa_arc3,geo.ya_arc3, geo.ro, theta_m)</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_oarc3_dtheta = (0.5 * (__pyx_f_12DanfossPDSim_16asymm_scroll_geo_dGreen_circle_orb_dtheta(__pyx_v_geo-&gt;t2_arc3, __pyx_v_geo-&gt;ra_arc3, __pyx_v_geo-&gt;xa_arc3, __pyx_v_geo-&gt;ya_arc3, __pyx_v_geo-&gt;__pyx_base.ro, __pyx_v_theta_m) - __pyx_f_12DanfossPDSim_16asymm_scroll_geo_dGreen_circle_orb_dtheta(__pyx_v_geo-&gt;t1_arc3, __pyx_v_geo-&gt;ra_arc3, __pyx_v_geo-&gt;xa_arc3, __pyx_v_geo-&gt;ya_arc3, __pyx_v_geo-&gt;__pyx_base.ro, __pyx_v_theta_m)));
</pre><pre class="cython line score-0">&#xA0;<span class="">593</span>:                           -dGreen_circle_orb_dtheta(geo.t1_arc3,geo.ra_arc3,geo.xa_arc3,geo.ya_arc3, geo.ro, theta_m)</pre>
<pre class="cython line score-0">&#xA0;<span class="">594</span>:                            )</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">595</span>:     dA_oarc1_dtheta = 0.5*(dGreen_circle_orb_dtheta(geo.t2_arc1,geo.ra_arc1,geo.xa_arc1,geo.ya_arc1, geo.ro, theta_m)</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_oarc1_dtheta = (0.5 * (__pyx_f_12DanfossPDSim_16asymm_scroll_geo_dGreen_circle_orb_dtheta(__pyx_v_geo-&gt;__pyx_base.t2_arc1, __pyx_v_geo-&gt;__pyx_base.ra_arc1, __pyx_v_geo-&gt;__pyx_base.xa_arc1, __pyx_v_geo-&gt;__pyx_base.ya_arc1, __pyx_v_geo-&gt;__pyx_base.ro, __pyx_v_theta_m) - __pyx_f_12DanfossPDSim_16asymm_scroll_geo_dGreen_circle_orb_dtheta(__pyx_v_geo-&gt;__pyx_base.t1_arc1, __pyx_v_geo-&gt;__pyx_base.ra_arc1, __pyx_v_geo-&gt;__pyx_base.xa_arc1, __pyx_v_geo-&gt;__pyx_base.ya_arc1, __pyx_v_geo-&gt;__pyx_base.ro, __pyx_v_theta_m)));
</pre><pre class="cython line score-0">&#xA0;<span class="">596</span>:                           -dGreen_circle_orb_dtheta(geo.t1_arc1,geo.ra_arc1,geo.xa_arc1,geo.ya_arc1, geo.ro, theta_m)</pre>
<pre class="cython line score-0">&#xA0;<span class="">597</span>:                            )</pre>
<pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">598</span>:     dA_line_orbfix_dtheta = 0.5*(x1_orbfix*dy2_orbfix_dtheta + y2_orbfix*dx1_orbfix_dtheta - x2_orbfix*dy1_orbfix_dtheta - y1_orbfix*dx2_orbfix_dtheta)</pre>
<pre class='cython code score-71 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dy2_orbfix_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_x1_orbfix, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dx1_orbfix_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_y2_orbfix, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dy1_orbfix_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_x2_orbfix, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dx2_orbfix_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_y1_orbfix, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_dA_line_orbfix_dtheta = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">599</span>:     dAinv_oi_dtheta = 0.5*(dGr_dtheta(geo.phi_fos+pi, geo, theta, common.INVOLUTE_OI)</pre>
<pre class='cython code score-0 '>  __pyx_v_dAinv_oi_dtheta = (0.5 * (__pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dtheta((__pyx_v_geo-&gt;__pyx_base.phi_fos + M_PI), ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dtheta(__pyx_v_geo-&gt;__pyx_base.phi_ois, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI, 0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">600</span>:                           -dGr_dtheta(geo.phi_ois, geo, theta, common.INVOLUTE_OI)</pre>
<pre class="cython line score-0">&#xA0;<span class="">601</span>:                        )</pre>
<pre class="cython line score-0">&#xA0;<span class="">602</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">603</span>:     dV = geo.h*(dAinv_fi_dtheta + dA_farc2_dtheta + dA_line1_dtheta + dA_farc3_dtheta + dA_farc1_dtheta + dA_line_fixorb_dtheta</pre>
<pre class='cython code score-23 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.h);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 603, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_dAinv_fi_dtheta + __pyx_v_dA_farc2_dtheta) + __pyx_v_dA_line1_dtheta) + __pyx_v_dA_farc3_dtheta) + __pyx_v_dA_farc1_dtheta));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 603, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_v_dA_line_fixorb_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 603, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 603, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dV = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">604</span>:               + dA_oarc2_dtheta + dA_line3_dtheta + dA_oarc1_dtheta + dA_oarc3_dtheta + dA_line_orbfix_dtheta + dAinv_oi_dtheta)</pre>
<pre class='cython code score-66 '>  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dA_oarc2_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dA_line3_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dA_oarc1_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dA_oarc3_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_dA_line_orbfix_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dAinv_oi_dtheta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">605</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">606</span>:     cdef VdVstruct VdV = VdVstruct.__new__(VdVstruct)</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = __Pyx_tp_new(((PyObject *)__pyx_ptype_5PDSim_6scroll_17common_scroll_geo_VdVstruct), __pyx_empty_tuple);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 606, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_VdVstruct)))) <span class='error_goto'>__PYX_ERR(0, 606, __pyx_L1_error)</span>
  __pyx_v_VdV = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">607</span>:     VdV.V = V</pre>
<pre class='cython code score-10 '>  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_V); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 607, __pyx_L1_error)</span>
  __pyx_v_VdV-&gt;V = __pyx_t_9;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">608</span>:     VdV.dV = dV</pre>
<pre class='cython code score-10 '>  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_dV); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 608, __pyx_L1_error)</span>
  __pyx_v_VdV-&gt;dV = __pyx_t_9;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">609</span>:     return VdV</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_VdV));
  __pyx_r = __pyx_v_VdV;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">610</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">611</span>: cpdef dict DD_forces(double theta, DanfossGeoVals geo):</pre>
<pre class='cython code score-43 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_27DD_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_DD_forces(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DD_forces", 0);
  <span class='trace'>__Pyx_TraceCall</span>("DD_forces", __pyx_f[0], 611, 0, <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DD_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_27DD_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_26DD_forces[] = "DD_forces(double theta, DanfossGeoVals geo) -&gt; dict\n\n    Call the symmetric one, since for internal symmetry, the DD chamber is the same\n    TODO: update when we have internal asymmetry\n    ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_27DD_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DD_forces (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DD_forces", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "DD_forces") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DD_forces", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DD_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_26DD_forces(__pyx_self, __pyx_v_theta, __pyx_v_geo);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_26DD_forces(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DD_forces", 0);
  <span class='trace'>__Pyx_TraceCall</span>("DD_forces (wrapper)", __pyx_f[0], 611, 0, <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_DD_forces(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 611, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DD_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">612</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">613</span>:     Call the symmetric one, since for internal symmetry, the DD chamber is the same</pre>
<pre class="cython line score-0">&#xA0;<span class="">614</span>:     TODO: update when we have internal asymmetry</pre>
<pre class="cython line score-0">&#xA0;<span class="">615</span>:     """</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">616</span>:     return symm_scroll_geo.DD_forces(theta, geo)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_15symm_scroll_geo_DD_forces(__pyx_v_theta, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), 0, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">617</span>: </pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">618</span>: cpdef VdVstruct DDD(double theta, DanfossGeoVals geo):</pre>
<pre class='cython code score-48 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_29DDD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_DDD(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, CYTHON_UNUSED int __pyx_skip_dispatch) {
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_v_Vd1 = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_v_Vd2 = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_v_Vdd = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_v_VdV = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DDD", 0);
  <span class='trace'>__Pyx_TraceCall</span>("DDD", __pyx_f[0], 618, 0, <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DDD", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Vd1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Vd2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Vdd);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_VdV);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_29DDD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_28DDD[] = "DDD(double theta, DanfossGeoVals geo) -&gt; VdVstruct";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_29DDD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DDD (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DDD", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "DDD") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DDD", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DDD", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_28DDD(__pyx_self, __pyx_v_theta, __pyx_v_geo);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_28DDD(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DDD", 0);
  <span class='trace'>__Pyx_TraceCall</span>("DDD (wrapper)", __pyx_f[0], 618, 0, <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_DDD(__pyx_v_theta, __pyx_v_geo, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DDD", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">619</span>:     cdef VdVstruct Vd1 = common.VdV(theta, geo, CVangles(theta, geo, common.keyId1))</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyId1, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = ((PyObject *)__pyx_f_5PDSim_6scroll_17common_scroll_geo_VdV(__pyx_v_theta, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1), 0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Vd1 = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">620</span>:     cdef VdVstruct Vd2 = common.VdV(theta, geo, CVangles(theta, geo, common.keyId2))</pre>
<pre class='cython code score-1 '>  __pyx_t_2 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyId2, 0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 620, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = ((PyObject *)__pyx_f_5PDSim_6scroll_17common_scroll_geo_VdV(__pyx_v_theta, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_2), 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 620, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_Vd2 = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">621</span>:     cdef VdVstruct Vdd = DD(theta, geo)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_DD(__pyx_v_theta, __pyx_v_geo, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_Vdd = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">622</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">623</span>:     cdef VdVstruct VdV = VdVstruct.__new__(VdVstruct)</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = __Pyx_tp_new(((PyObject *)__pyx_ptype_5PDSim_6scroll_17common_scroll_geo_VdVstruct), __pyx_empty_tuple);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_VdVstruct)))) <span class='error_goto'>__PYX_ERR(0, 623, __pyx_L1_error)</span>
  __pyx_v_VdV = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">624</span>:     VdV.V = Vd1.V + Vd2.V + Vdd.V</pre>
<pre class='cython code score-0 '>  __pyx_v_VdV-&gt;V = ((__pyx_v_Vd1-&gt;V + __pyx_v_Vd2-&gt;V) + __pyx_v_Vdd-&gt;V);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">625</span>:     VdV.dV = Vd1.dV + Vd2.dV + Vdd.dV</pre>
<pre class='cython code score-0 '>  __pyx_v_VdV-&gt;dV = ((__pyx_v_Vd1-&gt;dV + __pyx_v_Vd2-&gt;dV) + __pyx_v_Vdd-&gt;dV);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">626</span>:     return VdV</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_VdV));
  __pyx_r = __pyx_v_VdV;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">627</span>: </pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">628</span>: cpdef dict DDD_forces(double theta, DanfossGeoVals geo):</pre>
<pre class='cython code score-53 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_31DDD_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_DDD_forces(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_theta_m;
  PyObject *__pyx_v_exact_dict = NULL;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_anglesd1 = NULL;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_anglesd2 = NULL;
  double __pyx_v_Ad1;
  double __pyx_v_Ad2;
  PyObject *__pyx_v__D1_forces = NULL;
  PyObject *__pyx_v__D2_forces = NULL;
  PyObject *__pyx_v__DD_forces = NULL;
  PyObject *__pyx_v_key = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DDD_forces", 0);
  <span class='trace'>__Pyx_TraceCall</span>("DDD_forces", __pyx_f[0], 628, 0, <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DDD_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_exact_dict);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_anglesd1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_anglesd2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__D1_forces);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__D2_forces);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__DD_forces);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_31DDD_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_30DDD_forces[] = "DDD_forces(double theta, DanfossGeoVals geo) -&gt; dict";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_31DDD_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DDD_forces (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DDD_forces", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "DDD_forces") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DDD_forces", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DDD_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_30DDD_forces(__pyx_self, __pyx_v_theta, __pyx_v_geo);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_30DDD_forces(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DDD_forces", 0);
  <span class='trace'>__Pyx_TraceCall</span>("DDD_forces (wrapper)", __pyx_f[0], 628, 0, <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_DDD_forces(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.DDD_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">629</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">630</span>:     theta_m = geo.phi_fie - theta - pi/2</pre>
<pre class='cython code score-0 '>  __pyx_v_theta_m = ((__pyx_v_geo-&gt;__pyx_base.phi_fie - __pyx_v_theta) - (M_PI / 2.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">631</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">632</span>:     exact_dict = {}</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_exact_dict = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">633</span>:     anglesd1 = CVangles(theta, geo, common.keyId1)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyId1, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_anglesd1 = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">634</span>:     anglesd2 = CVangles(theta, geo, common.keyId2)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyId2, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 634, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_anglesd2 = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">635</span>:     Ad1 = common.VdV(theta, geo, anglesd1).V/geo.h</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = ((PyObject *)__pyx_f_5PDSim_6scroll_17common_scroll_geo_VdV(__pyx_v_theta, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_anglesd1, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_1)-&gt;V;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(__pyx_v_geo-&gt;__pyx_base.h == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
  }
  __pyx_v_Ad1 = (__pyx_t_2 / __pyx_v_geo-&gt;__pyx_base.h);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">636</span>:     Ad2 = common.VdV(theta, geo, anglesd2).V/geo.h</pre>
<pre class='cython code score-6 '>  __pyx_t_1 = ((PyObject *)__pyx_f_5PDSim_6scroll_17common_scroll_geo_VdV(__pyx_v_theta, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_anglesd2, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_1)-&gt;V;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(__pyx_v_geo-&gt;__pyx_base.h == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
  }
  __pyx_v_Ad2 = (__pyx_t_2 / __pyx_v_geo-&gt;__pyx_base.h);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">637</span>:     _D1_forces = common.forces(theta,geo,anglesd1,Ad1)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_forces(__pyx_v_theta, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_anglesd1, __pyx_v_Ad1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v__D1_forces = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">638</span>:     _D2_forces = common.forces(theta,geo,anglesd2,Ad2)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_forces(__pyx_v_theta, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_anglesd2, __pyx_v_Ad2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v__D2_forces = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">639</span>:     _DD_forces = DD_forces(theta,geo)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_DD_forces(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v__DD_forces = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">640</span>:     for key in _D1_forces:</pre>
<pre class='cython code score-7 '>  __pyx_t_3 = 0;
  if (unlikely(__pyx_v__D1_forces == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>__PYX_ERR(0, 640, __pyx_L1_error)</span>
  }
  __pyx_t_6 = __Pyx_dict_iterator(__pyx_v__D1_forces, 1, ((PyObject *)NULL), (&amp;__pyx_t_4), (&amp;__pyx_t_5));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __pyx_t_1 = __pyx_t_6;
  __pyx_t_6 = 0;
  while (1) {
    __pyx_t_7 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_4, &amp;__pyx_t_3, &amp;__pyx_t_6, NULL, NULL, __pyx_t_5);
    if (unlikely(__pyx_t_7 == 0)) break;
    if (unlikely(__pyx_t_7 == -1)) <span class='error_goto'>__PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_key, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">641</span>:         exact_dict[key] = _D1_forces[key]+_D2_forces[key]+_DD_forces[key]</pre>
<pre class='cython code score-42 '>    if (unlikely(__pyx_v__D1_forces == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
    }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v__D1_forces, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (unlikely(__pyx_v__D2_forces == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v__D2_forces, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(__pyx_v__DD_forces == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v__DD_forces, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_exact_dict, __pyx_v_key, __pyx_t_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">642</span>:     exact_dict['cx'] = geo.ro*cos(theta_m)/2.0</pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_geo-&gt;__pyx_base.ro * cos(__pyx_v_theta_m)) / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 642, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_exact_dict, __pyx_n_s_cx, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 642, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">643</span>:     exact_dict['cy'] = geo.ro*sin(theta_m)/2.0</pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_geo-&gt;__pyx_base.ro * sin(__pyx_v_theta_m)) / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_exact_dict, __pyx_n_s_cy, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 643, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">644</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">645</span>:     return exact_dict</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_exact_dict);
  __pyx_r = __pyx_v_exact_dict;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">646</span>: </pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">647</span>: cpdef VdVstruct VdV(int index, double theta, DanfossGeoVals geo):</pre>
<pre class='cython code score-57 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_33VdV(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_VdV(int __pyx_v_index, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_theta_02PI;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_angles = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("VdV", 0);
  <span class='trace'>__Pyx_TraceCall</span>("VdV", __pyx_f[0], 647, 0, <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.VdV", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_angles);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_33VdV(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_32VdV[] = "VdV(int index, double theta, DanfossGeoVals geo) -&gt; VdVstruct";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_33VdV(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_index;
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("VdV (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_index,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_index)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("VdV", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("VdV", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "VdV") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_index = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_index == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L3_error)</span>
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("VdV", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.VdV", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_32VdV(__pyx_self, __pyx_v_index, __pyx_v_theta, __pyx_v_geo);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_32VdV(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_index, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("VdV", 0);
  <span class='trace'>__Pyx_TraceCall</span>("VdV (wrapper)", __pyx_f[0], 647, 0, <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_VdV(__pyx_v_index, __pyx_v_theta, __pyx_v_geo, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.VdV", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">648</span>:     # Map the angle into [0, 2*pi], so long as it is not less than -20*pi</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">649</span>:     cdef double theta_02PI = (theta + 20*pi) % (2*pi)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = (__pyx_v_theta + (20.0 * M_PI));
  __pyx_t_2 = (2.0 * M_PI);
  if (unlikely(__pyx_t_2 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float divmod()");
    <span class='error_goto'>__PYX_ERR(0, 649, __pyx_L1_error)</span>
  }
  __pyx_v_theta_02PI = __Pyx_mod_double(__pyx_t_1, __pyx_t_2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">650</span>:     cdef CVInvolutes angles = CVangles(theta_02PI, geo, index)</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta_02PI, __pyx_v_geo, __pyx_v_index, 0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_angles = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">651</span>:     return common.VdV(theta_02PI, geo, angles)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = ((PyObject *)__pyx_f_5PDSim_6scroll_17common_scroll_geo_VdV(__pyx_v_theta_02PI, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_angles, 0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_r = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_3);
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">652</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">653</span>: cdef int D_as_C_index(int index, double theta, DanfossGeoVals geo):</pre>
<pre class='cython code score-5 '>static int __pyx_f_12DanfossPDSim_16asymm_scroll_geo_D_as_C_index(int __pyx_v_index, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo) {
  int __pyx_v_before_discharge;
  double __pyx_v_angle1;
  double __pyx_v_angle2;
  double __pyx_v_anglediff;
  long __pyx_v_path;
  double __pyx_v_t2;
  int __pyx_v_alpha;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("D_as_C_index", 0);
  <span class='trace'>__Pyx_TraceCall</span>("D_as_C_index", __pyx_f[0], 653, 0, <span class='error_goto'>__PYX_ERR(0, 653, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("DanfossPDSim.asymm_scroll_geo.D_as_C_index", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">654</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">655</span>:     This function determines whether the conditions are such that</pre>
<pre class="cython line score-0">&#xA0;<span class="">656</span>:     the d1 chamber should be treated like the c1.max and/or the d2</pre>
<pre class="cython line score-0">&#xA0;<span class="">657</span>:     chamber should be treated as c2.max</pre>
<pre class="cython line score-0">&#xA0;<span class="">658</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">659</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">660</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">661</span>:     iCV : int</pre>
<pre class="cython line score-0">&#xA0;<span class="">662</span>:         Index of the chamber that is to be used for the evaluation</pre>
<pre class="cython line score-0">&#xA0;<span class="">663</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">664</span>:     cdef int before_discharge</pre>
<pre class="cython line score-0">&#xA0;<span class="">665</span>:     cdef double angle1, angle2, anglediff</pre>
<pre class="cython line score-0">&#xA0;<span class="">666</span>:     # If the cross-product of vectors from the origin to points</pre>
<pre class="cython line score-0">&#xA0;<span class="">667</span>:     # on the unit circle (cos(t1), sin(t1)) and (cos(t2), sin(t2))</pre>
<pre class="cython line score-0">&#xA0;<span class="">668</span>:     # are negative, then then the angles are sorted in a clockwise sense</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">669</span>:     path = 1 if index == keyId1 else 2</pre>
<pre class='cython code score-14 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_index);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_keyId1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 669, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
    __pyx_t_1 = 1;
  } else {
    __pyx_t_1 = 2;
  }
  __pyx_v_path = __pyx_t_1;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">670</span>:     t2 = theta_d(geo, path)</pre>
<pre class='cython code score-5 '>  __pyx_t_6 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_theta_d(__pyx_v_geo, __pyx_v_path, 0); if (unlikely(__pyx_t_6 == ((double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span>
  __pyx_v_t2 = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">671</span>:     before_discharge = (cos(theta)*sin(t2)-sin(theta)*cos(t2)&gt;0)</pre>
<pre class='cython code score-0 '>  __pyx_v_before_discharge = (((cos(__pyx_v_theta) * sin(__pyx_v_t2)) - (sin(__pyx_v_theta) * cos(__pyx_v_t2))) &gt; 0.0);
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">672</span>:     angle1, angle2 = sortAnglesCCW(theta, t2)</pre>
<pre class='cython code score-37 '>  __pyx_t_4 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_sortAnglesCCW(__pyx_v_theta, __pyx_v_t2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (likely(__pyx_t_4 != Py_None)) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 672, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
    __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 672, __pyx_L1_error)</span>
  }
  __pyx_t_6 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_6 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 672, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_7 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 672, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_angle1 = __pyx_t_6;
  __pyx_v_angle2 = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">673</span>:     anglediff = angle2-angle1</pre>
<pre class='cython code score-0 '>  __pyx_v_anglediff = (__pyx_v_angle2 - __pyx_v_angle1);
</pre><pre class="cython line score-0">&#xA0;<span class="">674</span>:     # Check that you are both to the "left" of the discharge angle in a rotaional</pre>
<pre class="cython line score-0">&#xA0;<span class="">675</span>:     # sense and just to the left of it</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">676</span>:     if before_discharge and anglediff &lt; 1e-8:</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = (__pyx_v_before_discharge != 0);
  if (__pyx_t_8) {
  } else {
    __pyx_t_5 = __pyx_t_8;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_8 = ((__pyx_v_anglediff &lt; 1e-8) != 0);
  __pyx_t_5 = __pyx_t_8;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">677</span>:         alpha = getNc(theta, geo, path)</pre>
<pre class='cython code score-0 '>    __pyx_v_alpha = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_getNc(__pyx_v_theta, __pyx_v_geo, __pyx_v_path, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">678</span>:         return get_compression_chamber_index(path, alpha)</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_f_5PDSim_6scroll_17common_scroll_geo_get_compression_chamber_index(__pyx_v_path, __pyx_v_alpha, 0);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">679</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">680</span>:         return index</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = __pyx_v_index;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">681</span>: </pre>
<pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">682</span>: cpdef dict forces(int index, double theta, DanfossGeoVals geo, CVInvolutes angles = None):</pre>
<pre class='cython code score-66 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_35forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_forces(int __pyx_v_index, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_12DanfossPDSim_16asymm_scroll_geo_forces *__pyx_optional_args) {
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_angles = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)Py_None);
  double __pyx_v_V;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("forces", 0);
  <span class='trace'>__Pyx_TraceCall</span>("forces", __pyx_f[0], 682, 0, <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_angles = __pyx_optional_args-&gt;angles;
    }
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_angles);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_angles);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_35forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_34forces[] = "forces(int index, double theta, DanfossGeoVals geo, CVInvolutes angles=None) -&gt; dict\n\n    Calculate the force terms from the geometry\n    ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_35forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_index;
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_angles = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("forces (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_index,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_angles,0};
    PyObject* values[4] = {0,0,0,0};
    values[3] = (PyObject *)((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_index)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("forces", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("forces", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_angles);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "forces") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_index = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_index == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L3_error)</span>
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[2]);
    __pyx_v_angles = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("forces", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_angles), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_CVInvolutes, 1, "angles", 0))) <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_34forces(__pyx_self, __pyx_v_index, __pyx_v_theta, __pyx_v_geo, __pyx_v_angles);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_34forces(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_index, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_angles) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("forces", 0);
  <span class='trace'>__Pyx_TraceCall</span>("forces (wrapper)", __pyx_f[0], 682, 0, <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.angles = __pyx_v_angles;
  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_forces(__pyx_v_index, __pyx_v_theta, __pyx_v_geo, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">683</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">684</span>:     Calculate the force terms from the geometry</pre>
<pre class="cython line score-0">&#xA0;<span class="">685</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">686</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">687</span>:     # Specialized treatments for SA, DD, DDD</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">688</span>:     if index == common.keyIsa:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_index) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIsa:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIdd:
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">689</span>:         return SA_forces(theta, geo)</pre>
<pre class='cython code score-1 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_SA_forces(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 689, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_r = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">690</span>:     elif index == common.keyIdd:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIddd:
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">691</span>:         return DD_forces(theta, geo)</pre>
<pre class='cython code score-1 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_DD_forces(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 691, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_r = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">692</span>:     elif index == common.keyIddd:</pre>
<pre class='cython code score-0 '>    break;
    default:
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">693</span>:         return DDD_forces(theta, geo)</pre>
<pre class='cython code score-1 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_DDD_forces(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 693, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_r = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">694</span>:     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">695</span>:         # Generalized treatment for other chambers</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">696</span>:         if angles is None:</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (((PyObject *)__pyx_v_angles) == Py_None);
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">697</span>:             angles = CVangles(theta, geo, index)</pre>
<pre class='cython code score-1 '>      __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_v_index, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 697, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_angles, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">698</span>:         V = common.VdV(theta, geo, angles).V</pre>
<pre class='cython code score-1 '>    __pyx_t_1 = ((PyObject *)__pyx_f_5PDSim_6scroll_17common_scroll_geo_VdV(__pyx_v_theta, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_angles, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_1)-&gt;V;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_V = __pyx_t_4;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">699</span>:         if V == 0.0 and (index == keyIs1 or index == keyIs2):</pre>
<pre class='cython code score-28 '>    __pyx_t_2 = ((__pyx_v_V == 0.0) != 0);
    if (__pyx_t_2) {
    } else {
      __pyx_t_3 = __pyx_t_2;
      goto __pyx_L5_bool_binop_done;
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_keyIs1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_5, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 699, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (!__pyx_t_2) {
    } else {
      __pyx_t_3 = __pyx_t_2;
      goto __pyx_L5_bool_binop_done;
    }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_index);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_keyIs2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_t_5, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 699, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_t_2;
    __pyx_L5_bool_binop_done:;
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">700</span>:             V += 1e-8</pre>
<pre class='cython code score-0 '>      __pyx_v_V = (__pyx_v_V + 1e-8);
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">701</span>:         if index == keyId1 or index == keyId2:</pre>
<pre class='cython code score-28 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_keyId1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_5, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 701, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (!__pyx_t_2) {
    } else {
      __pyx_t_3 = __pyx_t_2;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_index);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_keyId2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_t_5, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 701, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_t_2;
    __pyx_L9_bool_binop_done:;
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">702</span>:             # Special case when just before the discharge angle, at which point</pre>
<pre class="cython line score-0">&#xA0;<span class="">703</span>:             # the force function of the c1.alpha or c2.alpha should be used</pre>
<pre class="cython line score-0">&#xA0;<span class="">704</span>:             # instead of that of d1 or d2</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">705</span>:             angles = CVangles(theta, geo, D_as_C_index(index, theta, geo))</pre>
<pre class='cython code score-1 '>      __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_f_12DanfossPDSim_16asymm_scroll_geo_D_as_C_index(__pyx_v_index, __pyx_v_theta, __pyx_v_geo), 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 705, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_angles, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">706</span>:             V = common.VdV(theta, geo, angles).V</pre>
<pre class='cython code score-1 '>      __pyx_t_1 = ((PyObject *)__pyx_f_5PDSim_6scroll_17common_scroll_geo_VdV(__pyx_v_theta, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_angles, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 706, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_1)-&gt;V;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_V = __pyx_t_4;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">707</span>:             return common.forces(theta, geo, angles, V/geo.h)</pre>
<pre class='cython code score-6 '>      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      if (unlikely(__pyx_v_geo-&gt;__pyx_base.h == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 707, __pyx_L1_error)</span>
      }
      __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_forces(__pyx_v_theta, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_angles, (__pyx_v_V / __pyx_v_geo-&gt;__pyx_base.h), 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 707, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_r = ((PyObject*)__pyx_t_1);
      __pyx_t_1 = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">708</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">709</span>:         return common.forces(theta, geo, angles, V/geo.h)</pre>
<pre class='cython code score-6 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(__pyx_v_geo-&gt;__pyx_base.h == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span>
    }
    __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_forces(__pyx_v_theta, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_angles, (__pyx_v_V / __pyx_v_geo-&gt;__pyx_base.h), 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_r = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">710</span>: </pre>
<pre class="cython line score-109" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">711</span>: cpdef CVcoords(CVkey, DanfossGeoVals geo, double theta, int Ninv=1000):</pre>
<pre class='cython code score-109 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_37CVcoords(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVcoords(PyObject *__pyx_v_CVkey, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, double __pyx_v_theta, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_12DanfossPDSim_16asymm_scroll_geo_CVcoords *__pyx_optional_args) {
  int __pyx_v_Ninv = ((int)0x3E8);
  CYTHON_UNUSED int __pyx_v_Nc1;
  CYTHON_UNUSED int __pyx_v_Nc2;
  double __pyx_v_r;
  PyObject *__pyx_v_xee = NULL;
  PyObject *__pyx_v_yee = NULL;
  PyObject *__pyx_v_xse = NULL;
  PyObject *__pyx_v_yse = NULL;
  PyObject *__pyx_v_xoie = NULL;
  PyObject *__pyx_v_yoie = NULL;
  PyObject *__pyx_v_xooe = NULL;
  PyObject *__pyx_v_yooe = NULL;
  PyObject *__pyx_v_xwall = NULL;
  PyObject *__pyx_v_ywall = NULL;
  PyObject *__pyx_v_xoo = NULL;
  PyObject *__pyx_v_yoo = NULL;
  PyObject *__pyx_v_x0 = NULL;
  PyObject *__pyx_v_y0 = NULL;
  double __pyx_v_beta;
  PyObject *__pyx_v_t = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_y = NULL;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_CV = NULL;
  PyObject *__pyx_v_phi_outer = NULL;
  PyObject *__pyx_v_phi_inner = NULL;
  PyObject *__pyx_v_key_outer = NULL;
  PyObject *__pyx_v_key_inner = NULL;
  PyObject *__pyx_v_x1 = NULL;
  PyObject *__pyx_v_y1 = NULL;
  PyObject *__pyx_v_x2 = NULL;
  PyObject *__pyx_v_y2 = NULL;
  double __pyx_v_theta_m;
  PyObject *__pyx_v_x_farc1 = NULL;
  PyObject *__pyx_v_y_farc1 = NULL;
  PyObject *__pyx_v_x_oarc1 = NULL;
  PyObject *__pyx_v_y_oarc1 = NULL;
  PyObject *__pyx_v_x_farc2 = NULL;
  PyObject *__pyx_v_y_farc2 = NULL;
  PyObject *__pyx_v_x_oarc2 = NULL;
  PyObject *__pyx_v_y_oarc2 = NULL;
  PyObject *__pyx_v_x_farc3 = NULL;
  PyObject *__pyx_v_y_farc3 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_x_oarc3 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_y_oarc3 = NULL;
  PyObject *__pyx_v_phi = NULL;
  PyObject *__pyx_v_x_finv = NULL;
  PyObject *__pyx_v_y_finv = NULL;
  PyObject *__pyx_v_x_oinv = NULL;
  PyObject *__pyx_v_y_oinv = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("CVcoords", 0);
  <span class='trace'>__Pyx_TraceCall</span>("CVcoords", __pyx_f[0], 711, 0, <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_Ninv = __pyx_optional_args-&gt;Ninv;
    }
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.CVcoords", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xee);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yee);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xse);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yse);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xoie);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yoie);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xooe);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yooe);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xwall);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ywall);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xoo);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yoo);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_CV);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_phi_outer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_phi_inner);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_key_outer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_key_inner);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_farc1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_farc1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_oarc1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_oarc1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_farc2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_farc2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_oarc2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_oarc2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_farc3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_farc3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_oarc3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_oarc3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_phi);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_finv);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_finv);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_oinv);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_oinv);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_37CVcoords(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_36CVcoords[] = "CVcoords(CVkey, DanfossGeoVals geo, double theta, int Ninv=1000)\n \n    Return a tuple of numpy arrays for x,y coordinates for the curves which \n    determine the boundary of the control volume\n\n    Returns\n    -------\n    x : numpy array\n        X-coordinates of the outline of the control volume\n    y : numpy array\n        Y-coordinates of the outline of the control volume\n    ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_37CVcoords(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_CVkey = 0;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  int __pyx_v_Ninv;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("CVcoords (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_CVkey,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_Ninv,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_CVkey)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CVcoords", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CVcoords", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Ninv);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "CVcoords") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_CVkey = values[0];
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
    if (values[3]) {
      __pyx_v_Ninv = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_Ninv == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
    } else {
      __pyx_v_Ninv = ((int)0x3E8);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CVcoords", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.CVcoords", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_36CVcoords(__pyx_self, __pyx_v_CVkey, __pyx_v_geo, __pyx_v_theta, __pyx_v_Ninv);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_36CVcoords(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_CVkey, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, double __pyx_v_theta, int __pyx_v_Ninv) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("CVcoords", 0);
  <span class='trace'>__Pyx_TraceCall</span>("CVcoords (wrapper)", __pyx_f[0], 711, 0, <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.Ninv = __pyx_v_Ninv;
  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVcoords(__pyx_v_CVkey, __pyx_v_geo, __pyx_v_theta, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 711, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.CVcoords", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">712</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">713</span>:     Return a tuple of numpy arrays for x,y coordinates for the curves which</pre>
<pre class="cython line score-0">&#xA0;<span class="">714</span>:     determine the boundary of the control volume</pre>
<pre class="cython line score-0">&#xA0;<span class="">715</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">716</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">717</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">718</span>:     x : numpy array</pre>
<pre class="cython line score-0">&#xA0;<span class="">719</span>:         X-coordinates of the outline of the control volume</pre>
<pre class="cython line score-0">&#xA0;<span class="">720</span>:     y : numpy array</pre>
<pre class="cython line score-0">&#xA0;<span class="">721</span>:         Y-coordinates of the outline of the control volume</pre>
<pre class="cython line score-0">&#xA0;<span class="">722</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">723</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">724</span>:     cdef int Nc1 = Nc(theta, geo, 1), Nc2 = Nc(theta, geo, 2)</pre>
<pre class='cython code score-0 '>  __pyx_v_Nc1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Nc(__pyx_v_theta, __pyx_v_geo, 1, 0);
  __pyx_v_Nc2 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_Nc(__pyx_v_theta, __pyx_v_geo, 2, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">725</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">726</span>:     if CVkey == 'sa':</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_CVkey, __pyx_n_s_sa, Py_EQ)); if (unlikely(__pyx_t_1 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 726, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">727</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">728</span>:         r = (2*pi*geo.rb-geo.t)/2.0</pre>
<pre class='cython code score-0 '>    __pyx_v_r = ((((2.0 * M_PI) * __pyx_v_geo-&gt;__pyx_base.rb) - __pyx_v_geo-&gt;__pyx_base.t) / 2.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">729</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">730</span>:         xee, yee = coords_inv(geo.phi_oie + pi, geo, 0.0, 'fi')</pre>
<pre class='cython code score-21 '>    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.phi_oie + M_PI));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4.__pyx_n = 1;
    __pyx_t_4.flag = __pyx_n_s_fi;
    __pyx_t_3 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_2, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), 0.0, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (likely(__pyx_t_3 != Py_None)) {
      PyObject* sequence = __pyx_t_3;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>
    }
    __pyx_v_xee = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_yee = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">731</span>:         xse, yse = coords_inv(geo.phi_oie - pi, geo, 0.0, 'fo')</pre>
<pre class='cython code score-21 '>    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.phi_oie - M_PI));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4.__pyx_n = 1;
    __pyx_t_4.flag = __pyx_n_s_fo;
    __pyx_t_5 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_3, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), 0.0, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 731, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (likely(__pyx_t_5 != Py_None)) {
      PyObject* sequence = __pyx_t_5;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 731, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 731, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 731, __pyx_L1_error)</span>
    }
    __pyx_v_xse = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_yse = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">732</span>:         xoie, yoie = coords_inv(geo.phi_oie, geo, theta, 'oi')</pre>
<pre class='cython code score-21 '>    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_oie);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4.__pyx_n = 1;
    __pyx_t_4.flag = __pyx_n_s_oi;
    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_5, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (likely(__pyx_t_2 != Py_None)) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 732, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 732, __pyx_L1_error)</span>
    }
    __pyx_v_xoie = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_v_yoie = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">733</span>:         xooe, yooe = coords_inv(geo.phi_ooe, geo, theta, 'oo')</pre>
<pre class='cython code score-21 '>    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_ooe);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 733, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4.__pyx_n = 1;
    __pyx_t_4.flag = __pyx_n_s_oo;
    __pyx_t_3 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_2, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 733, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (likely(__pyx_t_3 != Py_None)) {
      PyObject* sequence = __pyx_t_3;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 733, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 733, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 733, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 733, __pyx_L1_error)</span>
    }
    __pyx_v_xooe = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_yooe = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">734</span>: </pre>
<pre class="cython line score-72" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">735</span>:         xwall, ywall = coords_inv(np.linspace(geo.phi_fie, geo.phi_oie + pi, 300), geo, 0.0, 'fi')</pre>
<pre class='cython code score-72 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_fie);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.phi_oie + M_PI));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_5, __pyx_t_6, __pyx_int_300};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_5, __pyx_t_6, __pyx_int_300};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    {
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      if (__pyx_t_7) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_8, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_8, __pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_300);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_300);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_8, __pyx_int_300);
      __pyx_t_5 = 0;
      __pyx_t_6 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4.__pyx_n = 1;
    __pyx_t_4.flag = __pyx_n_s_fi;
    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_3, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), 0.0, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (likely(__pyx_t_2 != Py_None)) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 735, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 735, __pyx_L1_error)</span>
    }
    __pyx_v_xwall = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_ywall = __pyx_t_9;
    __pyx_t_9 = 0;
</pre><pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">736</span>:         xoo, yoo = coords_inv(np.linspace(geo.phi_oie, phi_s1_sa(theta, geo)[0], 300), geo, theta, 'oo')</pre>
<pre class='cython code score-75 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_oie);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_6 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_phi_s1_sa(__pyx_v_theta, __pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (unlikely(__pyx_t_6 == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 736, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_9, __pyx_t_5, __pyx_int_300};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_9, __pyx_t_5, __pyx_int_300};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    {
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (__pyx_t_6) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6); __pyx_t_6 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_8, __pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_8, __pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_300);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_300);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2+__pyx_t_8, __pyx_int_300);
      __pyx_t_9 = 0;
      __pyx_t_5 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_4.__pyx_n = 1;
    __pyx_t_4.flag = __pyx_n_s_oo;
    __pyx_t_3 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_t_2, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (likely(__pyx_t_3 != Py_None)) {
      PyObject* sequence = __pyx_t_3;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 736, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 736, __pyx_L1_error)</span>
    }
    __pyx_v_xoo = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_yoo = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">737</span>:         x0,y0 = (xee+xse)/2,(yee+yse)/2</pre>
<pre class='cython code score-16 '>    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_xee, __pyx_v_xse);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_yee, __pyx_v_yse);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_x0 = __pyx_t_7;
    __pyx_t_7 = 0;
    __pyx_v_y0 = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">738</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">739</span>:         beta = atan2(yee-y0,xee-x0)</pre>
<pre class='cython code score-32 '>    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_yee, __pyx_v_y0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_10 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_10 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 739, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_xee, __pyx_v_x0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 739, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_beta = atan2(__pyx_t_10, __pyx_t_11);
</pre><pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">740</span>:         t = np.linspace(beta,beta+pi,1000)</pre>
<pre class='cython code score-56 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_beta);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_beta + M_PI));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_7, __pyx_t_5, __pyx_int_1000};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_7, __pyx_t_5, __pyx_int_1000};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (__pyx_t_9) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_9); __pyx_t_9 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_8, __pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_8, __pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1000);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1000);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_8, __pyx_int_1000);
      __pyx_t_7 = 0;
      __pyx_t_5 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_t = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">741</span>:         x,y = x0+r*np.cos(t),y0+r*np.sin(t)</pre>
<pre class='cython code score-74 '>    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_r);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_x0, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_r);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_6, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_y0, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_x = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_y = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">742</span>: </pre>
<pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">743</span>:         return np.r_[x,xoie,xooe,xoo,xwall,x[0]],np.r_[y,yoie,yooe,yoo,ywall,y[0]]</pre>
<pre class='cython code score-62 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_r_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_x);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xoie);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xoie);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_xoie);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xooe);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xooe);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_v_xooe);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xoo);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xoo);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3, __pyx_v_xoo);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xwall);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xwall);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 4, __pyx_v_xwall);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 5, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_3, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_r_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_y, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_y);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_yoie);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_yoie);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_yoie);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_yooe);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_yooe);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_v_yooe);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_yoo);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_yoo);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 3, __pyx_v_yoo);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ywall);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ywall);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 4, __pyx_v_ywall);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 5, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_7);
    __pyx_t_2 = 0;
    __pyx_t_7 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">744</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">745</span>:     elif (CVkey == 's1' or CVkey == 's2' or CVkey == 'd1' or CVkey == 'd2'</pre>
<pre class='cython code score-8 '>  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_CVkey, __pyx_n_s_s1, Py_EQ)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span>
  if (!__pyx_t_12) {
  } else {
    __pyx_t_1 = __pyx_t_12;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_CVkey, __pyx_n_s_s2, Py_EQ)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span>
  if (!__pyx_t_12) {
  } else {
    __pyx_t_1 = __pyx_t_12;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_CVkey, __pyx_n_s_d1, Py_EQ)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span>
  if (!__pyx_t_12) {
  } else {
    __pyx_t_1 = __pyx_t_12;
    goto __pyx_L4_bool_binop_done;
  }
/* … */
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_CVkey, __pyx_n_s_d2, Py_EQ)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span>
  if (!__pyx_t_12) {
  } else {
    __pyx_t_1 = __pyx_t_12;
    goto __pyx_L4_bool_binop_done;
  }
/* … */
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">746</span>:           or CVkey.startswith('c1.') or CVkey.startswith('c2.')):</pre>
<pre class='cython code score-38 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_CVkey, __pyx_n_s_startswith);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 746, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_2, __pyx_kp_s_c1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_kp_s_c1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!__pyx_t_12) {
  } else {
    __pyx_t_1 = __pyx_t_12;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_CVkey, __pyx_n_s_startswith);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 746, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_2, __pyx_kp_s_c2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_kp_s_c2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_1 = __pyx_t_12;
  __pyx_L4_bool_binop_done:;
</pre><pre class="cython line score-0">&#xA0;<span class="">747</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">748</span>:         if common.get_compressor_CV_index(CVkey) &lt; 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_get_compressor_CV_index(__pyx_v_CVkey, 0);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 748, __pyx_L1_error)</span>
    __pyx_t_1 = ((__pyx_t_13 &lt; 0) != 0);
    if (unlikely(__pyx_t_1)) {
/* … */
    }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">749</span>:             raise ValueError('CVkey [{key:s}] is invalid'.format(key = CVkey))</pre>
<pre class='cython code score-19 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_CVkey_key_s_is_invalid, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_key, __pyx_v_CVkey) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_empty_tuple, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">750</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">751</span>:         # Get the bounding involute angles</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">752</span>:         CV = CVangles(theta, geo, common.get_compressor_CV_index(CVkey))</pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_get_compressor_CV_index(__pyx_v_CVkey, 0);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 752, __pyx_L1_error)</span>
    __pyx_t_7 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_t_13, 0));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_v_CV = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">753</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">754</span>:         # Arrays of linearly spaced involute angles on each bounding involute</pre>
<pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">755</span>:         phi_outer = np.linspace(CV.Outer.phi_min, CV.Outer.phi_max, Ninv)</pre>
<pre class='cython code score-59 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_CV-&gt;Outer-&gt;phi_min);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_CV-&gt;Outer-&gt;phi_max);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ninv);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_9 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_2, __pyx_t_3, __pyx_t_6};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_2, __pyx_t_3, __pyx_t_6};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    {
      __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      if (__pyx_t_9) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_9); __pyx_t_9 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_8, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_8, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 2+__pyx_t_8, __pyx_t_6);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_6 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_phi_outer = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">756</span>:         phi_inner = np.linspace(CV.Inner.phi_max, CV.Inner.phi_min, Ninv)</pre>
<pre class='cython code score-59 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_CV-&gt;Inner-&gt;phi_max);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_CV-&gt;Inner-&gt;phi_min);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ninv);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_14)) {
      PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_5, __pyx_t_6, __pyx_t_3};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_14, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_14)) {
      PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_5, __pyx_t_6, __pyx_t_3};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_14, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      if (__pyx_t_2) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_8, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_8, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_8, __pyx_t_3);
      __pyx_t_5 = 0;
      __pyx_t_6 = 0;
      __pyx_t_3 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_14, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_v_phi_inner = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">757</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">758</span>:         # Key for the outer and inner involutes (one of 'fi', 'oo', 'oi', 'fi')</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">759</span>:         key_outer = common.involute_index_to_key(CV.Outer.involute)</pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_involute_index_to_key(__pyx_v_CV-&gt;Outer-&gt;involute, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 759, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_v_key_outer = ((PyObject*)__pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">760</span>:         key_inner = common.involute_index_to_key(CV.Inner.involute)</pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_involute_index_to_key(__pyx_v_CV-&gt;Inner-&gt;involute, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_v_key_inner = ((PyObject*)__pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">761</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">762</span>:         x1, y1 = coords_inv(phi_outer, geo, theta, key_outer)</pre>
<pre class='cython code score-15 '>    __pyx_t_4.__pyx_n = 1;
    __pyx_t_4.flag = __pyx_v_key_outer;
    __pyx_t_7 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_v_phi_outer, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (likely(__pyx_t_7 != Py_None)) {
      PyObject* sequence = __pyx_t_7;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_14 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      #else
      __pyx_t_14 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span>
    }
    __pyx_v_x1 = __pyx_t_14;
    __pyx_t_14 = 0;
    __pyx_v_y1 = __pyx_t_9;
    __pyx_t_9 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">763</span>:         x2, y2 = coords_inv(phi_inner, geo, theta, key_inner)</pre>
<pre class='cython code score-15 '>    __pyx_t_4.__pyx_n = 1;
    __pyx_t_4.flag = __pyx_v_key_inner;
    __pyx_t_7 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_v_phi_inner, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (likely(__pyx_t_7 != Py_None)) {
      PyObject* sequence = __pyx_t_7;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_14 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      #else
      __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_14 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>
    }
    __pyx_v_x2 = __pyx_t_9;
    __pyx_t_9 = 0;
    __pyx_v_y2 = __pyx_t_14;
    __pyx_t_14 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">764</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">765</span>:         #  Return the coordinates for the CV</pre>
<pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">766</span>:         return np.r_[x1,x2],np.r_[y1,y2]</pre>
<pre class='cython code score-44 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 766, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_r_2);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 766, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 766, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_x1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_x2);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_14, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 766, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 766, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_r_2);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 766, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 766, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_y1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_y2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_14, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 766, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 766, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_3);
    __pyx_t_9 = 0;
    __pyx_t_3 = 0;
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">767</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">768</span>:     elif CVkey == 'dd':</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_CVkey, __pyx_n_s_dd, Py_EQ)); if (unlikely(__pyx_t_1 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>
  if (likely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">769</span>:         theta_m = geo.phi_fie - theta - pi/2</pre>
<pre class='cython code score-0 '>    __pyx_v_theta_m = ((__pyx_v_geo-&gt;__pyx_base.phi_fie - __pyx_v_theta) - (M_PI / 2.0));
</pre><pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">770</span>:         t = np.linspace(geo.t1_arc1,geo.t2_arc1,700)</pre>
<pre class='cython code score-56 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.t1_arc1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.t2_arc1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_6 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_9)) {
      PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, __pyx_t_14, __pyx_int_700};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_9)) {
      PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, __pyx_t_14, __pyx_int_700};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    } else
    #endif
    {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (__pyx_t_6) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6); __pyx_t_6 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_8, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_8, __pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_700);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_700);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_8, __pyx_int_700);
      __pyx_t_3 = 0;
      __pyx_t_14 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_v_t = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">771</span>:         (x_farc1,y_farc1)=(</pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">772</span>:             geo.xa_arc1+geo.ra_arc1*np.cos(t),</pre>
<pre class='cython code score-43 '>    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.xa_arc1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.ra_arc1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_14)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_5 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_14, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 772, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">773</span>:             geo.ya_arc1+geo.ra_arc1*np.sin(t))</pre>
<pre class='cython code score-43 '>    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.ya_arc1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.ra_arc1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_14)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_9 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_14, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_x_farc1 = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_v_y_farc1 = __pyx_t_9;
    __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">774</span>:         (x_oarc1,y_oarc1)=(</pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">775</span>:            -geo.xa_arc1-geo.ra_arc1*np.cos(t)+geo.ro*cos(theta_m),</pre>
<pre class='cython code score-55 '>    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>((-__pyx_v_geo-&gt;__pyx_base.xa_arc1));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.ra_arc1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    __pyx_t_6 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_3, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 775, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_9, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.ro * cos(__pyx_v_theta_m)));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">776</span>:            -geo.ya_arc1-geo.ra_arc1*np.sin(t)+geo.ro*sin(theta_m))</pre>
<pre class='cython code score-55 '>    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((-__pyx_v_geo-&gt;__pyx_base.ya_arc1));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.ra_arc1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, function);
      }
    }
    __pyx_t_5 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_3, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_14, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_7, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.ro * sin(__pyx_v_theta_m)));<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_v_x_oarc1 = __pyx_t_9;
    __pyx_t_9 = 0;
    __pyx_v_y_oarc1 = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">777</span>: </pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">778</span>:         t=np.linspace(geo.t2_arc2,geo.t1_arc2,300)</pre>
<pre class='cython code score-57 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.t2_arc2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.t1_arc2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_14)) {
      PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_9, __pyx_t_5, __pyx_int_300};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_14, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_14)) {
      PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_9, __pyx_t_5, __pyx_int_300};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_14, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (__pyx_t_6) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6); __pyx_t_6 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_8, __pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_8, __pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_300);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_300);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2+__pyx_t_8, __pyx_int_300);
      __pyx_t_9 = 0;
      __pyx_t_5 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_14, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_t, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">779</span>:         (x_farc2,y_farc2)=(</pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">780</span>:             geo.xa_arc2+geo.ra_arc2*np.cos(t),</pre>
<pre class='cython code score-43 '>    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.xa_arc2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.ra_arc2);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_5, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_14, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">781</span>:             geo.ya_arc2+geo.ra_arc2*np.sin(t))</pre>
<pre class='cython code score-43 '>    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.ya_arc2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 781, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.ra_arc2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 781, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 781, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 781, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_14 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_14)) <span class='error_goto'>__PYX_ERR(0, 781, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 781, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 781, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_x_farc2 = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_y_farc2 = __pyx_t_14;
    __pyx_t_14 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">782</span>:         (x_oarc2,y_oarc2)=(</pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">783</span>:            -geo.xa_arc2-geo.ra_arc2*np.cos(t)+geo.ro*cos(theta_m),</pre>
<pre class='cython code score-55 '>    __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((-__pyx_v_geo-&gt;__pyx_base.xa_arc2));<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.ra_arc2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_9, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 783, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_14, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.ro * cos(__pyx_v_theta_m)));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">784</span>:            -geo.ya_arc2-geo.ra_arc2*np.sin(t)+geo.ro*sin(theta_m))</pre>
<pre class='cython code score-55 '>    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((-__pyx_v_geo-&gt;__pyx_base.ya_arc2));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 784, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.ra_arc2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 784, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 784, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 784, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_3 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_9, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 784, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 784, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_7, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 784, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.ro * sin(__pyx_v_theta_m)));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 784, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 784, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_x_oarc2 = __pyx_t_14;
    __pyx_t_14 = 0;
    __pyx_v_y_oarc2 = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">785</span>: </pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">786</span>:         t = np.linspace(geo.t1_arc3,geo.t2_arc3,700)</pre>
<pre class='cython code score-57 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;t1_arc3);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;t2_arc3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_14, __pyx_t_3, __pyx_int_700};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_14, __pyx_t_3, __pyx_int_700};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      if (__pyx_t_6) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_6); __pyx_t_6 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_8, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_8, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_700);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_700);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_8, __pyx_int_700);
      __pyx_t_14 = 0;
      __pyx_t_3 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_t, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">787</span>:         (x_farc3,y_farc3)=(</pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">788</span>:             geo.xa_arc3+geo.ra_arc3*np.cos(t),</pre>
<pre class='cython code score-43 '>    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;xa_arc3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 788, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;ra_arc3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 788, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 788, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 788, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, function);
      }
    }
    __pyx_t_9 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_3, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_14, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 788, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 788, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">789</span>:             geo.ya_arc3+geo.ra_arc3*np.sin(t))</pre>
<pre class='cython code score-43 '>    __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;ya_arc3);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;ra_arc3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_5 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_3, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_x_farc3 = __pyx_t_9;
    __pyx_t_9 = 0;
    __pyx_v_y_farc3 = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">790</span>:         (x_oarc3,y_oarc3)=(</pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">791</span>:            -geo.xa_arc3-geo.ra_arc3*np.cos(t)+geo.ro*cos(theta_m),</pre>
<pre class='cython code score-55 '>    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((-__pyx_v_geo-&gt;xa_arc3));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;ra_arc3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_14)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    __pyx_t_6 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_14, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_5, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.ro * cos(__pyx_v_theta_m)));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">792</span>:            -geo.ya_arc3-geo.ra_arc3*np.sin(t)+geo.ro*sin(theta_m))</pre>
<pre class='cython code score-55 '>    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((-__pyx_v_geo-&gt;ya_arc3));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;ra_arc3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_14)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_9 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_14, __pyx_v_t) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_t);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 792, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_7, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.ro * sin(__pyx_v_theta_m)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_x_oarc3 = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_v_y_oarc3 = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">793</span>: </pre>
<pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">794</span>:         phi=np.linspace(geo.phi_fis,geo.phi_fos+pi,Ninv)</pre>
<pre class='cython code score-59 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;__pyx_base.phi_fis);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_geo-&gt;__pyx_base.phi_fos + M_PI));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ninv);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_14 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_14)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_14, __pyx_t_5, __pyx_t_9, __pyx_t_6};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_14, __pyx_t_5, __pyx_t_9, __pyx_t_6};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    {
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (__pyx_t_14) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_14); __pyx_t_14 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_8, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_8, __pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2+__pyx_t_8, __pyx_t_6);
      __pyx_t_5 = 0;
      __pyx_t_9 = 0;
      __pyx_t_6 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_phi = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">795</span>:         (x_finv,y_finv)=coords_inv(phi,geo,theta,'fi')</pre>
<pre class='cython code score-15 '>    __pyx_t_4.__pyx_n = 1;
    __pyx_t_4.flag = __pyx_n_s_fi;
    __pyx_t_7 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_v_phi, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 795, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (likely(__pyx_t_7 != Py_None)) {
      PyObject* sequence = __pyx_t_7;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 795, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 795, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 795, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 795, __pyx_L1_error)</span>
    }
    __pyx_v_x_finv = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_y_finv = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">796</span>:         (x_oinv,y_oinv)=coords_inv(phi,geo,theta,'oi')</pre>
<pre class='cython code score-15 '>    __pyx_t_4.__pyx_n = 1;
    __pyx_t_4.flag = __pyx_n_s_oi;
    __pyx_t_7 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_v_phi, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo), __pyx_v_theta, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 796, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (likely(__pyx_t_7 != Py_None)) {
      PyObject* sequence = __pyx_t_7;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 796, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 796, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>
    }
    __pyx_v_x_oinv = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_y_oinv = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">797</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">798</span>:         x=np.r_[x_farc2,x_farc3,x_farc1,x_finv,x_oarc2,x_oarc1,x_oinv,x_farc2[0]]</pre>
<pre class='cython code score-31 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 798, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_r_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 798, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x_farc2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 798, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 798, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_farc2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_farc2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_x_farc2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_farc3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_farc3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_x_farc3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_farc1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_farc1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_x_farc1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_finv);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_finv);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_v_x_finv);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_oarc2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_oarc2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4, __pyx_v_x_oarc2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_oarc1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_oarc1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 5, __pyx_v_x_oarc1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_oinv);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_oinv);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 6, __pyx_v_x_oinv);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 7, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 798, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_x = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">799</span>:         y=np.r_[y_farc2,y_farc3,y_farc1,y_finv,y_oarc2,y_oarc1,y_oinv,y_farc2[0]]</pre>
<pre class='cython code score-31 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_r_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_y_farc2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_farc2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_farc2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_y_farc2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_farc3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_farc3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_y_farc3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_farc1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_farc1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_v_y_farc1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_finv);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_finv);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_v_y_finv);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_oarc2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_oarc2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 4, __pyx_v_y_oarc2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_oarc1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_oarc1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 5, __pyx_v_y_oarc1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_oinv);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_oinv);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 6, __pyx_v_y_oinv);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 7, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_y = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">800</span>:         return x,y</pre>
<pre class='cython code score-10 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_x);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_y);
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">801</span>:     else:</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">802</span>:         raise KeyError('Could not match this CVkey: '+CVkey)</pre>
<pre class='cython code score-11 '>  /*else*/ {
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_Could_not_match_this_CVkey, __pyx_v_CVkey);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 802, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_KeyError, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 802, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 802, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">803</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">804</span>: cpdef HTAnglesClass HT_angles(double theta, DanfossGeoVals geo, key):</pre>
<pre class='cython code score-51 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_39HT_angles(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_HTAnglesClass *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_HT_angles(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, PyObject *__pyx_v_key, CYTHON_UNUSED int __pyx_skip_dispatch) {
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_HTAnglesClass *__pyx_v_angles = 0;
  int __pyx_v_index;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_CV = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_HTAnglesClass *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("HT_angles", 0);
  <span class='trace'>__Pyx_TraceCall</span>("HT_angles", __pyx_f[0], 804, 0, <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.HT_angles", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_angles);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_CV);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_39HT_angles(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_38HT_angles[] = "HT_angles(double theta, DanfossGeoVals geo, key) -&gt; HTAnglesClass\n\n    Return the heat transfer bounding angles for the given control volume\n\n    Parameters\n    ----------\n    theta : float\n        Crank angle in the range [:math:`0,2\\pi`]\n    geo : DanfossGeoVals instance\n    key : string\n        Key for the control volume following the scroll compressor\n        naming conventions\n\n    Returns\n    -------\n    angles : HTAngles Class\n        with the attributes:\n        phi_1_i: maximum involute angle on the inner involute of the wrap\n        that forms the outer wall of the CV\n\n        phi_2_i: minimum involute angle on the inner involute of the wrap\n        that forms the outer wall of the CV\n\n        phi_1_o: maximum involute angle on the outer involute of the wrap\n        that forms the inner wall of the CV\n\n        phi_2_o: minimum involute angle on the outer involute of the wrap\n        that forms the inner wall of the CV\n\n    Notes\n    -----\n    The keys s1, c1.x, and d1 have as their outer wrap the fixed scroll\n\n    The keys s2, c2.x, and d2 have as their outer wrap the orbiting scroll\n\n    \"Minimum\", and \"Maximum\" refer to absolute values of the angles\n\n    Raises\n    ------\n    If key is not valid, raises a KeyError\n    ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_39HT_angles(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  PyObject *__pyx_v_key = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("HT_angles (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_key,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("HT_angles", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_key)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("HT_angles", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "HT_angles") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
    __pyx_v_key = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("HT_angles", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.HT_angles", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_38HT_angles(__pyx_self, __pyx_v_theta, __pyx_v_geo, __pyx_v_key);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_38HT_angles(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, PyObject *__pyx_v_key) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("HT_angles", 0);
  <span class='trace'>__Pyx_TraceCall</span>("HT_angles (wrapper)", __pyx_f[0], 804, 0, <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_HT_angles(__pyx_v_theta, __pyx_v_geo, __pyx_v_key, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.HT_angles", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">805</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">806</span>:     Return the heat transfer bounding angles for the given control volume</pre>
<pre class="cython line score-0">&#xA0;<span class="">807</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">808</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">809</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">810</span>:     theta : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">811</span>:         Crank angle in the range [:math:`0,2\pi`]</pre>
<pre class="cython line score-0">&#xA0;<span class="">812</span>:     geo : DanfossGeoVals instance</pre>
<pre class="cython line score-0">&#xA0;<span class="">813</span>:     key : string</pre>
<pre class="cython line score-0">&#xA0;<span class="">814</span>:         Key for the control volume following the scroll compressor</pre>
<pre class="cython line score-0">&#xA0;<span class="">815</span>:         naming conventions</pre>
<pre class="cython line score-0">&#xA0;<span class="">816</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">817</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">818</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">819</span>:     angles : HTAngles Class</pre>
<pre class="cython line score-0">&#xA0;<span class="">820</span>:         with the attributes:</pre>
<pre class="cython line score-0">&#xA0;<span class="">821</span>:         phi_1_i: maximum involute angle on the inner involute of the wrap</pre>
<pre class="cython line score-0">&#xA0;<span class="">822</span>:         that forms the outer wall of the CV</pre>
<pre class="cython line score-0">&#xA0;<span class="">823</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">824</span>:         phi_2_i: minimum involute angle on the inner involute of the wrap</pre>
<pre class="cython line score-0">&#xA0;<span class="">825</span>:         that forms the outer wall of the CV</pre>
<pre class="cython line score-0">&#xA0;<span class="">826</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">827</span>:         phi_1_o: maximum involute angle on the outer involute of the wrap</pre>
<pre class="cython line score-0">&#xA0;<span class="">828</span>:         that forms the inner wall of the CV</pre>
<pre class="cython line score-0">&#xA0;<span class="">829</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">830</span>:         phi_2_o: minimum involute angle on the outer involute of the wrap</pre>
<pre class="cython line score-0">&#xA0;<span class="">831</span>:         that forms the inner wall of the CV</pre>
<pre class="cython line score-0">&#xA0;<span class="">832</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">833</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">834</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">835</span>:     The keys s1, c1.x, and d1 have as their outer wrap the fixed scroll</pre>
<pre class="cython line score-0">&#xA0;<span class="">836</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">837</span>:     The keys s2, c2.x, and d2 have as their outer wrap the orbiting scroll</pre>
<pre class="cython line score-0">&#xA0;<span class="">838</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">839</span>:     "Minimum", and "Maximum" refer to absolute values of the angles</pre>
<pre class="cython line score-0">&#xA0;<span class="">840</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">841</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">842</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">843</span>:     If key is not valid, raises a KeyError</pre>
<pre class="cython line score-0">&#xA0;<span class="">844</span>:     """</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">845</span>:     cdef HTAnglesClass angles = HTAnglesClass.__new__(HTAnglesClass)</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = __Pyx_tp_new(((PyObject *)__pyx_ptype_5PDSim_6scroll_17common_scroll_geo_HTAnglesClass), __pyx_empty_tuple);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 845, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_HTAnglesClass)))) <span class='error_goto'>__PYX_ERR(0, 845, __pyx_L1_error)</span>
  __pyx_v_angles = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_HTAnglesClass *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">846</span>:     cdef int index = common.get_compressor_CV_index(key)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_get_compressor_CV_index(__pyx_v_key, 0);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 846, __pyx_L1_error)</span>
  __pyx_v_index = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">847</span>:     cdef CVInvolutes CV = CVangles(theta, geo, index)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_v_index, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 847, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_CV = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">848</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">849</span>:     angles.phi_1_i = CV.Outer.phi_max</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_CV-&gt;Outer-&gt;phi_max;
  __pyx_v_angles-&gt;phi_1_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">850</span>:     angles.phi_2_i = CV.Outer.phi_min</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_CV-&gt;Outer-&gt;phi_min;
  __pyx_v_angles-&gt;phi_2_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">851</span>:     angles.phi_i0 = CV.Outer.phi_0</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_CV-&gt;Outer-&gt;phi_0;
  __pyx_v_angles-&gt;phi_i0 = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">852</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">853</span>:     angles.phi_1_o = CV.Inner.phi_max</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_CV-&gt;Inner-&gt;phi_max;
  __pyx_v_angles-&gt;phi_1_o = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">854</span>:     angles.phi_2_o = CV.Inner.phi_min</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_CV-&gt;Inner-&gt;phi_min;
  __pyx_v_angles-&gt;phi_2_o = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">855</span>:     angles.phi_o0 = CV.Inner.phi_0</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_CV-&gt;Inner-&gt;phi_0;
  __pyx_v_angles-&gt;phi_o0 = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">856</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">857</span>:     return angles</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_angles));
  __pyx_r = __pyx_v_angles;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">858</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">859</span>: cdef _radial_leakage_angles(CVInvolutes CV_up, CVInvolutes CV_down, double *angle_min, double *angle_max):</pre>
<pre class='cython code score-3 '>static PyObject *__pyx_f_12DanfossPDSim_16asymm_scroll_geo__radial_leakage_angles(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_CV_up, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_CV_down, double *__pyx_v_angle_min, double *__pyx_v_angle_max) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_radial_leakage_angles", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_radial_leakage_angles", __pyx_f[0], 859, 0, <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo._radial_leakage_angles", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">860</span>:     return overlap(CV_down.Inner.phi_min, CV_down.Inner.phi_max, CV_up.Outer.phi_min, CV_up.Outer.phi_max, angle_min, angle_max)</pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_f_12DanfossPDSim_16asymm_scroll_geo_overlap(__pyx_v_CV_down-&gt;Inner-&gt;phi_min, __pyx_v_CV_down-&gt;Inner-&gt;phi_max, __pyx_v_CV_up-&gt;Outer-&gt;phi_min, __pyx_v_CV_up-&gt;Outer-&gt;phi_max, __pyx_v_angle_min, __pyx_v_angle_max));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 860, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">861</span>: </pre>
<pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">862</span>: cpdef get_radial_leakage_angles(double theta, DanfossGeoVals geo, long index_up, long index_down):</pre>
<pre class='cython code score-71 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_41get_radial_leakage_angles(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12DanfossPDSim_16asymm_scroll_geo_get_radial_leakage_angles(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, long __pyx_v_index_up, long __pyx_v_index_down, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_phi_min;
  double __pyx_v_phi_max;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_CV_up = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_CV_down = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_radial_leakage_angles", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_radial_leakage_angles", __pyx_f[0], 862, 0, <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.get_radial_leakage_angles", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_CV_up);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_CV_down);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_41get_radial_leakage_angles(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_40get_radial_leakage_angles[] = "get_radial_leakage_angles(double theta, DanfossGeoVals geo, long index_up, long index_down)";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_41get_radial_leakage_angles(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  long __pyx_v_index_up;
  long __pyx_v_index_down;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_radial_leakage_angles (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_index_up,&amp;__pyx_n_s_index_down,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_radial_leakage_angles", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_index_up)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_radial_leakage_angles", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_index_down)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_radial_leakage_angles", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_radial_leakage_angles") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
    __pyx_v_index_up = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[2]); if (unlikely((__pyx_v_index_up == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
    __pyx_v_index_down = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[3]); if (unlikely((__pyx_v_index_down == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_radial_leakage_angles", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.get_radial_leakage_angles", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_40get_radial_leakage_angles(__pyx_self, __pyx_v_theta, __pyx_v_geo, __pyx_v_index_up, __pyx_v_index_down);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_40get_radial_leakage_angles(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, long __pyx_v_index_up, long __pyx_v_index_down) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_radial_leakage_angles", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_radial_leakage_angles (wrapper)", __pyx_f[0], 862, 0, <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_get_radial_leakage_angles(__pyx_v_theta, __pyx_v_geo, __pyx_v_index_up, __pyx_v_index_down, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.get_radial_leakage_angles", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">863</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">864</span>:     cdef double phi_min, phi_max</pre>
<pre class="cython line score-0">&#xA0;<span class="">865</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">866</span>:     # Bounding angles for each control volume to be considered here</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">867</span>:     cdef CVInvolutes CV_up = CVangles(theta, geo, index_up)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_v_index_up, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_CV_up = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">868</span>:     cdef CVInvolutes CV_down = CVangles(theta, geo, index_down)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_v_index_down, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 868, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_CV_down = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">869</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">870</span>:     return _radial_leakage_angles(CV_up, CV_down, &amp;phi_min, &amp;phi_max)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo__radial_leakage_angles(__pyx_v_CV_up, __pyx_v_CV_down, (&amp;__pyx_v_phi_min), (&amp;__pyx_v_phi_max));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 870, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">871</span>: </pre>
<pre class="cython line score-92" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">872</span>: cpdef double radial_leakage_area(double theta, DanfossGeoVals geo, int index_up, int index_down, int location = common.UP) except *:</pre>
<pre class='cython code score-92 '>static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_43radial_leakage_area(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_12DanfossPDSim_16asymm_scroll_geo_radial_leakage_area(double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, int __pyx_v_index_up, int __pyx_v_index_down, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_12DanfossPDSim_16asymm_scroll_geo_radial_leakage_area *__pyx_optional_args) {
  double __pyx_v_phi_min;
  double __pyx_v_phi_max;
  double __pyx_v_phi_0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_CV_up = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_CV_down = 0;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("radial_leakage_area", 0);
  <span class='trace'>__Pyx_TraceCall</span>("radial_leakage_area", __pyx_f[0], 872, 0, <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.radial_leakage_area", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_CV_up);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_CV_down);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_43radial_leakage_area(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12DanfossPDSim_16asymm_scroll_geo_42radial_leakage_area[] = "radial_leakage_area(double theta, DanfossGeoVals geo, int index_up, int index_down, int location=common.UP) -&gt; double\n\n    Notes\n    -----\n    Normally the higher pressure chamber is inside and the lower pressure chamber is outside.  But this might not be the case for some CV for theta&lt;pi\n\n    Also, you can tell which involute is outside by comparing radii of curvature.  The larger radius will always be towards the outside. (Right?)\n    ";
static PyObject *__pyx_pw_12DanfossPDSim_16asymm_scroll_geo_43radial_leakage_area(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo = 0;
  int __pyx_v_index_up;
  int __pyx_v_index_down;
  int __pyx_v_location;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("radial_leakage_area (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_index_up,&amp;__pyx_n_s_index_down,&amp;__pyx_n_s_location,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("radial_leakage_area", 0, 4, 5, 1); <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_index_up)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("radial_leakage_area", 0, 4, 5, 2); <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_index_down)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("radial_leakage_area", 0, 4, 5, 3); <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_location);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "radial_leakage_area") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *)values[1]);
    __pyx_v_index_up = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]); if (unlikely((__pyx_v_index_up == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L3_error)</span>
    __pyx_v_index_down = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_index_down == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L3_error)</span>
    if (values[4]) {
      __pyx_v_location = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_location == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L3_error)</span>
    } else {
      __pyx_v_location = __pyx_k__4;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("radial_leakage_area", 0, 4, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.radial_leakage_area", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_12DanfossPDSim_16asymm_scroll_geo_42radial_leakage_area(__pyx_self, __pyx_v_theta, __pyx_v_geo, __pyx_v_index_up, __pyx_v_index_down, __pyx_v_location);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_12DanfossPDSim_16asymm_scroll_geo_42radial_leakage_area(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_12DanfossPDSim_16asymm_scroll_geo_DanfossGeoVals *__pyx_v_geo, int __pyx_v_index_up, int __pyx_v_index_down, int __pyx_v_location) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("radial_leakage_area", 0);
  <span class='trace'>__Pyx_TraceCall</span>("radial_leakage_area (wrapper)", __pyx_f[0], 872, 0, <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.location = __pyx_v_location;
  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo_radial_leakage_area(__pyx_v_theta, __pyx_v_geo, __pyx_v_index_up, __pyx_v_index_down, 0, &amp;__pyx_t_2); if (unlikely(__pyx_t_1 == ((double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 872, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DanfossPDSim.asymm_scroll_geo.radial_leakage_area", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_k__4 = __pyx_e_5PDSim_6scroll_17common_scroll_geo_UP;
  __pyx_k__4 = __pyx_e_5PDSim_6scroll_17common_scroll_geo_UP;
/* … */
struct __pyx_opt_args_12DanfossPDSim_16asymm_scroll_geo_radial_leakage_area {
  int __pyx_n;
  int location;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">873</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">874</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">875</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">876</span>:     Normally the higher pressure chamber is inside and the lower pressure chamber is outside.  But this might not be the case for some CV for theta&lt;pi</pre>
<pre class="cython line score-0">&#xA0;<span class="">877</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">878</span>:     Also, you can tell which involute is outside by comparing radii of curvature.  The larger radius will always be towards the outside. (Right?)</pre>
<pre class="cython line score-0">&#xA0;<span class="">879</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">880</span>:     cdef double phi_min, phi_max, phi_0</pre>
<pre class="cython line score-0">&#xA0;<span class="">881</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">882</span>:     # Bounding angles for each control volume to be considered here</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">883</span>:     cdef CVInvolutes CV_up = CVangles(theta, geo, index_up)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_v_index_up, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 883, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_CV_up = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">884</span>:     cdef CVInvolutes CV_down = CVangles(theta, geo, index_down)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_12DanfossPDSim_16asymm_scroll_geo_CVangles(__pyx_v_theta, __pyx_v_geo, __pyx_v_index_down, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 884, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_CV_down = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">885</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">886</span>:     phi_0 = (CV_up.Outer.phi_0 + CV_down.Inner.phi_0)/2</pre>
<pre class='cython code score-0 '>  __pyx_v_phi_0 = ((__pyx_v_CV_up-&gt;Outer-&gt;phi_0 + __pyx_v_CV_down-&gt;Inner-&gt;phi_0) / 2.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">887</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">888</span>:     if _radial_leakage_angles(CV_up, CV_down, &amp;phi_min, &amp;phi_max):</pre>
<pre class='cython code score-3 '>  __pyx_t_1 = __pyx_f_12DanfossPDSim_16asymm_scroll_geo__radial_leakage_angles(__pyx_v_CV_up, __pyx_v_CV_down, (&amp;__pyx_v_phi_min), (&amp;__pyx_v_phi_max));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 888, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">889</span>:         return geo.delta_radial*geo.rb*((phi_max**2-phi_min**2)/2-phi_0*(phi_max-phi_min))</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;__pyx_base.delta_radial * __pyx_v_geo-&gt;__pyx_base.rb) * (((pow(__pyx_v_phi_max, 2.0) - pow(__pyx_v_phi_min, 2.0)) / 2.0) - (__pyx_v_phi_0 * (__pyx_v_phi_max - __pyx_v_phi_min))));
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">890</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">891</span>:         return 0.0</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = 0.0;
    goto __pyx_L0;
  }
</pre></div></body></html>
