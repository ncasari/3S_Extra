<!DOCTYPE html>
<!-- Generated by Cython 0.29.32 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: common_scroll_geo.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.32</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="common_scroll_geo.cpp">common_scroll_geo.cpp</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: from __future__ import division</pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: cimport cython</pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: import cython</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">004</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">005</span>: </pre>
<pre class="cython line score-326" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">006</span>: cpdef double_or_numpy plus_one(double_or_numpy x):</pre>
<pre class='cython code score-326 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_5plus_one(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_4plus_one[] = "plus_one(signatures, args, kwargs, defaults)";
static PyMethodDef __pyx_mdef_5PDSim_6scroll_17common_scroll_geo_5plus_one = {"plus_one", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_5PDSim_6scroll_17common_scroll_geo_5plus_one, METH_VARARGS|METH_KEYWORDS, __pyx_doc_5PDSim_6scroll_17common_scroll_geo_4plus_one};
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_5plus_one(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_signatures = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED PyObject *__pyx_v_defaults = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fused_cpdef (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_signatures,&amp;__pyx_n_s_args,&amp;__pyx_n_s_kwargs,&amp;__pyx_n_s_defaults,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_signatures = values[0];
    __pyx_v_args = values[1];
    __pyx_v_kwargs = values[2];
    __pyx_v_defaults = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_4plus_one(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_4plus_one(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_signatures, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, CYTHON_UNUSED PyObject *__pyx_v_defaults) {
  PyObject *__pyx_v_dest_sig = NULL;
  Py_ssize_t __pyx_v_i;
  CYTHON_UNUSED PyTypeObject *__pyx_v_ndarray = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_v_itemsize;
  PyObject *__pyx_v_arg = NULL;
  PyObject *__pyx_v_candidates = NULL;
  PyObject *__pyx_v_sig = NULL;
  int __pyx_v_match_found;
  PyObject *__pyx_v_src_sig = NULL;
  PyObject *__pyx_v_dst_type = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("plus_one", 0);
  <span class='trace'>__Pyx_TraceCall</span>("plus_one", __pyx_f[0], 6, 0, <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kwargs);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_None);
  __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_3 = (__pyx_v_kwargs != Py_None);
  __pyx_t_4 = (__pyx_t_3 != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_2 = __pyx_t_4;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_kwargs); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  __pyx_t_3 = ((!__pyx_t_4) != 0);
  __pyx_t_2 = __pyx_t_3;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_2) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kwargs, Py_None);
  }
  __pyx_t_1 = ((PyObject *)<span class='pyx_c_api'>__Pyx_ImportNumPyArrayTypeIfAvailable</span>());<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_itemsize = -1L;
  if (unlikely(__pyx_v_args == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
    <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  }
  __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  __pyx_t_2 = ((0 &lt; __pyx_t_5) != 0);
  if (__pyx_t_2) {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(((PyObject*)__pyx_v_args), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_v_arg = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L6;
  }
  __pyx_t_3 = (__pyx_v_kwargs != Py_None);
  __pyx_t_4 = (__pyx_t_3 != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_2 = __pyx_t_4;
    goto __pyx_L7_bool_binop_done;
  }
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  }
  __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_n_s_x, ((PyObject*)__pyx_v_kwargs), Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  __pyx_t_3 = (__pyx_t_4 != 0);
  __pyx_t_2 = __pyx_t_3;
  __pyx_L7_bool_binop_done:;
  if (__pyx_t_2) {
    if (unlikely(__pyx_v_kwargs == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_kwargs), __pyx_n_s_x);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_v_arg = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L6;
  }
  /*else*/ {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_kp_s_);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Expected_at_least_d_argument_s_g, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_6, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  }
  __pyx_L6:;
  while (1) {
    __pyx_t_2 = <span class='py_c_api'>PyFloat_Check</span>(__pyx_v_arg); 
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
      goto __pyx_L10_break;
    }
    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_kp_s_);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_numpy);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_numpy);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_numpy);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, Py_None);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin___import__, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_arg, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_2 = (__pyx_t_3 != 0);
    if (__pyx_t_2) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_n_s_ndarray, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
      goto __pyx_L10_break;
    }
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
    goto __pyx_L10_break;
  }
  __pyx_L10_break:;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_candidates = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  if (unlikely(__pyx_v_signatures == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  }
  __pyx_t_6 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&amp;__pyx_t_7), (&amp;__pyx_t_8));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __pyx_t_1 = __pyx_t_6;
  __pyx_t_6 = 0;
  while (1) {
    __pyx_t_9 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_7, &amp;__pyx_t_5, &amp;__pyx_t_6, NULL, NULL, __pyx_t_8);
    if (unlikely(__pyx_t_9 == 0)) break;
    if (unlikely(__pyx_t_9 == -1)) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sig, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_v_match_found = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_sig, __pyx_n_s_strip);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_12 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
      }
    }
    __pyx_t_10 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_12, __pyx_kp_s__2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_kp_s__2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
      }
    }
    __pyx_t_6 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_10, __pyx_kp_s__3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_kp_s__3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_src_sig, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_13 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_dest_sig);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((Py_ssize_t)-1))) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    __pyx_t_14 = __pyx_t_13;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
      __pyx_v_i = __pyx_t_15;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_dest_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dst_type, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_2 = (__pyx_v_dst_type != Py_None);
      __pyx_t_3 = (__pyx_t_2 != 0);
      if (__pyx_t_3) {
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_src_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_11 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_v_dst_type, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_11); if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        if (__pyx_t_3) {
          __pyx_v_match_found = 1;
          goto __pyx_L18;
        }
        /*else*/ {
          __pyx_v_match_found = 0;
          goto __pyx_L16_break;
        }
        __pyx_L18:;
      }
    }
    __pyx_L16_break:;
    __pyx_t_3 = (__pyx_v_match_found != 0);
    if (__pyx_t_3) {
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_candidates, __pyx_v_sig);<span class='error_goto'> if (unlikely(__pyx_t_16 == ((int)-1))) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates) != 0);
  __pyx_t_2 = ((!__pyx_t_3) != 0);
  if (__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  }
  __pyx_t_7 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  __pyx_t_2 = ((__pyx_t_7 &gt; 1) != 0);
  if (__pyx_t_2) {
/* … */
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_No_matching_signature_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  }
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(__pyx_v_signatures == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_candidates, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_signatures), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_11;
    __pyx_t_11 = 0;
    goto __pyx_L0;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dest_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_src_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dst_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_55__pyx_fuse_0plus_one(PyObject *__pyx_self, PyObject *__pyx_arg_x); /*proto*/
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_5plus_one(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_fuse_0__pyx_f_5PDSim_6scroll_17common_scroll_geo_plus_one(double __pyx_v_x, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_0plus_one", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__pyx_fuse_0plus_one", __pyx_f[0], 6, 0, <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.plus_one", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_55__pyx_fuse_0plus_one(PyObject *__pyx_self, PyObject *__pyx_arg_x); /*proto*/
static PyMethodDef __pyx_fuse_0__pyx_mdef_5PDSim_6scroll_17common_scroll_geo_55__pyx_fuse_0plus_one = {"__pyx_fuse_0plus_one", (PyCFunction)__pyx_pw_5PDSim_6scroll_17common_scroll_geo_55__pyx_fuse_0plus_one, METH_O, __pyx_doc_5PDSim_6scroll_17common_scroll_geo_4plus_one};
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_55__pyx_fuse_0plus_one(PyObject *__pyx_self, PyObject *__pyx_arg_x) {
  double __pyx_v_x;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_0plus_one (wrapper)", 0);
  assert(__pyx_arg_x); {
    __pyx_v_x = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_arg_x); if (unlikely((__pyx_v_x == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.__pyx_fuse_0plus_one", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_54__pyx_fuse_0plus_one(__pyx_self, ((double)__pyx_v_x));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_54__pyx_fuse_0plus_one(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_0plus_one", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__pyx_fuse_0plus_one (wrapper)", __pyx_f[0], 6, 0, <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_fuse_0__pyx_f_5PDSim_6scroll_17common_scroll_geo_plus_one(__pyx_v_x, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.__pyx_fuse_0plus_one", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_57__pyx_fuse_1plus_one(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_5plus_one(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyArrayObject *__pyx_fuse_1__pyx_f_5PDSim_6scroll_17common_scroll_geo_plus_one(PyArrayObject *__pyx_v_x, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyArrayObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_1plus_one", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__pyx_fuse_1plus_one", __pyx_f[0], 6, 0, <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.plus_one", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_57__pyx_fuse_1plus_one(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_fuse_1__pyx_mdef_5PDSim_6scroll_17common_scroll_geo_57__pyx_fuse_1plus_one = {"__pyx_fuse_1plus_one", (PyCFunction)__pyx_pw_5PDSim_6scroll_17common_scroll_geo_57__pyx_fuse_1plus_one, METH_O, __pyx_doc_5PDSim_6scroll_17common_scroll_geo_4plus_one};
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_57__pyx_fuse_1plus_one(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_1plus_one (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_x), __pyx_ptype_5numpy_ndarray, 1, "x", 0))) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_56__pyx_fuse_1plus_one(__pyx_self, ((PyArrayObject *)__pyx_v_x));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_56__pyx_fuse_1plus_one(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_1plus_one", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__pyx_fuse_1plus_one (wrapper)", __pyx_f[0], 6, 0, <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_fuse_1__pyx_f_5PDSim_6scroll_17common_scroll_geo_plus_one(__pyx_v_x, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.__pyx_fuse_1plus_one", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Function_call_with_ambiguous_arg);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
/* … */
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_x, __pyx_n_s_x);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_FusedFunction_New(&amp;__pyx_fuse_0__pyx_mdef_5PDSim_6scroll_17common_scroll_geo_55__pyx_fuse_0plus_one, 0, __pyx_n_s_pyx_fuse_0plus_one, NULL, __pyx_n_s_PDSim_scroll_common_scroll_geo, __pyx_d, ((PyObject *)__pyx_codeobj__27));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_double, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_FusedFunction_New(&amp;__pyx_fuse_1__pyx_mdef_5PDSim_6scroll_17common_scroll_geo_57__pyx_fuse_1plus_one, 0, __pyx_n_s_pyx_fuse_1plus_one, NULL, __pyx_n_s_PDSim_scroll_common_scroll_geo, __pyx_d, ((PyObject *)__pyx_codeobj__27));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_ndarray, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_FusedFunction_New(&amp;__pyx_mdef_5PDSim_6scroll_17common_scroll_geo_5plus_one, 0, __pyx_n_s_plus_one, NULL, __pyx_n_s_PDSim_scroll_common_scroll_geo, __pyx_d, ((PyObject *)__pyx_codeobj__27));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_empty_tuple);
  ((__pyx_FusedFunctionObject *) __pyx_t_2)-&gt;__signatures__ = __pyx_t_1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_plus_one, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__27 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_PDSim_scroll_common_scroll_geo_p, __pyx_n_s_pyx_fuse_0plus_one, 6, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">007</span>:     return x + 1.0</pre>
<pre class='cython code score-8 '>  __pyx_r = (__pyx_v_x + 1.0);
  goto __pyx_L0;
/* … */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_v_x), __pyx_float_1_0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 7, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: cdef class VdVstruct:</pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">010</span>:     def __init__(self, V, dV):</pre>
<pre class='cython code score-26 '>/* Python wrapper */
static int __pyx_pw_5PDSim_6scroll_17common_scroll_geo_9VdVstruct_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_5PDSim_6scroll_17common_scroll_geo_9VdVstruct_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_V = 0;
  PyObject *__pyx_v_dV = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_V,&amp;__pyx_n_s_dV,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_V)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dV)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_V = values[0];
    __pyx_v_dV = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.VdVstruct.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_9VdVstruct___init__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_v_self), __pyx_v_V, __pyx_v_dV);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5PDSim_6scroll_17common_scroll_geo_9VdVstruct___init__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_v_self, PyObject *__pyx_v_V, PyObject *__pyx_v_dV) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 10, 0, <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.VdVstruct.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">011</span>:         self.V = V</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_V); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 11, __pyx_L1_error)</span>
  __pyx_v_self-&gt;V = __pyx_t_1;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">012</span>:         self.dV = dV</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_dV); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span>
  __pyx_v_self-&gt;dV = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">013</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">014</span>:     def __repr__(self):</pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_9VdVstruct_3__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_9VdVstruct_3__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_9VdVstruct_2__repr__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_9VdVstruct_2__repr__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__repr__", __pyx_f[0], 14, 0, <span class='error_goto'>__PYX_ERR(0, 14, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.VdVstruct.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">015</span>:         return str(list([self.V,self.dV]))</pre>
<pre class='cython code score-27 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;V);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;dV);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">016</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: cdef class HTAnglesClass:</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">018</span>:     def __repr__(self):</pre>
<pre class='cython code score-8 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_13HTAnglesClass_1__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_13HTAnglesClass_1__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_13HTAnglesClass___repr__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_HTAnglesClass *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_13HTAnglesClass___repr__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_HTAnglesClass *__pyx_v_self) {
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__repr__", __pyx_f[0], 18, 0, <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.HTAnglesClass.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">019</span>:         s = ''</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_);
  __pyx_v_s = __pyx_kp_s_;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">020</span>:         for k in ['phi_1_i','phi_2_i','phi_1_o','phi_2_o','phi_i0','phi_o0']:</pre>
<pre class='cython code score-11 '>  __pyx_t_1 = __pyx_tuple__6; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 &gt;= 6) break;
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_k, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_phi_1_i, __pyx_n_s_phi_2_i, __pyx_n_s_phi_1_o, __pyx_n_s_phi_2_o, __pyx_n_s_phi_i0, __pyx_n_s_phi_o0);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">021</span>:             s += k + ' : ' + str(getattr(self,k)) + '\n'</pre>
<pre class='cython code score-30 '>    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_k, __pyx_kp_s__7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_kp_s__8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">022</span>:         return s</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_s);
  __pyx_r = __pyx_v_s;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">023</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>: cdef class CVInvolute:</pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">025</span>:     def __init__(self):</pre>
<pre class='cython code score-13 '>/* Python wrapper */
static int __pyx_pw_5PDSim_6scroll_17common_scroll_geo_10CVInvolute_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_5PDSim_6scroll_17common_scroll_geo_10CVInvolute_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_10CVInvolute___init__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolute *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5PDSim_6scroll_17common_scroll_geo_10CVInvolute___init__(CYTHON_UNUSED struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolute *__pyx_v_self) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 25, 0, <span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>);

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.CVInvolute.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">026</span>:         pass</pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>: cdef class CVInvolutes:</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">029</span>:     def __init__(self):</pre>
<pre class='cython code score-14 '>/* Python wrapper */
static int __pyx_pw_5PDSim_6scroll_17common_scroll_geo_11CVInvolutes_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_5PDSim_6scroll_17common_scroll_geo_11CVInvolutes_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_11CVInvolutes___init__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5PDSim_6scroll_17common_scroll_geo_11CVInvolutes___init__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_self) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 29, 0, <span class='error_goto'>__PYX_ERR(0, 29, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.CVInvolutes.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">030</span>:         self.Inner = CVInvolute.__new__(CVInvolute)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = ((PyObject *)__pyx_tp_new_5PDSim_6scroll_17common_scroll_geo_CVInvolute(((PyTypeObject *)__pyx_ptype_5PDSim_6scroll_17common_scroll_geo_CVInvolute), __pyx_empty_tuple, NULL));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(((PyObject *)__pyx_t_1));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_t_1));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;Inner);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;Inner));
  __pyx_v_self-&gt;Inner = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolute *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">031</span>:         self.Outer = CVInvolute.__new__(CVInvolute)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = ((PyObject *)__pyx_tp_new_5PDSim_6scroll_17common_scroll_geo_CVInvolute(((PyTypeObject *)__pyx_ptype_5PDSim_6scroll_17common_scroll_geo_CVInvolute), __pyx_empty_tuple, NULL));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(((PyObject *)__pyx_t_1));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_t_1));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;Outer);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;Outer));
  __pyx_v_self-&gt;Outer = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolute *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">032</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">033</span>:     def __repr__(self):</pre>
<pre class='cython code score-7 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_11CVInvolutes_3__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_11CVInvolutes_3__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_11CVInvolutes_2__repr__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_11CVInvolutes_2__repr__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_self) {
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__repr__", __pyx_f[0], 33, 0, <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.CVInvolutes.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">034</span>:         s = ''</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_);
  __pyx_v_s = __pyx_kp_s_;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">035</span>:         s += "Outer.involute = {i:s}\n".format(i=involute_index_to_key(self.Outer.involute).decode('ascii'))</pre>
<pre class='cython code score-27 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Outer_involute_i_s, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_involute_index_to_key(__pyx_v_self-&gt;Outer-&gt;involute, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (unlikely(__pyx_t_3 == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "decode");
    <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>
  }
  __pyx_t_4 = __Pyx_decode_bytes(__pyx_t_3, 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeASCII);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_i, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">036</span>:         s += "Outer.phi_0 = {i:g}\n".format(i=self.Outer.phi_0)</pre>
<pre class='cython code score-26 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Outer_phi_0_i_g, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;Outer-&gt;phi_0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_i, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">037</span>:         s += "Outer.phi_max = {i:g}\n".format(i=self.Outer.phi_max)</pre>
<pre class='cython code score-26 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Outer_phi_max_i_g, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;Outer-&gt;phi_max);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_i, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">038</span>:         s += "Outer.phi_min = {i:g}\n".format(i=self.Outer.phi_min)</pre>
<pre class='cython code score-26 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Outer_phi_min_i_g, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;Outer-&gt;phi_min);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_i, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">039</span>:         s += "Inner.involute = {i:s}\n".format(i=involute_index_to_key(self.Inner.involute).decode('ascii'))</pre>
<pre class='cython code score-27 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Inner_involute_i_s, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_involute_index_to_key(__pyx_v_self-&gt;Inner-&gt;involute, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(__pyx_t_1 == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "decode");
    <span class='error_goto'>__PYX_ERR(0, 39, __pyx_L1_error)</span>
  }
  __pyx_t_3 = __Pyx_decode_bytes(__pyx_t_1, 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeASCII);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_i, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">040</span>:         s += "Inner.phi_0 = {i:g}\n".format(i=self.Inner.phi_0)</pre>
<pre class='cython code score-26 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Inner_phi_0_i_g, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;Inner-&gt;phi_0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_i, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">041</span>:         s += "Inner.phi_max = {i:g}\n".format(i=self.Inner.phi_max)</pre>
<pre class='cython code score-26 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Inner_phi_max_i_g, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;Inner-&gt;phi_max);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_i, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">042</span>:         s += "Inner.phi_min = {i:g}\n".format(i=self.Inner.phi_min)</pre>
<pre class='cython code score-26 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Inner_phi_min_i_g, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;Inner-&gt;phi_min);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_i, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 42, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">043</span>:         s += "has_line_1 = {i:g}\n".format(i=self.has_line_1)</pre>
<pre class='cython code score-23 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_has_line_1_i_g, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_self-&gt;has_line_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_i, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">044</span>:         s += "has_line_2 = {i:g}".format(i=self.has_line_2)</pre>
<pre class='cython code score-23 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_has_line_2_i_g, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_self-&gt;has_line_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_i, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 44, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">045</span>:         return s</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_s);
  __pyx_r = __pyx_v_s;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">046</span>: </pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">047</span>: cpdef VdVstruct VdV(double theta, geoVals geo, CVInvolutes inv):</pre>
<pre class='cython code score-52 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7VdV(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_f_5PDSim_6scroll_17common_scroll_geo_VdV(double __pyx_v_theta, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_inv, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_A_i;
  double __pyx_v_A_o;
  double __pyx_v_A_line_1;
  double __pyx_v_A_line_2;
  double __pyx_v_x_1;
  double __pyx_v_x_2;
  double __pyx_v_y_1;
  double __pyx_v_y_2;
  double __pyx_v_dx_1_dphi;
  double __pyx_v_dy_1_dphi;
  double __pyx_v_dx_2_dphi;
  double __pyx_v_dy_2_dphi;
  double __pyx_v_dA_line_1_dtheta;
  double __pyx_v_dA_line_2_dtheta;
  double __pyx_v_dx_1_dtheta;
  double __pyx_v_dy_1_dtheta;
  double __pyx_v_dx_2_dtheta;
  double __pyx_v_dy_2_dtheta;
  double __pyx_v_V;
  double __pyx_v_dA_i_dtheta;
  double __pyx_v_dA_o_dtheta;
  double __pyx_v_dV;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_v_VdV = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("VdV", 0);
  <span class='trace'>__Pyx_TraceCall</span>("VdV", __pyx_f[0], 47, 0, <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.VdV", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_VdV);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7VdV(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_6VdV[] = "VdV(double theta, geoVals geo, CVInvolutes inv) -&gt; VdVstruct\n\n    Evaluate V and dV/dtheta in a generalized manner for a chamber\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7VdV(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_inv = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("VdV (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_inv,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("VdV", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inv)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("VdV", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "VdV") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_inv = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("VdV", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.VdV", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_inv), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_CVInvolutes, 1, "inv", 0))) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_6VdV(__pyx_self, __pyx_v_theta, __pyx_v_geo, __pyx_v_inv);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_6VdV(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_inv) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("VdV", 0);
  <span class='trace'>__Pyx_TraceCall</span>("VdV (wrapper)", __pyx_f[0], 47, 0, <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_5PDSim_6scroll_17common_scroll_geo_VdV(__pyx_v_theta, __pyx_v_geo, __pyx_v_inv, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.VdV", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">048</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">049</span>:     Evaluate V and dV/dtheta in a generalized manner for a chamber</pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">051</span>:     cdef double A_i, A_o, A_line_1 = 0, A_line_2 = 0, x_1, x_2, y_1, y_2, dx_1_dphi=0, dy_1_dphi=0, dx_2_dphi=0, dy_2_dphi=0</pre>
<pre class='cython code score-0 '>  __pyx_v_A_line_1 = 0.0;
  __pyx_v_A_line_2 = 0.0;
  __pyx_v_dx_1_dphi = 0.0;
  __pyx_v_dy_1_dphi = 0.0;
  __pyx_v_dx_2_dphi = 0.0;
  __pyx_v_dy_2_dphi = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">052</span>:     cdef double dA_line_1_dtheta = 0, dA_line_2_dtheta = 0, dx_1_dtheta, dy_1_dtheta, dx_2_dtheta, dy_2_dtheta</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_line_1_dtheta = 0.0;
  __pyx_v_dA_line_2_dtheta = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">053</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>:     ## ------------------------ VOLUME -------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">056</span>:     A_i = 0.5*(Gr(inv.Outer.phi_max, geo, theta, inv.Outer.involute) - Gr(inv.Outer.phi_min, geo, theta, inv.Outer.involute))</pre>
<pre class='cython code score-0 '>  __pyx_v_A_i = (0.5 * (__pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr(__pyx_v_inv-&gt;Outer-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr(__pyx_v_inv-&gt;Outer-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, 0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">057</span>:     if inv.has_line_1:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_inv-&gt;has_line_1 != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">058</span>:         _coords_inv_d_int(inv.Outer.phi_max, geo, theta, inv.Outer.involute, &amp;x_1, &amp;y_1)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(__pyx_v_inv-&gt;Outer-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, (&amp;__pyx_v_x_1), (&amp;__pyx_v_y_1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">059</span>:         _coords_inv_d_int(inv.Inner.phi_max, geo, theta, inv.Inner.involute, &amp;x_2, &amp;y_2)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(__pyx_v_inv-&gt;Inner-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, (&amp;__pyx_v_x_2), (&amp;__pyx_v_y_2));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 59, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>:         A_line_1 = 0.5*(x_1*y_2 - x_2*y_1)</pre>
<pre class='cython code score-0 '>    __pyx_v_A_line_1 = (0.5 * ((__pyx_v_x_1 * __pyx_v_y_2) - (__pyx_v_x_2 * __pyx_v_y_1)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">061</span>:     A_o = 0.5*(Gr(inv.Inner.phi_min, geo, theta, inv.Inner.involute) - Gr(inv.Inner.phi_max, geo, theta, inv.Inner.involute))</pre>
<pre class='cython code score-0 '>  __pyx_v_A_o = (0.5 * (__pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr(__pyx_v_inv-&gt;Inner-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr(__pyx_v_inv-&gt;Inner-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, 0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">062</span>:     if inv.has_line_2:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_inv-&gt;has_line_2 != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">063</span>:         _coords_inv_d_int(inv.Inner.phi_min, geo, theta, inv.Inner.involute, &amp;x_1, &amp;y_1)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(__pyx_v_inv-&gt;Inner-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, (&amp;__pyx_v_x_1), (&amp;__pyx_v_y_1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 63, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">064</span>:         _coords_inv_d_int(inv.Outer.phi_min, geo, theta, inv.Outer.involute, &amp;x_2, &amp;y_2)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(__pyx_v_inv-&gt;Outer-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, (&amp;__pyx_v_x_2), (&amp;__pyx_v_y_2));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">065</span>:         A_line_2 = 0.5*(x_1*y_2 - x_2*y_1)</pre>
<pre class='cython code score-0 '>    __pyx_v_A_line_2 = (0.5 * ((__pyx_v_x_1 * __pyx_v_y_2) - (__pyx_v_x_2 * __pyx_v_y_1)));
</pre><pre class="cython line score-0">&#xA0;<span class="">066</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">067</span>:     V = geo.h*(A_i + A_line_1 + A_o + A_line_2)</pre>
<pre class='cython code score-0 '>  __pyx_v_V = (__pyx_v_geo-&gt;h * (((__pyx_v_A_i + __pyx_v_A_line_1) + __pyx_v_A_o) + __pyx_v_A_line_2));
</pre><pre class="cython line score-0">&#xA0;<span class="">068</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>:     ## ------------------------ DERIVATIVE -------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">071</span>:     dA_i_dtheta = 0.5*(dGr_dphi(inv.Outer.phi_max, geo, theta, inv.Outer.involute)*inv.Outer.dphi_max_dtheta</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_i_dtheta = (0.5 * ((((__pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dphi(__pyx_v_inv-&gt;Outer-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, 0) * __pyx_v_inv-&gt;Outer-&gt;dphi_max_dtheta) + __pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dtheta(__pyx_v_inv-&gt;Outer-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, 0)) - (__pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dphi(__pyx_v_inv-&gt;Outer-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, 0) * __pyx_v_inv-&gt;Outer-&gt;dphi_min_dtheta)) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dtheta(__pyx_v_inv-&gt;Outer-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, 0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">072</span>:                       +dGr_dtheta(inv.Outer.phi_max, geo, theta, inv.Outer.involute)</pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>:                       -dGr_dphi(inv.Outer.phi_min, geo, theta, inv.Outer.involute)*inv.Outer.dphi_min_dtheta</pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>:                       -dGr_dtheta(inv.Outer.phi_min, geo, theta, inv.Outer.involute)</pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>:                       )</pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">077</span>:     if inv.has_line_1:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_inv-&gt;has_line_1 != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">078</span>:         coords_inv_dtheta(inv.Outer.phi_max, geo, theta, inv.Outer.involute, &amp;dx_1_dtheta, &amp;dy_1_dtheta)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv_dtheta(__pyx_v_inv-&gt;Outer-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, (&amp;__pyx_v_dx_1_dtheta), (&amp;__pyx_v_dy_1_dtheta));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">079</span>:         coords_inv_dtheta(inv.Inner.phi_max, geo, theta, inv.Inner.involute, &amp;dx_2_dtheta, &amp;dy_2_dtheta)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv_dtheta(__pyx_v_inv-&gt;Inner-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, (&amp;__pyx_v_dx_2_dtheta), (&amp;__pyx_v_dy_2_dtheta));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">080</span>:         _dcoords_inv_dphi_int(inv.Outer.phi_max, geo, theta, inv.Outer.involute, &amp;dx_1_dphi, &amp;dy_1_dphi)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__dcoords_inv_dphi_int(__pyx_v_inv-&gt;Outer-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, (&amp;__pyx_v_dx_1_dphi), (&amp;__pyx_v_dy_1_dphi));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">081</span>:         dx_1_dtheta += dx_1_dphi*inv.Outer.dphi_max_dtheta</pre>
<pre class='cython code score-0 '>    __pyx_v_dx_1_dtheta = (__pyx_v_dx_1_dtheta + (__pyx_v_dx_1_dphi * __pyx_v_inv-&gt;Outer-&gt;dphi_max_dtheta));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>:         dy_1_dtheta += dy_1_dphi*inv.Outer.dphi_max_dtheta</pre>
<pre class='cython code score-0 '>    __pyx_v_dy_1_dtheta = (__pyx_v_dy_1_dtheta + (__pyx_v_dy_1_dphi * __pyx_v_inv-&gt;Outer-&gt;dphi_max_dtheta));
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">083</span>:         _dcoords_inv_dphi_int(inv.Inner.phi_max, geo, theta, inv.Inner.involute, &amp;dx_2_dphi, &amp;dy_2_dphi)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__dcoords_inv_dphi_int(__pyx_v_inv-&gt;Inner-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, (&amp;__pyx_v_dx_2_dphi), (&amp;__pyx_v_dy_2_dphi));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">084</span>:         dx_2_dtheta += dx_2_dphi*inv.Inner.dphi_max_dtheta</pre>
<pre class='cython code score-0 '>    __pyx_v_dx_2_dtheta = (__pyx_v_dx_2_dtheta + (__pyx_v_dx_2_dphi * __pyx_v_inv-&gt;Inner-&gt;dphi_max_dtheta));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">085</span>:         dy_2_dtheta += dy_2_dphi*inv.Inner.dphi_max_dtheta</pre>
<pre class='cython code score-0 '>    __pyx_v_dy_2_dtheta = (__pyx_v_dy_2_dtheta + (__pyx_v_dy_2_dphi * __pyx_v_inv-&gt;Inner-&gt;dphi_max_dtheta));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>:         dA_line_1_dtheta = 0.5*(x_1*dy_2_dtheta + y_2*dx_1_dtheta - x_2*dy_1_dtheta - y_1*dx_2_dtheta)</pre>
<pre class='cython code score-0 '>    __pyx_v_dA_line_1_dtheta = (0.5 * ((((__pyx_v_x_1 * __pyx_v_dy_2_dtheta) + (__pyx_v_y_2 * __pyx_v_dx_1_dtheta)) - (__pyx_v_x_2 * __pyx_v_dy_1_dtheta)) - (__pyx_v_y_1 * __pyx_v_dx_2_dtheta)));
</pre><pre class="cython line score-0">&#xA0;<span class="">087</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">088</span>:     dA_o_dtheta = 0.5*(dGr_dphi(inv.Inner.phi_min, geo, theta, inv.Inner.involute)*inv.Inner.dphi_min_dtheta</pre>
<pre class='cython code score-0 '>  __pyx_v_dA_o_dtheta = (0.5 * ((((__pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dphi(__pyx_v_inv-&gt;Inner-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, 0) * __pyx_v_inv-&gt;Inner-&gt;dphi_min_dtheta) + __pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dtheta(__pyx_v_inv-&gt;Inner-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, 0)) - (__pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dphi(__pyx_v_inv-&gt;Inner-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, 0) * __pyx_v_inv-&gt;Inner-&gt;dphi_max_dtheta)) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dtheta(__pyx_v_inv-&gt;Inner-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, 0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">089</span>:                        +dGr_dtheta(inv.Inner.phi_min, geo, theta, inv.Inner.involute)</pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>:                        -dGr_dphi(inv.Inner.phi_max, geo, theta, inv.Inner.involute)*inv.Inner.dphi_max_dtheta</pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>:                        -dGr_dtheta(inv.Inner.phi_max, geo, theta, inv.Inner.involute)</pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>:                        )</pre>
<pre class="cython line score-0">&#xA0;<span class="">093</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">094</span>:     if inv.has_line_2:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_inv-&gt;has_line_2 != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">095</span>:         coords_inv_dtheta(inv.Inner.phi_min, geo, theta, inv.Inner.involute, &amp;dx_1_dtheta, &amp;dy_1_dtheta)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv_dtheta(__pyx_v_inv-&gt;Inner-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, (&amp;__pyx_v_dx_1_dtheta), (&amp;__pyx_v_dy_1_dtheta));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">096</span>:         coords_inv_dtheta(inv.Outer.phi_min, geo, theta, inv.Outer.involute, &amp;dx_2_dtheta, &amp;dy_2_dtheta)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv_dtheta(__pyx_v_inv-&gt;Outer-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, (&amp;__pyx_v_dx_2_dtheta), (&amp;__pyx_v_dy_2_dtheta));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">097</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">098</span>:         _dcoords_inv_dphi_int(inv.Inner.phi_min, geo, theta, inv.Inner.involute, &amp;dx_1_dphi, &amp;dy_1_dphi)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__dcoords_inv_dphi_int(__pyx_v_inv-&gt;Inner-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, (&amp;__pyx_v_dx_1_dphi), (&amp;__pyx_v_dy_1_dphi));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 98, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">099</span>:         dx_1_dtheta += dx_1_dphi*inv.Inner.dphi_min_dtheta</pre>
<pre class='cython code score-0 '>    __pyx_v_dx_1_dtheta = (__pyx_v_dx_1_dtheta + (__pyx_v_dx_1_dphi * __pyx_v_inv-&gt;Inner-&gt;dphi_min_dtheta));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">100</span>:         dy_1_dtheta += dy_1_dphi*inv.Inner.dphi_min_dtheta</pre>
<pre class='cython code score-0 '>    __pyx_v_dy_1_dtheta = (__pyx_v_dy_1_dtheta + (__pyx_v_dy_1_dphi * __pyx_v_inv-&gt;Inner-&gt;dphi_min_dtheta));
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">101</span>:         _dcoords_inv_dphi_int(inv.Outer.phi_min, geo, theta, inv.Outer.involute, &amp;dx_2_dphi, &amp;dy_2_dphi)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__dcoords_inv_dphi_int(__pyx_v_inv-&gt;Outer-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, (&amp;__pyx_v_dx_2_dphi), (&amp;__pyx_v_dy_2_dphi));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">102</span>:         dx_2_dtheta += dx_2_dphi*inv.Outer.dphi_min_dtheta</pre>
<pre class='cython code score-0 '>    __pyx_v_dx_2_dtheta = (__pyx_v_dx_2_dtheta + (__pyx_v_dx_2_dphi * __pyx_v_inv-&gt;Outer-&gt;dphi_min_dtheta));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">103</span>:         dy_2_dtheta += dy_2_dphi*inv.Outer.dphi_min_dtheta</pre>
<pre class='cython code score-0 '>    __pyx_v_dy_2_dtheta = (__pyx_v_dy_2_dtheta + (__pyx_v_dy_2_dphi * __pyx_v_inv-&gt;Outer-&gt;dphi_min_dtheta));
</pre><pre class="cython line score-0">&#xA0;<span class="">104</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">105</span>:         dA_line_2_dtheta = 0.5*(x_1*dy_2_dtheta + y_2*dx_1_dtheta - x_2*dy_1_dtheta - y_1*dx_2_dtheta)</pre>
<pre class='cython code score-0 '>    __pyx_v_dA_line_2_dtheta = (0.5 * ((((__pyx_v_x_1 * __pyx_v_dy_2_dtheta) + (__pyx_v_y_2 * __pyx_v_dx_1_dtheta)) - (__pyx_v_x_2 * __pyx_v_dy_1_dtheta)) - (__pyx_v_y_1 * __pyx_v_dx_2_dtheta)));
</pre><pre class="cython line score-0">&#xA0;<span class="">106</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">107</span>:     dV = geo.h*(dA_i_dtheta + dA_line_1_dtheta + dA_o_dtheta + dA_line_2_dtheta)</pre>
<pre class='cython code score-0 '>  __pyx_v_dV = (__pyx_v_geo-&gt;h * (((__pyx_v_dA_i_dtheta + __pyx_v_dA_line_1_dtheta) + __pyx_v_dA_o_dtheta) + __pyx_v_dA_line_2_dtheta));
</pre><pre class="cython line score-0">&#xA0;<span class="">108</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">109</span>:     cdef VdVstruct VdV = VdVstruct.__new__(VdVstruct)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((PyObject *)__pyx_tp_new_5PDSim_6scroll_17common_scroll_geo_VdVstruct(((PyTypeObject *)__pyx_ptype_5PDSim_6scroll_17common_scroll_geo_VdVstruct), __pyx_empty_tuple, NULL));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(((PyObject *)__pyx_t_2));
  __pyx_v_VdV = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_VdVstruct *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">110</span>:     VdV.V = V</pre>
<pre class='cython code score-0 '>  __pyx_v_VdV-&gt;V = __pyx_v_V;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">111</span>:     VdV.dV = dV</pre>
<pre class='cython code score-0 '>  __pyx_v_VdV-&gt;dV = __pyx_v_dV;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">112</span>:     return VdV</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_VdV));
  __pyx_r = __pyx_v_VdV;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">113</span>: </pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>: cpdef dict forces(double theta, geoVals geo, CVInvolutes inv, double A):</pre>
<pre class='cython code score-69 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_9forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo_forces(double __pyx_v_theta, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_inv, double __pyx_v_A, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_xA_line_1;
  double __pyx_v_xA_line_2;
  double __pyx_v_yA_line_1;
  double __pyx_v_yA_line_2;
  double __pyx_v_x_1;
  double __pyx_v_x_2;
  double __pyx_v_y_1;
  double __pyx_v_y_2;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolute *__pyx_v_orbiting_scroll_involute = 0;
  double __pyx_v_xA_outer;
  double __pyx_v_yA_outer;
  double __pyx_v_xA_inner;
  double __pyx_v_yA_inner;
  double __pyx_v_cx;
  double __pyx_v_cy;
  double __pyx_v_fx_p;
  double __pyx_v_fy_p;
  double __pyx_v_M_O_p;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("forces", 0);
  <span class='trace'>__Pyx_TraceCall</span>("forces", __pyx_f[0], 114, 0, <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_orbiting_scroll_involute);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_9forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_8forces[] = "forces(double theta, geoVals geo, CVInvolutes inv, double A) -&gt; dict\n\n    Evaluate the force terms for a control volume\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_9forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_theta;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_inv = 0;
  double __pyx_v_A;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("forces (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_theta,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_inv,&amp;__pyx_n_s_A,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("forces", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inv)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("forces", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_A)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("forces", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "forces") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_inv = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *)values[2]);
    __pyx_v_A = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_A == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("forces", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_inv), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_CVInvolutes, 1, "inv", 0))) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_8forces(__pyx_self, __pyx_v_theta, __pyx_v_geo, __pyx_v_inv, __pyx_v_A);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_8forces(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_theta, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolutes *__pyx_v_inv, double __pyx_v_A) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("forces", 0);
  <span class='trace'>__Pyx_TraceCall</span>("forces (wrapper)", __pyx_f[0], 114, 0, <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_forces(__pyx_v_theta, __pyx_v_geo, __pyx_v_inv, __pyx_v_A, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">115</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">116</span>:     Evaluate the force terms for a control volume</pre>
<pre class="cython line score-0">&#xA0;<span class="">117</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:     cdef double xA_line_1 = 0, xA_line_2 = 0, yA_line_1 = 0, yA_line_2 = 0,</pre>
<pre class='cython code score-0 '>  __pyx_v_xA_line_1 = 0.0;
  __pyx_v_xA_line_2 = 0.0;
  __pyx_v_yA_line_1 = 0.0;
  __pyx_v_yA_line_2 = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>:     cdef double x_1 = 0, x_2 = 0, y_1 = 0, y_2 = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_x_1 = 0.0;
  __pyx_v_x_2 = 0.0;
  __pyx_v_y_1 = 0.0;
  __pyx_v_y_2 = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">120</span>:     cdef CVInvolute orbiting_scroll_involute</pre>
<pre class="cython line score-0">&#xA0;<span class="">121</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">122</span>:     ## ------------------------ FORCE CENTROID -------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">123</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">124</span>:     xA_outer = fxA(inv.Outer.phi_max, geo, theta, inv.Outer.involute) - fxA(inv.Outer.phi_min, geo, theta, inv.Outer.involute)</pre>
<pre class='cython code score-0 '>  __pyx_v_xA_outer = (__pyx_f_5PDSim_6scroll_17common_scroll_geo_fxA(__pyx_v_inv-&gt;Outer-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_fxA(__pyx_v_inv-&gt;Outer-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">125</span>:     yA_outer = fyA(inv.Outer.phi_max, geo, theta, inv.Outer.involute) - fyA(inv.Outer.phi_min, geo, theta, inv.Outer.involute)</pre>
<pre class='cython code score-0 '>  __pyx_v_yA_outer = (__pyx_f_5PDSim_6scroll_17common_scroll_geo_fyA(__pyx_v_inv-&gt;Outer-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_fyA(__pyx_v_inv-&gt;Outer-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>:     if inv.has_line_1:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_inv-&gt;has_line_1 != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:         _coords_inv_d_int(inv.Outer.phi_max, geo, theta, inv.Outer.involute, &amp;x_1, &amp;y_1)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(__pyx_v_inv-&gt;Outer-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, (&amp;__pyx_v_x_1), (&amp;__pyx_v_y_1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:         _coords_inv_d_int(inv.Inner.phi_max, geo, theta, inv.Inner.involute, &amp;x_2, &amp;y_2)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(__pyx_v_inv-&gt;Inner-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, (&amp;__pyx_v_x_2), (&amp;__pyx_v_y_2));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>:         xA_line_1 = -(y_1 - y_2)*(x_1**2 + x_1*x_2 + x_2**2)/6</pre>
<pre class='cython code score-0 '>    __pyx_v_xA_line_1 = (((-(__pyx_v_y_1 - __pyx_v_y_2)) * ((pow(__pyx_v_x_1, 2.0) + (__pyx_v_x_1 * __pyx_v_x_2)) + pow(__pyx_v_x_2, 2.0))) / 6.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">130</span>:         yA_line_1 = -(y_1 - y_2)*(2*x_1*y_1 + x_1*y_2 + x_2*y_1 + 2*x_2*y_2)/6</pre>
<pre class='cython code score-0 '>    __pyx_v_yA_line_1 = (((-(__pyx_v_y_1 - __pyx_v_y_2)) * (((((2.0 * __pyx_v_x_1) * __pyx_v_y_1) + (__pyx_v_x_1 * __pyx_v_y_2)) + (__pyx_v_x_2 * __pyx_v_y_1)) + ((2.0 * __pyx_v_x_2) * __pyx_v_y_2))) / 6.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>:     xA_inner = fxA(inv.Inner.phi_min, geo, theta, inv.Inner.involute) - fxA(inv.Inner.phi_max, geo, theta, inv.Inner.involute)</pre>
<pre class='cython code score-0 '>  __pyx_v_xA_inner = (__pyx_f_5PDSim_6scroll_17common_scroll_geo_fxA(__pyx_v_inv-&gt;Inner-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_fxA(__pyx_v_inv-&gt;Inner-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">132</span>:     yA_inner = fyA(inv.Inner.phi_min, geo, theta, inv.Inner.involute) - fyA(inv.Inner.phi_max, geo, theta, inv.Inner.involute)</pre>
<pre class='cython code score-0 '>  __pyx_v_yA_inner = (__pyx_f_5PDSim_6scroll_17common_scroll_geo_fyA(__pyx_v_inv-&gt;Inner-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_fyA(__pyx_v_inv-&gt;Inner-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>:     if inv.has_line_2:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_inv-&gt;has_line_2 != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">134</span>:         _coords_inv_d_int(inv.Inner.phi_min, geo, theta, inv.Inner.involute, &amp;x_1, &amp;y_1)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(__pyx_v_inv-&gt;Inner-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Inner-&gt;involute, (&amp;__pyx_v_x_1), (&amp;__pyx_v_y_1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:         _coords_inv_d_int(inv.Outer.phi_min, geo, theta, inv.Outer.involute, &amp;x_2, &amp;y_2)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(__pyx_v_inv-&gt;Outer-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv-&gt;Outer-&gt;involute, (&amp;__pyx_v_x_2), (&amp;__pyx_v_y_2));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">136</span>:         xA_line_2 = -(y_1 - y_2)*(x_1**2 + x_1*x_2 + x_2**2)/6</pre>
<pre class='cython code score-0 '>    __pyx_v_xA_line_2 = (((-(__pyx_v_y_1 - __pyx_v_y_2)) * ((pow(__pyx_v_x_1, 2.0) + (__pyx_v_x_1 * __pyx_v_x_2)) + pow(__pyx_v_x_2, 2.0))) / 6.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">137</span>:         yA_line_2 = -(y_1 - y_2)*(2*x_1*y_1 + x_1*y_2 + x_2*y_1 + 2*x_2*y_2)/6</pre>
<pre class='cython code score-0 '>    __pyx_v_yA_line_2 = (((-(__pyx_v_y_1 - __pyx_v_y_2)) * (((((2.0 * __pyx_v_x_1) * __pyx_v_y_1) + (__pyx_v_x_1 * __pyx_v_y_2)) + (__pyx_v_x_2 * __pyx_v_y_1)) + ((2.0 * __pyx_v_x_2) * __pyx_v_y_2))) / 6.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">138</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">139</span>:     cx = (xA_inner + xA_line_1 + xA_outer + xA_line_2)/A</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = (((__pyx_v_xA_inner + __pyx_v_xA_line_1) + __pyx_v_xA_outer) + __pyx_v_xA_line_2);
  if (unlikely(__pyx_v_A == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L1_error)</span>
  }
  __pyx_v_cx = (__pyx_t_3 / __pyx_v_A);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">140</span>:     cy = (yA_inner + yA_line_1 + yA_outer + yA_line_2)/A</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = (((__pyx_v_yA_inner + __pyx_v_yA_line_1) + __pyx_v_yA_outer) + __pyx_v_yA_line_2);
  if (unlikely(__pyx_v_A == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>
  }
  __pyx_v_cy = (__pyx_t_3 / __pyx_v_A);
</pre><pre class="cython line score-0">&#xA0;<span class="">141</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>:     # The forces we want here are the forces on the orbiting scroll, only one of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">143</span>:     # involutes of the control volume (Inner or Outer) can be for the orbiting scroll.</pre>
<pre class="cython line score-0">&#xA0;<span class="">144</span>:     # Find it, and get a reference to it. The force terms are calculated based on the normal</pre>
<pre class="cython line score-0">&#xA0;<span class="">145</span>:     # vector pointing TOWARDS the scroll wrap, with limits of integration of phi_min to phi_max,</pre>
<pre class="cython line score-0">&#xA0;<span class="">146</span>:     # with phi_min &lt; phi_max.  So this is always the right direction for the orbiting scroll.</pre>
<pre class="cython line score-0">&#xA0;<span class="">147</span>:     #</pre>
<pre class="cython line score-0">&#xA0;<span class="">148</span>:     # inv.Outer.involute can be one of INVOLUTE_FI OR INVOLUTE_OI.  If it is INVOLUTE_FI, that means</pre>
<pre class="cython line score-0">&#xA0;<span class="">149</span>:     # that inv.Inner.involute MUST be INVOLUTE_OO. In either case, the normal vector pointing TOWARDS</pre>
<pre class="cython line score-0">&#xA0;<span class="">150</span>:     # the scroll wrap is pointing in the correct direction</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:     if inv.Outer.involute == INVOLUTE_OI:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_inv-&gt;Outer-&gt;involute == __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">152</span>:         orbiting_scroll_involute = inv.Outer</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = ((PyObject *)__pyx_v_inv-&gt;Outer);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_v_orbiting_scroll_involute = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolute *)__pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">153</span>:     else:</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">154</span>:         orbiting_scroll_involute = inv.Inner</pre>
<pre class='cython code score-1 '>  /*else*/ {
    __pyx_t_2 = ((PyObject *)__pyx_v_inv-&gt;Inner);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_v_orbiting_scroll_involute = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_CVInvolute *)__pyx_t_2);
    __pyx_t_2 = 0;
  }
  __pyx_L5:;
</pre><pre class="cython line score-0">&#xA0;<span class="">155</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">156</span>:     # Calculate the force terms divided by the pressure acting on the orbiting scroll</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">157</span>:     fx_p = (fFx_p(orbiting_scroll_involute.phi_max, geo, theta, orbiting_scroll_involute.involute) - fFx_p(orbiting_scroll_involute.phi_min, geo, theta, orbiting_scroll_involute.involute))</pre>
<pre class='cython code score-0 '>  __pyx_v_fx_p = (__pyx_f_5PDSim_6scroll_17common_scroll_geo_fFx_p(__pyx_v_orbiting_scroll_involute-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_orbiting_scroll_involute-&gt;involute, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_fFx_p(__pyx_v_orbiting_scroll_involute-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_orbiting_scroll_involute-&gt;involute, 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">158</span>:     fy_p = (fFy_p(orbiting_scroll_involute.phi_max, geo, theta, orbiting_scroll_involute.involute) - fFy_p(orbiting_scroll_involute.phi_min, geo, theta, orbiting_scroll_involute.involute))</pre>
<pre class='cython code score-0 '>  __pyx_v_fy_p = (__pyx_f_5PDSim_6scroll_17common_scroll_geo_fFy_p(__pyx_v_orbiting_scroll_involute-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_orbiting_scroll_involute-&gt;involute, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_fFy_p(__pyx_v_orbiting_scroll_involute-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_orbiting_scroll_involute-&gt;involute, 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">159</span>:     M_O_p = (fMO_p(orbiting_scroll_involute.phi_max, geo, theta, orbiting_scroll_involute.involute) - fMO_p(orbiting_scroll_involute.phi_min, geo, theta, orbiting_scroll_involute.involute))</pre>
<pre class='cython code score-0 '>  __pyx_v_M_O_p = (__pyx_f_5PDSim_6scroll_17common_scroll_geo_fMO_p(__pyx_v_orbiting_scroll_involute-&gt;phi_max, __pyx_v_geo, __pyx_v_theta, __pyx_v_orbiting_scroll_involute-&gt;involute, 0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_fMO_p(__pyx_v_orbiting_scroll_involute-&gt;phi_min, __pyx_v_geo, __pyx_v_theta, __pyx_v_orbiting_scroll_involute-&gt;involute, 0));
</pre><pre class="cython line score-0">&#xA0;<span class="">160</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">161</span>:     return dict(cx = cx,</pre>
<pre class='cython code score-14 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_cx);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_cx, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>:                 cy = cy,</pre>
<pre class='cython code score-11 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_cy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_cy, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>:                 fz_p = A,</pre>
<pre class='cython code score-11 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_A);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_fz_p, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:                 fx_p = fx_p,</pre>
<pre class='cython code score-11 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_fx_p);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_fx_p, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">165</span>:                 fy_p = fy_p,</pre>
<pre class='cython code score-11 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_fy_p);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 165, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_fy_p, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:                 M_O_p = M_O_p</pre>
<pre class='cython code score-11 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_M_O_p);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 166, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_M_O_p, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">167</span>:                 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>: </pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">169</span>: cpdef double fxA(double phi, geoVals geo, double theta, involute_index inv):</pre>
<pre class='cython code score-70 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_11fxA(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_5PDSim_6scroll_17common_scroll_geo_fxA(double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_Theta;
  double __pyx_v_r_b;
  double __pyx_v_r_o;
  double __pyx_v_phi_0;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fxA", 0);
  <span class='trace'>__Pyx_TraceCall</span>("fxA", __pyx_f[0], 169, 0, <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.fxA", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_11fxA(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_10fxA[] = "fxA(double phi, geoVals geo, double theta, involute_index inv) -&gt; double\n\n    The anti-derivative for the x-coordinate of the centroid\n    \n    Parameters\n    ----------\n    phi : float\n        The involute angle\n    geo : geoVals\n        The structure with the geometry obtained from get_geo()\n    theta : float\n        The crank angle, between 0 and 2*pi\n    inv : involute_index\n        The key for the involute to be considered\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_11fxA(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_phi;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fxA (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_phi,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_inv,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fxA", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fxA", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inv)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fxA", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fxA") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_phi = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_phi == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L3_error)</span>
    __pyx_v_inv = ((enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index)__Pyx_PyInt_As_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index(values[3]));<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 169, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fxA", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.fxA", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_10fxA(__pyx_self, __pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_10fxA(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fxA", 0);
  <span class='trace'>__Pyx_TraceCall</span>("fxA (wrapper)", __pyx_f[0], 169, 0, <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_fxA(__pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.fxA", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">170</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>:     The anti-derivative for the x-coordinate of the centroid</pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">173</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">174</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">175</span>:     phi : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">176</span>:         The involute angle</pre>
<pre class="cython line score-0">&#xA0;<span class="">177</span>:     geo : geoVals</pre>
<pre class="cython line score-0">&#xA0;<span class="">178</span>:         The structure with the geometry obtained from get_geo()</pre>
<pre class="cython line score-0">&#xA0;<span class="">179</span>:     theta : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">180</span>:         The crank angle, between 0 and 2*pi</pre>
<pre class="cython line score-0">&#xA0;<span class="">181</span>:     inv : involute_index</pre>
<pre class="cython line score-0">&#xA0;<span class="">182</span>:         The key for the involute to be considered</pre>
<pre class="cython line score-0">&#xA0;<span class="">183</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">184</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">185</span>:     cdef double Theta = geo.phi_fie - theta - pi/2, r_b = geo.rb, r_o = geo.ro</pre>
<pre class='cython code score-0 '>  __pyx_v_Theta = ((__pyx_v_geo-&gt;phi_fie - __pyx_v_theta) - (((double)M_PI) / 2.0));
  __pyx_t_1 = __pyx_v_geo-&gt;rb;
  __pyx_v_r_b = __pyx_t_1;
  __pyx_t_1 = __pyx_v_geo-&gt;ro;
  __pyx_v_r_o = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">186</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">187</span>:     if inv == INVOLUTE_FO or inv == INVOLUTE_FI:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_inv) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO:
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">188</span>:         if inv == INVOLUTE_FO:</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_inv == __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO) != 0);
    if (__pyx_t_2) {
/* … */
      goto __pyx_L3;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>:             phi_0 = geo.phi_fo0</pre>
<pre class='cython code score-0 '>      __pyx_t_1 = __pyx_v_geo-&gt;phi_fo0;
      __pyx_v_phi_0 = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">190</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">191</span>:             phi_0 = geo.phi_fi0</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_1 = __pyx_v_geo-&gt;phi_fi0;
      __pyx_v_phi_0 = __pyx_t_1;
    }
    __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">192</span>:         # return r_b**3*(-3*(phi - phi_0)*((phi - phi_0)**2 - 6)*cos(phi) + (phi - phi_0)*((phi - phi_0)**2 - 3)*cos(phi)**3 + 3*(2*(phi - phi_0)**2 - 5)*sin(phi) + (3*(phi - phi_0)**2 - 1)*sin(phi)**3)/6</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">193</span>:         return r_b**3*((-3*phi + 3*phi_0)*((phi - phi_0)**2 - 6)*cos(phi) + (phi - phi_0)*((phi - phi_0)**2 - 3)*cos(phi)**3 + (3*(phi - phi_0)**2 - 1)*sin(phi)**3 + (6*(phi - phi_0)**2 - 15)*sin(phi))/6</pre>
<pre class='cython code score-0 '>    __pyx_r = ((pow(__pyx_v_r_b, 3.0) * (((((((-3.0 * __pyx_v_phi) + (3.0 * __pyx_v_phi_0)) * (pow((__pyx_v_phi - __pyx_v_phi_0), 2.0) - 6.0)) * cos(__pyx_v_phi)) + (((__pyx_v_phi - __pyx_v_phi_0) * (pow((__pyx_v_phi - __pyx_v_phi_0), 2.0) - 3.0)) * pow(cos(__pyx_v_phi), 3.0))) + (((3.0 * pow((__pyx_v_phi - __pyx_v_phi_0), 2.0)) - 1.0) * pow(sin(__pyx_v_phi), 3.0))) + (((6.0 * pow((__pyx_v_phi - __pyx_v_phi_0), 2.0)) - 15.0) * sin(__pyx_v_phi)))) / 6.0);
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">194</span>:     elif inv == INVOLUTE_OO or inv == INVOLUTE_OI:</pre>
<pre class='cython code score-0 '>    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI:
/* … */
    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">195</span>:         if inv == INVOLUTE_OO:</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_inv == __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO) != 0);
    if (__pyx_t_2) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>:             phi_0 = geo.phi_oo0</pre>
<pre class='cython code score-0 '>      __pyx_t_1 = __pyx_v_geo-&gt;phi_oo0;
      __pyx_v_phi_0 = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">197</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>:             phi_0 = geo.phi_oi0</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_1 = __pyx_v_geo-&gt;phi_oi0;
      __pyx_v_phi_0 = __pyx_t_1;
    }
    __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">199</span>:         return -r_b*(-phi*r_b*r_o*(phi**2 - 3*phi*phi_0 + 3*phi_0**2 + 3)*cos(Theta)/3</pre>
<pre class="cython line score-0">&#xA0;<span class="">200</span>:                 + r_b**2*(phi - phi_0)*((phi - phi_0)**2 - 3)*cos(phi)**3/3</pre>
<pre class="cython line score-0">&#xA0;<span class="">201</span>:                 + r_b**2*(3*(phi - phi_0)**2 - 1)*sin(phi)**3/3 + 2*r_b*r_o*(phi - phi_0)*cos(Theta)*cos(phi)**2</pre>
<pre class="cython line score-0">&#xA0;<span class="">202</span>:                 - (phi - phi_0)*(r_b**2*((phi - phi_0)**2 - 6) + r_o**2*cos(Theta)**2)*cos(phi)</pre>
<pre class="cython line score-0">&#xA0;<span class="">203</span>:                 + (r_b**2*(2*(phi - phi_0)**2 - 5) + r_b*r_o*((phi - phi_0)**2 - 1)*cos(Theta)*cos(phi) + r_o**2*cos(Theta)**2)*sin(phi)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">204</span>:                 )/2</pre>
<pre class='cython code score-0 '>    __pyx_r = (((-__pyx_v_r_b) * (((((((((((-__pyx_v_phi) * __pyx_v_r_b) * __pyx_v_r_o) * (((pow(__pyx_v_phi, 2.0) - ((3.0 * __pyx_v_phi) * __pyx_v_phi_0)) + (3.0 * pow(__pyx_v_phi_0, 2.0))) + 3.0)) * cos(__pyx_v_Theta)) / 3.0) + ((((pow(__pyx_v_r_b, 2.0) * (__pyx_v_phi - __pyx_v_phi_0)) * (pow((__pyx_v_phi - __pyx_v_phi_0), 2.0) - 3.0)) * pow(cos(__pyx_v_phi), 3.0)) / 3.0)) + (((pow(__pyx_v_r_b, 2.0) * ((3.0 * pow((__pyx_v_phi - __pyx_v_phi_0), 2.0)) - 1.0)) * pow(sin(__pyx_v_phi), 3.0)) / 3.0)) + (((((2.0 * __pyx_v_r_b) * __pyx_v_r_o) * (__pyx_v_phi - __pyx_v_phi_0)) * cos(__pyx_v_Theta)) * pow(cos(__pyx_v_phi), 2.0))) - (((__pyx_v_phi - __pyx_v_phi_0) * ((pow(__pyx_v_r_b, 2.0) * (pow((__pyx_v_phi - __pyx_v_phi_0), 2.0) - 6.0)) + (pow(__pyx_v_r_o, 2.0) * pow(cos(__pyx_v_Theta), 2.0)))) * cos(__pyx_v_phi))) + ((((pow(__pyx_v_r_b, 2.0) * ((2.0 * pow((__pyx_v_phi - __pyx_v_phi_0), 2.0)) - 5.0)) + ((((__pyx_v_r_b * __pyx_v_r_o) * (pow((__pyx_v_phi - __pyx_v_phi_0), 2.0) - 1.0)) * cos(__pyx_v_Theta)) * cos(__pyx_v_phi))) + (pow(__pyx_v_r_o, 2.0) * pow(cos(__pyx_v_Theta), 2.0))) * sin(__pyx_v_phi)))) / 2.0);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">205</span>:     else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>:         raise ValueError("Involute is invalid")</pre>
<pre class='cython code score-10 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L1_error)</span>
    break;
  }
/* … */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Involute_is_invalid);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
</pre><pre class="cython line score-0">&#xA0;<span class="">207</span>: </pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>: cpdef double fyA(double phi, geoVals geo, double theta, involute_index inv):</pre>
<pre class='cython code score-70 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_13fyA(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_5PDSim_6scroll_17common_scroll_geo_fyA(double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_Theta;
  double __pyx_v_r_b;
  double __pyx_v_r_o;
  double __pyx_v_phi_0;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fyA", 0);
  <span class='trace'>__Pyx_TraceCall</span>("fyA", __pyx_f[0], 208, 0, <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.fyA", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_13fyA(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_12fyA[] = "fyA(double phi, geoVals geo, double theta, involute_index inv) -&gt; double\n\n    The anti-derivative for the y-coordinate of the centroid\n    \n    Parameters\n    ----------\n    phi : float\n        The involute angle\n    geo : geoVals\n        The structure with the geometry obtained from get_geo()\n    theta : float\n        The crank angle, between 0 and 2*pi\n    inv : involute_index\n        The key for the involute to be considered\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_13fyA(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_phi;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fyA (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_phi,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_inv,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fyA", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fyA", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inv)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fyA", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fyA") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_phi = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_phi == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
    __pyx_v_inv = ((enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index)__Pyx_PyInt_As_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index(values[3]));<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 208, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fyA", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.fyA", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_12fyA(__pyx_self, __pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_12fyA(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fyA", 0);
  <span class='trace'>__Pyx_TraceCall</span>("fyA (wrapper)", __pyx_f[0], 208, 0, <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_fyA(__pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.fyA", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">209</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">210</span>:     The anti-derivative for the y-coordinate of the centroid</pre>
<pre class="cython line score-0">&#xA0;<span class="">211</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">212</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">213</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">214</span>:     phi : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">215</span>:         The involute angle</pre>
<pre class="cython line score-0">&#xA0;<span class="">216</span>:     geo : geoVals</pre>
<pre class="cython line score-0">&#xA0;<span class="">217</span>:         The structure with the geometry obtained from get_geo()</pre>
<pre class="cython line score-0">&#xA0;<span class="">218</span>:     theta : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">219</span>:         The crank angle, between 0 and 2*pi</pre>
<pre class="cython line score-0">&#xA0;<span class="">220</span>:     inv : involute_index</pre>
<pre class="cython line score-0">&#xA0;<span class="">221</span>:         The key for the involute to be considered</pre>
<pre class="cython line score-0">&#xA0;<span class="">222</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">223</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:     cdef double Theta = geo.phi_fie - theta - pi/2, r_b = geo.rb, r_o = geo.ro</pre>
<pre class='cython code score-0 '>  __pyx_v_Theta = ((__pyx_v_geo-&gt;phi_fie - __pyx_v_theta) - (((double)M_PI) / 2.0));
  __pyx_t_1 = __pyx_v_geo-&gt;rb;
  __pyx_v_r_b = __pyx_t_1;
  __pyx_t_1 = __pyx_v_geo-&gt;ro;
  __pyx_v_r_o = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">225</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:     if inv == INVOLUTE_FI:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_inv) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">227</span>:         phi_0 = geo.phi_fi0</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_geo-&gt;phi_fi0;
    __pyx_v_phi_0 = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">228</span>:         return r_b**3*(-(phi - phi_0)*((phi - phi_0)**2 - 3)*sin(phi)**3 + 6*(phi - phi_0)*sin(phi)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:                        - 3*(2*(phi - phi_0)**2 - 3)*cos(phi) + (3*(phi - phi_0)**2 - 1)*cos(phi)**3)/3</pre>
<pre class='cython code score-0 '>    __pyx_r = ((pow(__pyx_v_r_b, 3.0) * ((((((-(__pyx_v_phi - __pyx_v_phi_0)) * (pow((__pyx_v_phi - __pyx_v_phi_0), 2.0) - 3.0)) * pow(sin(__pyx_v_phi), 3.0)) + ((6.0 * (__pyx_v_phi - __pyx_v_phi_0)) * sin(__pyx_v_phi))) - ((3.0 * ((2.0 * pow((__pyx_v_phi - __pyx_v_phi_0), 2.0)) - 3.0)) * cos(__pyx_v_phi))) + (((3.0 * pow((__pyx_v_phi - __pyx_v_phi_0), 2.0)) - 1.0) * pow(cos(__pyx_v_phi), 3.0)))) / 3.0);
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:     elif inv == INVOLUTE_FO:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">231</span>:         phi_0 = geo.phi_fo0</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_geo-&gt;phi_fo0;
    __pyx_v_phi_0 = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">232</span>:         return r_b**3*(-(phi - phi_0)*((phi - phi_0)**2 - 3)*sin(phi)**3 + 6*(phi - phi_0)*sin(phi)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>:                       - 3*(2*(phi - phi_0)**2 - 3)*cos(phi) + (3*(phi - phi_0)**2 - 1)*cos(phi)**3)/3</pre>
<pre class='cython code score-0 '>    __pyx_r = ((pow(__pyx_v_r_b, 3.0) * ((((((-(__pyx_v_phi - __pyx_v_phi_0)) * (pow((__pyx_v_phi - __pyx_v_phi_0), 2.0) - 3.0)) * pow(sin(__pyx_v_phi), 3.0)) + ((6.0 * (__pyx_v_phi - __pyx_v_phi_0)) * sin(__pyx_v_phi))) - ((3.0 * ((2.0 * pow((__pyx_v_phi - __pyx_v_phi_0), 2.0)) - 3.0)) * cos(__pyx_v_phi))) + (((3.0 * pow((__pyx_v_phi - __pyx_v_phi_0), 2.0)) - 1.0) * pow(cos(__pyx_v_phi), 3.0)))) / 3.0);
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:     elif inv == INVOLUTE_OO:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:         phi_0 = geo.phi_oo0</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_geo-&gt;phi_oo0;
    __pyx_v_phi_0 = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:     elif inv == INVOLUTE_OI:</pre>
<pre class='cython code score-0 '>    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>:         phi_0 = geo.phi_oi0</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_geo-&gt;phi_oi0;
    __pyx_v_phi_0 = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">238</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>:         raise ValueError("Involute is invalid")</pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 239, __pyx_L1_error)</span>
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">240</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>:     return -r_b*(-r_b**2*(phi - phi_0)*((phi - phi_0)**2 - 3)*sin(phi)**3/3 - r_b**2*(2*(phi - phi_0)**2 - 3)*cos(phi)</pre>
<pre class='cython code score-0 '>  __pyx_r = ((-__pyx_v_r_b) * ((((((((((-pow(__pyx_v_r_b, 2.0)) * (__pyx_v_phi - __pyx_v_phi_0)) * (pow((__pyx_v_phi - __pyx_v_phi_0), 2.0) - 3.0)) * pow(sin(__pyx_v_phi), 3.0)) / 3.0) - ((pow(__pyx_v_r_b, 2.0) * ((2.0 * pow((__pyx_v_phi - __pyx_v_phi_0), 2.0)) - 3.0)) * cos(__pyx_v_phi))) + (((pow(__pyx_v_r_b, 2.0) * ((3.0 * pow((__pyx_v_phi - __pyx_v_phi_0), 2.0)) - 1.0)) * pow(cos(__pyx_v_phi), 3.0)) / 3.0)) - (((((__pyx_v_r_b * __pyx_v_r_o) * ((__pyx_v_phi - __pyx_v_phi_0) - 1.0)) * ((__pyx_v_phi - __pyx_v_phi_0) + 1.0)) * cos(__pyx_v_Theta)) / 2.0)) + (((__pyx_v_r_b * ((((4.0 * __pyx_v_r_b) * (__pyx_v_phi - __pyx_v_phi_0)) + (((2.0 * __pyx_v_r_o) * (__pyx_v_phi - __pyx_v_phi_0)) * cos((__pyx_v_Theta + __pyx_v_phi)))) + ((__pyx_v_r_o * (pow((__pyx_v_phi - __pyx_v_phi_0), 2.0) - 1.0)) * sin((__pyx_v_Theta + __pyx_v_phi))))) * sin(__pyx_v_phi)) / 2.0)) - (((__pyx_v_r_o * (((__pyx_v_r_b * ((((pow(__pyx_v_phi, 3.0) - ((3.0 * pow(__pyx_v_phi, 2.0)) * __pyx_v_phi_0)) + ((3.0 * __pyx_v_phi) * pow(__pyx_v_phi_0, 2.0))) - (3.0 * __pyx_v_phi)) + (6.0 * __pyx_v_phi_0))) + ((((6.0 * __pyx_v_r_o) * (__pyx_v_phi - __pyx_v_phi_0)) * cos(__pyx_v_Theta)) * cos(__pyx_v_phi))) - (((6.0 * __pyx_v_r_o) * sin(__pyx_v_phi)) * cos(__pyx_v_Theta)))) * sin(__pyx_v_Theta)) / 6.0)));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">242</span>:     + r_b**2*(3*(phi - phi_0)**2 - 1)*cos(phi)**3/3 - r_b*r_o*(phi - phi_0 - 1)*(phi - phi_0 + 1)*cos(Theta)/2</pre>
<pre class="cython line score-0">&#xA0;<span class="">243</span>:     + r_b*(4*r_b*(phi - phi_0) + 2*r_o*(phi - phi_0)*cos(Theta + phi) + r_o*((phi - phi_0)**2 - 1)*sin(Theta + phi))*sin(phi)/2</pre>
<pre class="cython line score-0">&#xA0;<span class="">244</span>:     - r_o*(r_b*(phi**3 - 3*phi**2*phi_0 + 3*phi*phi_0**2 - 3*phi + 6*phi_0) + 6*r_o*(phi - phi_0)*cos(Theta)*cos(phi) - 6*r_o*sin(phi)*cos(Theta))*sin(Theta)/6)</pre>
<pre class="cython line score-0">&#xA0;<span class="">245</span>: </pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>: cpdef double fFx_p(double phi, geoVals geo, double theta, involute_index inv):</pre>
<pre class='cython code score-70 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_15fFx_p(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_5PDSim_6scroll_17common_scroll_geo_fFx_p(double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, CYTHON_UNUSED double __pyx_v_theta, enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fFx_p", 0);
  <span class='trace'>__Pyx_TraceCall</span>("fFx_p", __pyx_f[0], 246, 0, <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.fFx_p", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_15fFx_p(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_14fFx_p[] = "fFx_p(double phi, geoVals geo, double theta, involute_index inv) -&gt; double\n\n    The anti-derivative of the x-coordinate force term (Table 2)\n    \n    Parameters\n    ----------\n    phi : float\n        The involute angle\n    geo : geoVals\n        The structure with the geometry obtained from get_geo()\n    theta : float\n        The crank angle, between 0 and 2*pi\n    inv : involute_index\n        The key for the involute to be considered\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_15fFx_p(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_phi;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fFx_p (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_phi,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_inv,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fFx_p", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fFx_p", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inv)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fFx_p", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fFx_p") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_phi = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_phi == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L3_error)</span>
    __pyx_v_inv = ((enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index)__Pyx_PyInt_As_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index(values[3]));<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 246, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fFx_p", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.fFx_p", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_14fFx_p(__pyx_self, __pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_14fFx_p(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fFx_p", 0);
  <span class='trace'>__Pyx_TraceCall</span>("fFx_p (wrapper)", __pyx_f[0], 246, 0, <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_fFx_p(__pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.fFx_p", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">247</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">248</span>:     The anti-derivative of the x-coordinate force term (Table 2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">249</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">250</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">251</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">252</span>:     phi : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">253</span>:         The involute angle</pre>
<pre class="cython line score-0">&#xA0;<span class="">254</span>:     geo : geoVals</pre>
<pre class="cython line score-0">&#xA0;<span class="">255</span>:         The structure with the geometry obtained from get_geo()</pre>
<pre class="cython line score-0">&#xA0;<span class="">256</span>:     theta : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">257</span>:         The crank angle, between 0 and 2*pi</pre>
<pre class="cython line score-0">&#xA0;<span class="">258</span>:     inv : involute_index</pre>
<pre class="cython line score-0">&#xA0;<span class="">259</span>:         The key for the involute to be considered</pre>
<pre class="cython line score-0">&#xA0;<span class="">260</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:     if inv == INVOLUTE_FI:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_inv) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">262</span>:         return geo.h*geo.rb*((geo.phi_fi0-phi)*cos(phi)+sin(phi))</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;h * __pyx_v_geo-&gt;rb) * (((__pyx_v_geo-&gt;phi_fi0 - __pyx_v_phi) * cos(__pyx_v_phi)) + sin(__pyx_v_phi)));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">263</span>:     elif inv == INVOLUTE_OO:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>:         return geo.h*geo.rb*((geo.phi_oo0-phi)*cos(phi)+sin(phi))</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;h * __pyx_v_geo-&gt;rb) * (((__pyx_v_geo-&gt;phi_oo0 - __pyx_v_phi) * cos(__pyx_v_phi)) + sin(__pyx_v_phi)));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>:     elif inv == INVOLUTE_FO:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>:         return geo.h*geo.rb*((phi-geo.phi_fo0)*cos(phi)-sin(phi))</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;h * __pyx_v_geo-&gt;rb) * (((__pyx_v_phi - __pyx_v_geo-&gt;phi_fo0) * cos(__pyx_v_phi)) - sin(__pyx_v_phi)));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">267</span>:     elif inv == INVOLUTE_OI:</pre>
<pre class='cython code score-0 '>    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:         return geo.h*geo.rb*((phi-geo.phi_oi0)*cos(phi)-sin(phi))</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;h * __pyx_v_geo-&gt;rb) * (((__pyx_v_phi - __pyx_v_geo-&gt;phi_oi0) * cos(__pyx_v_phi)) - sin(__pyx_v_phi)));
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">269</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">270</span>:         raise ValueError("Involute is invalid")</pre>
<pre class='cython code score-5 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 270, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 270, __pyx_L1_error)</span>
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">271</span>: </pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">272</span>: cpdef double fFy_p(double phi, geoVals geo, double theta, involute_index inv):</pre>
<pre class='cython code score-70 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_17fFy_p(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_5PDSim_6scroll_17common_scroll_geo_fFy_p(double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, CYTHON_UNUSED double __pyx_v_theta, enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fFy_p", 0);
  <span class='trace'>__Pyx_TraceCall</span>("fFy_p", __pyx_f[0], 272, 0, <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.fFy_p", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_17fFy_p(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_16fFy_p[] = "fFy_p(double phi, geoVals geo, double theta, involute_index inv) -&gt; double\n\n    The anti-derivative of the y-coordinate force term (Table 2)\n    \n    Parameters\n    ----------\n    phi : float\n        The involute angle\n    geo : geoVals\n        The structure with the geometry obtained from get_geo()\n    theta : float\n        The crank angle, between 0 and 2*pi\n    inv : involute_index\n        The key for the involute to be considered\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_17fFy_p(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_phi;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fFy_p (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_phi,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_inv,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fFy_p", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fFy_p", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inv)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fFy_p", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fFy_p") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_phi = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_phi == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L3_error)</span>
    __pyx_v_inv = ((enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index)__Pyx_PyInt_As_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index(values[3]));<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 272, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fFy_p", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.fFy_p", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_16fFy_p(__pyx_self, __pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_16fFy_p(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fFy_p", 0);
  <span class='trace'>__Pyx_TraceCall</span>("fFy_p (wrapper)", __pyx_f[0], 272, 0, <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_fFy_p(__pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 272, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.fFy_p", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">273</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">274</span>:     The anti-derivative of the y-coordinate force term (Table 2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">275</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">276</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">277</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">278</span>:     phi : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">279</span>:         The involute angle</pre>
<pre class="cython line score-0">&#xA0;<span class="">280</span>:     geo : geoVals</pre>
<pre class="cython line score-0">&#xA0;<span class="">281</span>:         The structure with the geometry obtained from get_geo()</pre>
<pre class="cython line score-0">&#xA0;<span class="">282</span>:     theta : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">283</span>:         The crank angle, between 0 and 2*pi</pre>
<pre class="cython line score-0">&#xA0;<span class="">284</span>:     inv : involute_index</pre>
<pre class="cython line score-0">&#xA0;<span class="">285</span>:         The key for the involute to be considered</pre>
<pre class="cython line score-0">&#xA0;<span class="">286</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">287</span>:     if inv == INVOLUTE_FI:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_inv) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">288</span>:         return geo.h*geo.rb*((geo.phi_fi0-phi)*sin(phi)-cos(phi))</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;h * __pyx_v_geo-&gt;rb) * (((__pyx_v_geo-&gt;phi_fi0 - __pyx_v_phi) * sin(__pyx_v_phi)) - cos(__pyx_v_phi)));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>:     elif inv == INVOLUTE_OO:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">290</span>:         return geo.h*geo.rb*((geo.phi_oo0-phi)*sin(phi)-cos(phi))</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;h * __pyx_v_geo-&gt;rb) * (((__pyx_v_geo-&gt;phi_oo0 - __pyx_v_phi) * sin(__pyx_v_phi)) - cos(__pyx_v_phi)));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">291</span>:     elif inv == INVOLUTE_FO:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>:         return geo.h*geo.rb*((phi-geo.phi_fo0)*sin(phi)+cos(phi))</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;h * __pyx_v_geo-&gt;rb) * (((__pyx_v_phi - __pyx_v_geo-&gt;phi_fo0) * sin(__pyx_v_phi)) + cos(__pyx_v_phi)));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:     elif inv == INVOLUTE_OI:</pre>
<pre class='cython code score-0 '>    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">294</span>:         return geo.h*geo.rb*((phi-geo.phi_oi0)*sin(phi)+cos(phi))</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;h * __pyx_v_geo-&gt;rb) * (((__pyx_v_phi - __pyx_v_geo-&gt;phi_oi0) * sin(__pyx_v_phi)) + cos(__pyx_v_phi)));
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">295</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:         raise ValueError("Involute is invalid")</pre>
<pre class='cython code score-5 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">297</span>: </pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>: cpdef double fMO_p(double phi, geoVals geo, double theta, involute_index inv):</pre>
<pre class='cython code score-69 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_19fMO_p(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_5PDSim_6scroll_17common_scroll_geo_fMO_p(double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, CYTHON_UNUSED double __pyx_v_theta, enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fMO_p", 0);
  <span class='trace'>__Pyx_TraceCall</span>("fMO_p", __pyx_f[0], 298, 0, <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.fMO_p", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_19fMO_p(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_18fMO_p[] = "fMO_p(double phi, geoVals geo, double theta, involute_index inv) -&gt; double\n\n    The anti-derivative of the spinning moment calculation (Table 2)\n    \n    Parameters\n    ----------\n    phi : float\n        The involute angle\n    geo : geoVals\n        The structure with the geometry obtained from get_geo()\n    theta : float\n        The crank angle, between 0 and 2*pi\n    inv : involute_index\n        The key for the involute to be considered\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_19fMO_p(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_phi;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fMO_p (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_phi,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_inv,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fMO_p", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fMO_p", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inv)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fMO_p", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fMO_p") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_phi = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_phi == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L3_error)</span>
    __pyx_v_inv = ((enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index)__Pyx_PyInt_As_enum____pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index(values[3]));<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 298, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fMO_p", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.fMO_p", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_18fMO_p(__pyx_self, __pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_18fMO_p(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, enum __pyx_t_5PDSim_6scroll_17common_scroll_geo_involute_index __pyx_v_inv) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fMO_p", 0);
  <span class='trace'>__Pyx_TraceCall</span>("fMO_p (wrapper)", __pyx_f[0], 298, 0, <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_fMO_p(__pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.fMO_p", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">299</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">300</span>:     The anti-derivative of the spinning moment calculation (Table 2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">301</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">302</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">303</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">304</span>:     phi : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">305</span>:         The involute angle</pre>
<pre class="cython line score-0">&#xA0;<span class="">306</span>:     geo : geoVals</pre>
<pre class="cython line score-0">&#xA0;<span class="">307</span>:         The structure with the geometry obtained from get_geo()</pre>
<pre class="cython line score-0">&#xA0;<span class="">308</span>:     theta : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">309</span>:         The crank angle, between 0 and 2*pi</pre>
<pre class="cython line score-0">&#xA0;<span class="">310</span>:     inv : involute_index</pre>
<pre class="cython line score-0">&#xA0;<span class="">311</span>:         The key for the involute to be considered</pre>
<pre class="cython line score-0">&#xA0;<span class="">312</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">313</span>:     if inv == INVOLUTE_OO:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_inv) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">314</span>:         return geo.h*geo.rb**2*phi/2.0*(phi-2*geo.phi_oo0)</pre>
<pre class='cython code score-0 '>    __pyx_r = ((((__pyx_v_geo-&gt;h * pow(__pyx_v_geo-&gt;rb, 2.0)) * __pyx_v_phi) / 2.0) * (__pyx_v_phi - (2.0 * __pyx_v_geo-&gt;phi_oo0)));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>:     elif inv == INVOLUTE_OI:</pre>
<pre class='cython code score-0 '>    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">316</span>:         return -geo.h*geo.rb**2*phi/2.0*(phi-2*geo.phi_oi0)</pre>
<pre class='cython code score-0 '>    __pyx_r = (((((-__pyx_v_geo-&gt;h) * pow(__pyx_v_geo-&gt;rb, 2.0)) * __pyx_v_phi) / 2.0) * (__pyx_v_phi - (2.0 * __pyx_v_geo-&gt;phi_oi0)));
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">317</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:         return 1e99</pre>
<pre class='cython code score-0 '>    __pyx_r = 1e99;
    goto __pyx_L0;
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">319</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">320</span>: cpdef bytes involute_index_to_key(int index):</pre>
<pre class='cython code score-18 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_21involute_index_to_key(PyObject *__pyx_self, PyObject *__pyx_arg_index); /*proto*/
static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo_involute_index_to_key(int __pyx_v_index, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("involute_index_to_key", 0);
  <span class='trace'>__Pyx_TraceCall</span>("involute_index_to_key", __pyx_f[0], 320, 0, <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.involute_index_to_key", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_21involute_index_to_key(PyObject *__pyx_self, PyObject *__pyx_arg_index); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_20involute_index_to_key[] = "involute_index_to_key(int index) -&gt; bytes\n\n    Return the string associated with a given index from the common_scroll_geo.involute_index enumeration\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_21involute_index_to_key(PyObject *__pyx_self, PyObject *__pyx_arg_index) {
  int __pyx_v_index;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("involute_index_to_key (wrapper)", 0);
  assert(__pyx_arg_index); {
    __pyx_v_index = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_arg_index); if (unlikely((__pyx_v_index == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.involute_index_to_key", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_20involute_index_to_key(__pyx_self, ((int)__pyx_v_index));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_20involute_index_to_key(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_index) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("involute_index_to_key", 0);
  <span class='trace'>__Pyx_TraceCall</span>("involute_index_to_key (wrapper)", __pyx_f[0], 320, 0, <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_involute_index_to_key(__pyx_v_index, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.involute_index_to_key", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">321</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">322</span>:     Return the string associated with a given index from the common_scroll_geo.involute_index enumeration</pre>
<pre class="cython line score-0">&#xA0;<span class="">323</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">324</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">325</span>:     if index == INVOLUTE_FI:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_index) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO:
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">326</span>:         return 'fi'.encode('ascii')</pre>
<pre class='cython code score-27 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_n_s_fi, __pyx_n_s_encode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_n_s_ascii) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_n_s_ascii);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
    __pyx_r = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">327</span>:     elif index == INVOLUTE_FO:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI:
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">328</span>:         return 'fo'.encode('ascii')</pre>
<pre class='cython code score-27 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_n_s_fo, __pyx_n_s_encode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_n_s_ascii) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_n_s_ascii);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>
    __pyx_r = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">329</span>:     elif index == INVOLUTE_OI:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO:
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">330</span>:         return 'oi'.encode('ascii')</pre>
<pre class='cython code score-27 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_n_s_oi, __pyx_n_s_encode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_n_s_ascii) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_n_s_ascii);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 330, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 330, __pyx_L1_error)</span>
    __pyx_r = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">331</span>:     elif index == INVOLUTE_OO:</pre>
<pre class='cython code score-0 '>    break;
    default:
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">332</span>:         return 'oo'.encode('ascii')</pre>
<pre class='cython code score-27 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_n_s_oo, __pyx_n_s_encode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_n_s_ascii) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_n_s_ascii);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
    __pyx_r = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">333</span>:     else:</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">334</span>:         return ''.encode('ascii')</pre>
<pre class='cython code score-27 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_, __pyx_n_s_encode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_n_s_ascii) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_n_s_ascii);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 334, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 334, __pyx_L1_error)</span>
    __pyx_r = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">335</span>: </pre>
<pre class="cython line score-76" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">336</span>: cpdef double Gr(double phi, geoVals geo, double theta, int inv):</pre>
<pre class='cython code score-76 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_23Gr(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr(double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, int __pyx_v_inv, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_theta_m;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Gr", 0);
  <span class='trace'>__Pyx_TraceCall</span>("Gr", __pyx_f[0], 336, 0, <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.Gr", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_23Gr(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_22Gr[] = "Gr(double phi, geoVals geo, double theta, int inv) -&gt; double\n\n    The antiderivative of the area integration term, where \n    \n    .. math::\n    \n        Gr \\equiv \\int\\left[\\left(-y\\frac{dx(\\phi)}{d\\phi}+x\\frac{dy(\\phi)}{d\\phi}\\right)d\\phi\\right]\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_23Gr(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_phi;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  int __pyx_v_inv;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Gr (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_phi,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_inv,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Gr", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Gr", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inv)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Gr", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Gr") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_phi = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_phi == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
    __pyx_v_inv = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_inv == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("Gr", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.Gr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_22Gr(__pyx_self, __pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_22Gr(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, int __pyx_v_inv) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Gr", 0);
  <span class='trace'>__Pyx_TraceCall</span>("Gr (wrapper)", __pyx_f[0], 336, 0, <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_Gr(__pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.Gr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">337</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">338</span>:     The antiderivative of the area integration term, where</pre>
<pre class="cython line score-0">&#xA0;<span class="">339</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">340</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">341</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">342</span>:         Gr \\equiv \\int\\left[\\left(-y\\frac{dx(\\phi)}{d\\phi}+x\\frac{dy(\\phi)}{d\\phi}\\right)d\\phi\\right]</pre>
<pre class="cython line score-0">&#xA0;<span class="">343</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">344</span>:     theta_m = geo.phi_fie - theta + 3.0*pi/2.0</pre>
<pre class='cython code score-0 '>  __pyx_v_theta_m = ((__pyx_v_geo-&gt;phi_fie - __pyx_v_theta) + ((3.0 * M_PI) / 2.0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">345</span>:     if inv == INVOLUTE_FI:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_inv) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">346</span>:         return phi*geo.rb**2*(phi**2 - 3*phi*geo.phi_fi0 + 3*geo.phi_fi0**2)/3</pre>
<pre class='cython code score-0 '>    __pyx_r = (((__pyx_v_phi * pow(__pyx_v_geo-&gt;rb, 2.0)) * ((pow(__pyx_v_phi, 2.0) - ((3.0 * __pyx_v_phi) * __pyx_v_geo-&gt;phi_fi0)) + (3.0 * pow(__pyx_v_geo-&gt;phi_fi0, 2.0)))) / 3.0);
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">347</span>:     elif inv == INVOLUTE_FO:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">348</span>:         return phi*geo.rb**2*(phi**2 - 3*phi*geo.phi_fo0 + 3*geo.phi_fo0**2)/3</pre>
<pre class='cython code score-0 '>    __pyx_r = (((__pyx_v_phi * pow(__pyx_v_geo-&gt;rb, 2.0)) * ((pow(__pyx_v_phi, 2.0) - ((3.0 * __pyx_v_phi) * __pyx_v_geo-&gt;phi_fo0)) + (3.0 * pow(__pyx_v_geo-&gt;phi_fo0, 2.0)))) / 3.0);
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">349</span>:     elif inv == INVOLUTE_OI:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO:
</pre><pre class="cython line score-0">&#xA0;<span class="">350</span>:         return geo.rb*(phi**3*geo.rb - 3*phi**2*geo.phi_oi0*geo.rb</pre>
<pre class="cython line score-0">&#xA0;<span class="">351</span>:                        + 3*phi*geo.phi_oi0**2*geo.rb</pre>
<pre class="cython line score-0">&#xA0;<span class="">352</span>:                        + 3*(phi-geo.phi_oi0)*geo.ro*cos(phi - theta_m)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">353</span>:                        - 3*geo.ro*sin(phi - theta_m))/3</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;rb * (((((pow(__pyx_v_phi, 3.0) * __pyx_v_geo-&gt;rb) - (((3.0 * pow(__pyx_v_phi, 2.0)) * __pyx_v_geo-&gt;phi_oi0) * __pyx_v_geo-&gt;rb)) + (((3.0 * __pyx_v_phi) * pow(__pyx_v_geo-&gt;phi_oi0, 2.0)) * __pyx_v_geo-&gt;rb)) + (((3.0 * (__pyx_v_phi - __pyx_v_geo-&gt;phi_oi0)) * __pyx_v_geo-&gt;ro) * cos((__pyx_v_phi - __pyx_v_theta_m)))) - ((3.0 * __pyx_v_geo-&gt;ro) * sin((__pyx_v_phi - __pyx_v_theta_m))))) / 3.0);
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">354</span>:     elif inv == INVOLUTE_OO:</pre>
<pre class='cython code score-0 '>    break;
    default: break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">355</span>:         return geo.rb*(phi**3*geo.rb - 3*phi**2*geo.phi_oo0*geo.rb</pre>
<pre class="cython line score-0">&#xA0;<span class="">356</span>:                        + 3*phi*geo.phi_oo0**2*geo.rb</pre>
<pre class="cython line score-0">&#xA0;<span class="">357</span>:                        + 3*(phi-geo.phi_oo0)*geo.ro*cos(phi - theta_m)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">358</span>:                        - 3*geo.ro*sin(phi - theta_m))/3</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;rb * (((((pow(__pyx_v_phi, 3.0) * __pyx_v_geo-&gt;rb) - (((3.0 * pow(__pyx_v_phi, 2.0)) * __pyx_v_geo-&gt;phi_oo0) * __pyx_v_geo-&gt;rb)) + (((3.0 * __pyx_v_phi) * pow(__pyx_v_geo-&gt;phi_oo0, 2.0)) * __pyx_v_geo-&gt;rb)) + (((3.0 * (__pyx_v_phi - __pyx_v_geo-&gt;phi_oo0)) * __pyx_v_geo-&gt;ro) * cos((__pyx_v_phi - __pyx_v_theta_m)))) - ((3.0 * __pyx_v_geo-&gt;ro) * sin((__pyx_v_phi - __pyx_v_theta_m))))) / 3.0);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">359</span>: </pre>
<pre class="cython line score-76" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">360</span>: cpdef double dGr_dphi(double phi, geoVals geo, double theta, int inv):</pre>
<pre class='cython code score-76 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_25dGr_dphi(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dphi(double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, int __pyx_v_inv, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_THETA;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dGr_dphi", 0);
  <span class='trace'>__Pyx_TraceCall</span>("dGr_dphi", __pyx_f[0], 360, 0, <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.dGr_dphi", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_25dGr_dphi(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_24dGr_dphi[] = "dGr_dphi(double phi, geoVals geo, double theta, int inv) -&gt; double\n\n    The partial derivative of Gr with respect to phi with theta held constant\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_25dGr_dphi(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_phi;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  int __pyx_v_inv;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dGr_dphi (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_phi,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_inv,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("dGr_dphi", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("dGr_dphi", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inv)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("dGr_dphi", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dGr_dphi") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_phi = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_phi == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L3_error)</span>
    __pyx_v_inv = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_inv == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("dGr_dphi", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.dGr_dphi", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_24dGr_dphi(__pyx_self, __pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_24dGr_dphi(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, int __pyx_v_inv) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dGr_dphi", 0);
  <span class='trace'>__Pyx_TraceCall</span>("dGr_dphi (wrapper)", __pyx_f[0], 360, 0, <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dphi(__pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.dGr_dphi", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">361</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">362</span>:     The partial derivative of Gr with respect to phi with theta held constant</pre>
<pre class="cython line score-0">&#xA0;<span class="">363</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">364</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">365</span>:     THETA = geo.phi_fie - theta - pi/2.0</pre>
<pre class='cython code score-0 '>  __pyx_v_THETA = ((__pyx_v_geo-&gt;phi_fie - __pyx_v_theta) - (((double)M_PI) / 2.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">366</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">367</span>:     if inv == INVOLUTE_FI:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_inv) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">368</span>:         return geo.rb**2*(phi - geo.phi_fi0)**2</pre>
<pre class='cython code score-0 '>    __pyx_r = (pow(__pyx_v_geo-&gt;rb, 2.0) * pow((__pyx_v_phi - __pyx_v_geo-&gt;phi_fi0), 2.0));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">369</span>:     elif inv == INVOLUTE_FO:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">370</span>:         return geo.rb**2*(phi - geo.phi_fo0)**2</pre>
<pre class='cython code score-0 '>    __pyx_r = (pow(__pyx_v_geo-&gt;rb, 2.0) * pow((__pyx_v_phi - __pyx_v_geo-&gt;phi_fo0), 2.0));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">371</span>:     elif inv == INVOLUTE_OI:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">372</span>:         return geo.rb*(geo.rb*(phi - geo.phi_oi0)**2 + (phi- geo.phi_oi0)*geo.ro*sin(THETA - phi))</pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_geo-&gt;rb * ((__pyx_v_geo-&gt;rb * pow((__pyx_v_phi - __pyx_v_geo-&gt;phi_oi0), 2.0)) + (((__pyx_v_phi - __pyx_v_geo-&gt;phi_oi0) * __pyx_v_geo-&gt;ro) * sin((__pyx_v_THETA - __pyx_v_phi)))));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">373</span>:     elif inv == INVOLUTE_OO:</pre>
<pre class='cython code score-0 '>    break;
    default: break;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">374</span>:         return geo.rb*(geo.rb*(phi - geo.phi_oo0)**2 + (phi- geo.phi_oo0)*geo.ro*sin(THETA - phi))</pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_geo-&gt;rb * ((__pyx_v_geo-&gt;rb * pow((__pyx_v_phi - __pyx_v_geo-&gt;phi_oo0), 2.0)) + (((__pyx_v_phi - __pyx_v_geo-&gt;phi_oo0) * __pyx_v_geo-&gt;ro) * sin((__pyx_v_THETA - __pyx_v_phi)))));
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">375</span>: </pre>
<pre class="cython line score-76" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">376</span>: cpdef double dGr_dtheta(double phi, geoVals geo, double theta, int inv):</pre>
<pre class='cython code score-76 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_27dGr_dtheta(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dtheta(double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, int __pyx_v_inv, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_THETA;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dGr_dtheta", 0);
  <span class='trace'>__Pyx_TraceCall</span>("dGr_dtheta", __pyx_f[0], 376, 0, <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.dGr_dtheta", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_27dGr_dtheta(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_26dGr_dtheta[] = "dGr_dtheta(double phi, geoVals geo, double theta, int inv) -&gt; double\n\n    The partial derivative of Gr with respect to theta with phi held constant\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_27dGr_dtheta(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_phi;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  int __pyx_v_inv;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dGr_dtheta (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_phi,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_inv,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("dGr_dtheta", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("dGr_dtheta", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inv)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("dGr_dtheta", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dGr_dtheta") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_phi = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_phi == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L3_error)</span>
    __pyx_v_inv = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_inv == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("dGr_dtheta", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.dGr_dtheta", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_26dGr_dtheta(__pyx_self, __pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_26dGr_dtheta(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, int __pyx_v_inv) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dGr_dtheta", 0);
  <span class='trace'>__Pyx_TraceCall</span>("dGr_dtheta (wrapper)", __pyx_f[0], 376, 0, <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_dGr_dtheta(__pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_inv, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 376, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.dGr_dtheta", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">377</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">378</span>:     The partial derivative of Gr with respect to theta with phi held constant</pre>
<pre class="cython line score-0">&#xA0;<span class="">379</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">380</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">381</span>:     THETA = geo.phi_fie - theta - pi/2.0</pre>
<pre class='cython code score-0 '>  __pyx_v_THETA = ((__pyx_v_geo-&gt;phi_fie - __pyx_v_theta) - (((double)M_PI) / 2.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">382</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">383</span>:     if inv == INVOLUTE_FI or inv == INVOLUTE_FO:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_inv) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI:
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">384</span>:         return 0.0</pre>
<pre class='cython code score-0 '>    __pyx_r = 0.0;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">385</span>:     elif inv == INVOLUTE_OI:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">386</span>:         return geo.rb*geo.ro*((phi - geo.phi_oi0)*sin(THETA - phi) - cos(THETA - phi))</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;rb * __pyx_v_geo-&gt;ro) * (((__pyx_v_phi - __pyx_v_geo-&gt;phi_oi0) * sin((__pyx_v_THETA - __pyx_v_phi))) - cos((__pyx_v_THETA - __pyx_v_phi))));
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">387</span>:     elif inv == INVOLUTE_OO:</pre>
<pre class='cython code score-0 '>    break;
    default: break;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">388</span>:         return geo.rb*geo.ro*((phi - geo.phi_oo0)*sin(THETA - phi) - cos(THETA - phi))</pre>
<pre class='cython code score-0 '>    __pyx_r = ((__pyx_v_geo-&gt;rb * __pyx_v_geo-&gt;ro) * (((__pyx_v_phi - __pyx_v_geo-&gt;phi_oo0) * sin((__pyx_v_THETA - __pyx_v_phi))) - cos((__pyx_v_THETA - __pyx_v_phi))));
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">389</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">390</span>: cdef coords_inv_dtheta(double phi, geoVals geo, double theta, int inv, double *dx, double *dy):</pre>
<pre class='cython code score-4 '>static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv_dtheta(CYTHON_UNUSED double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, int __pyx_v_inv, double *__pyx_v_dx, double *__pyx_v_dy) {
  double __pyx_v_rb;
  double __pyx_v_ro;
  double __pyx_v_om;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("coords_inv_dtheta", 0);
  <span class='trace'>__Pyx_TraceCall</span>("coords_inv_dtheta", __pyx_f[0], 390, 0, <span class='error_goto'>__PYX_ERR(0, 390, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.coords_inv_dtheta", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">391</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">392</span>:     Internal function that does the calculation if phi is a double variable</pre>
<pre class="cython line score-0">&#xA0;<span class="">393</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">394</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">395</span>:     rb = geo.rb</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_geo-&gt;rb;
  __pyx_v_rb = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">396</span>:     ro = rb*(pi - geo.phi_fi0 + geo.phi_oo0)</pre>
<pre class='cython code score-0 '>  __pyx_v_ro = (__pyx_v_rb * ((M_PI - __pyx_v_geo-&gt;phi_fi0) + __pyx_v_geo-&gt;phi_oo0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">397</span>:     om = geo.phi_fie - theta + 3.0*pi/2.0</pre>
<pre class='cython code score-0 '>  __pyx_v_om = ((__pyx_v_geo-&gt;phi_fie - __pyx_v_theta) + ((3.0 * M_PI) / 2.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">398</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">399</span>:     if inv == INVOLUTE_FI or inv == INVOLUTE_FO:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_inv) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI:
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">400</span>:         dx[0] = 0.0</pre>
<pre class='cython code score-0 '>    (__pyx_v_dx[0]) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">401</span>:         dy[0] = 0.0</pre>
<pre class='cython code score-0 '>    (__pyx_v_dy[0]) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">402</span>:     elif inv == INVOLUTE_OI or inv == INVOLUTE_OO:</pre>
<pre class='cython code score-0 '>    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO:
/* … */
    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">403</span>:         dx[0] = +ro*sin(om)</pre>
<pre class='cython code score-0 '>    (__pyx_v_dx[0]) = (__pyx_v_ro * sin(__pyx_v_om));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">404</span>:         dy[0] = -ro*cos(om)</pre>
<pre class='cython code score-0 '>    (__pyx_v_dy[0]) = ((-__pyx_v_ro) * cos(__pyx_v_om));
</pre><pre class="cython line score-0">&#xA0;<span class="">405</span>:     else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">406</span>:         raise ValueError('flag not valid')</pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 406, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 406, __pyx_L1_error)</span>
    break;
  }
/* … */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_flag_not_valid);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
</pre><pre class="cython line score-0">&#xA0;<span class="">407</span>: </pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">408</span>: cpdef tuple sortAnglesCCW(double t1, double t2):</pre>
<pre class='cython code score-53 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_29sortAnglesCCW(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo_sortAnglesCCW(double __pyx_v_t1, double __pyx_v_t2, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sortAnglesCCW", 0);
  <span class='trace'>__Pyx_TraceCall</span>("sortAnglesCCW", __pyx_f[0], 408, 0, <span class='error_goto'>__PYX_ERR(0, 408, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.sortAnglesCCW", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_29sortAnglesCCW(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_28sortAnglesCCW[] = "sortAnglesCCW(double t1, double t2) -&gt; tuple\n\n    Sort angles so that t2&gt;t1 in a counter-clockwise sense\n    idea from `StackOverflow &lt;http://stackoverflow.com/questions/242404/sort-four-points-in-clockwise-order&gt;`_\n    more description: `SoftSurfer &lt;http://softsurfer.com/Archive/algorithm_0101/algorithm_0101.htm&gt;`_\n\n    If the signed area of the triangle formed between the points on a unit circle with angles t1 and t2\n    and the origin is positive, the angles are sorted counterclockwise. Otherwise, the angles\n    are sorted in a counter-clockwise manner.  Here we want the angles to be sorted CCW, so\n    if area is negative, swap angles\n    \n    Area obtained from the cross product of a vector from origin \n    to 1 and a vector to point 2, so use right hand rule to get \n    sign of cross product with unit length\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_29sortAnglesCCW(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_t1;
  double __pyx_v_t2;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sortAnglesCCW (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_t1,&amp;__pyx_n_s_t2,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_t1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_t2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sortAnglesCCW", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 408, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sortAnglesCCW") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 408, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_t1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_t1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 408, __pyx_L3_error)</span>
    __pyx_v_t2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_t2 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 408, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sortAnglesCCW", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 408, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.sortAnglesCCW", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_28sortAnglesCCW(__pyx_self, __pyx_v_t1, __pyx_v_t2);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_28sortAnglesCCW(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_t1, double __pyx_v_t2) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sortAnglesCCW", 0);
  <span class='trace'>__Pyx_TraceCall</span>("sortAnglesCCW (wrapper)", __pyx_f[0], 408, 0, <span class='error_goto'>__PYX_ERR(0, 408, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_sortAnglesCCW(__pyx_v_t1, __pyx_v_t2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 408, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.sortAnglesCCW", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">409</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">410</span>:     Sort angles so that t2&gt;t1 in a counter-clockwise sense</pre>
<pre class="cython line score-0">&#xA0;<span class="">411</span>:     idea from `StackOverflow &lt;http://stackoverflow.com/questions/242404/sort-four-points-in-clockwise-order&gt;`_</pre>
<pre class="cython line score-0">&#xA0;<span class="">412</span>:     more description: `SoftSurfer &lt;http://softsurfer.com/Archive/algorithm_0101/algorithm_0101.htm&gt;`_</pre>
<pre class="cython line score-0">&#xA0;<span class="">413</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">414</span>:     If the signed area of the triangle formed between the points on a unit circle with angles t1 and t2</pre>
<pre class="cython line score-0">&#xA0;<span class="">415</span>:     and the origin is positive, the angles are sorted counterclockwise. Otherwise, the angles</pre>
<pre class="cython line score-0">&#xA0;<span class="">416</span>:     are sorted in a counter-clockwise manner.  Here we want the angles to be sorted CCW, so</pre>
<pre class="cython line score-0">&#xA0;<span class="">417</span>:     if area is negative, swap angles</pre>
<pre class="cython line score-0">&#xA0;<span class="">418</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">419</span>:     Area obtained from the cross product of a vector from origin</pre>
<pre class="cython line score-0">&#xA0;<span class="">420</span>:     to 1 and a vector to point 2, so use right hand rule to get</pre>
<pre class="cython line score-0">&#xA0;<span class="">421</span>:     sign of cross product with unit length</pre>
<pre class="cython line score-0">&#xA0;<span class="">422</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">423</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">424</span>:     if (cos(t1)*sin(t2)-cos(t2)*sin(t1)&lt;0):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((((cos(__pyx_v_t1) * sin(__pyx_v_t2)) - (cos(__pyx_v_t2) * sin(__pyx_v_t1))) &lt; 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">425</span>:         # Swap angles</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">426</span>:         t1,t2 = t2,t1</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_t2;
    __pyx_t_3 = __pyx_v_t1;
    __pyx_v_t1 = __pyx_t_2;
    __pyx_v_t2 = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">427</span>:     while (t1 &gt; t2):</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = ((__pyx_v_t1 &gt; __pyx_v_t2) != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">428</span>:         # Make t2 bigger than t1</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">429</span>:         t2=t2 + 2*pi;</pre>
<pre class='cython code score-0 '>    __pyx_v_t2 = (__pyx_v_t2 + (2.0 * M_PI));
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">430</span>:     return (t1,t2)</pre>
<pre class='cython code score-18 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_t1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_t2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_r = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">431</span>: </pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">432</span>: cpdef tuple sortAnglesCW(double t1, double t2):</pre>
<pre class='cython code score-53 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_31sortAnglesCW(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo_sortAnglesCW(double __pyx_v_t1, double __pyx_v_t2, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sortAnglesCW", 0);
  <span class='trace'>__Pyx_TraceCall</span>("sortAnglesCW", __pyx_f[0], 432, 0, <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.sortAnglesCW", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_31sortAnglesCW(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_30sortAnglesCW[] = "sortAnglesCW(double t1, double t2) -&gt; tuple\n\n    Sort angles so that t2&gt;t1 in a clockwise sense\n    idea from `StackOverflow &lt;http://stackoverflow.com/questions/242404/sort-four-points-in-clockwise-order&gt;`_\n    more description: `SoftSurfer &lt;http://softsurfer.com/Archive/algorithm_0101/algorithm_0101.htm&gt;`_\n\n    If the signed area of the triangle formed between the points on a unit circle with angles t1 and t2\n    and the origin is positive, the angles are sorted counterclockwise. Otherwise, the angles\n    are sorted in a counter-clockwise manner.  Here we want the angles to be sorted CCW, so\n    if area is negative, swap angles\n    \n    Area obtained from the cross product of a vector from origin \n    to 1 and a vector to point 2, so use right hand rule to get \n    sign of cross product with unit length\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_31sortAnglesCW(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_t1;
  double __pyx_v_t2;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sortAnglesCW (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_t1,&amp;__pyx_n_s_t2,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_t1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_t2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sortAnglesCW", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sortAnglesCW") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_t1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_t1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L3_error)</span>
    __pyx_v_t2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_t2 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sortAnglesCW", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.sortAnglesCW", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_30sortAnglesCW(__pyx_self, __pyx_v_t1, __pyx_v_t2);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_30sortAnglesCW(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_t1, double __pyx_v_t2) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sortAnglesCW", 0);
  <span class='trace'>__Pyx_TraceCall</span>("sortAnglesCW (wrapper)", __pyx_f[0], 432, 0, <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_sortAnglesCW(__pyx_v_t1, __pyx_v_t2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 432, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.sortAnglesCW", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">433</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">434</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">435</span>:     Sort angles so that t2&gt;t1 in a clockwise sense</pre>
<pre class="cython line score-0">&#xA0;<span class="">436</span>:     idea from `StackOverflow &lt;http://stackoverflow.com/questions/242404/sort-four-points-in-clockwise-order&gt;`_</pre>
<pre class="cython line score-0">&#xA0;<span class="">437</span>:     more description: `SoftSurfer &lt;http://softsurfer.com/Archive/algorithm_0101/algorithm_0101.htm&gt;`_</pre>
<pre class="cython line score-0">&#xA0;<span class="">438</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">439</span>:     If the signed area of the triangle formed between the points on a unit circle with angles t1 and t2</pre>
<pre class="cython line score-0">&#xA0;<span class="">440</span>:     and the origin is positive, the angles are sorted counterclockwise. Otherwise, the angles</pre>
<pre class="cython line score-0">&#xA0;<span class="">441</span>:     are sorted in a counter-clockwise manner.  Here we want the angles to be sorted CCW, so</pre>
<pre class="cython line score-0">&#xA0;<span class="">442</span>:     if area is negative, swap angles</pre>
<pre class="cython line score-0">&#xA0;<span class="">443</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">444</span>:     Area obtained from the cross product of a vector from origin</pre>
<pre class="cython line score-0">&#xA0;<span class="">445</span>:     to 1 and a vector to point 2, so use right hand rule to get</pre>
<pre class="cython line score-0">&#xA0;<span class="">446</span>:     sign of cross product with unit length</pre>
<pre class="cython line score-0">&#xA0;<span class="">447</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">448</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">449</span>:     while (cos(t1)*sin(t2)-sin(t1)*cos(t2)&gt;0):</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = ((((cos(__pyx_v_t1) * sin(__pyx_v_t2)) - (sin(__pyx_v_t1) * cos(__pyx_v_t2))) &gt; 0.0) != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">450</span>:         # Swap angles</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">451</span>:         t1,t2 = t2,t1</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_t2;
    __pyx_t_3 = __pyx_v_t1;
    __pyx_v_t1 = __pyx_t_2;
    __pyx_v_t2 = __pyx_t_3;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">452</span>:     # Make t1 between 0 and 2pi</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">453</span>:     while (t1&lt;0 or t1&gt; 2.0*pi):</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_4 = ((__pyx_v_t1 &lt; 0.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_1 = __pyx_t_4;
      goto __pyx_L7_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_t1 &gt; (2.0 * M_PI)) != 0);
    __pyx_t_1 = __pyx_t_4;
    __pyx_L7_bool_binop_done:;
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">454</span>:         if t1&gt;2.0*pi:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_t1 &gt; (2.0 * M_PI)) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L9;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">455</span>:             t1=t1-2*pi</pre>
<pre class='cython code score-0 '>      __pyx_v_t1 = (__pyx_v_t1 - (2.0 * M_PI));
</pre><pre class="cython line score-0">&#xA0;<span class="">456</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">457</span>:             t1=t1+2*pi</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_t1 = (__pyx_v_t1 + (2.0 * M_PI));
    }
    __pyx_L9:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">458</span>:     # Want t2 to be less than t1, but no more than 2*pi less</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">459</span>:     while (t2&lt;t1 and t1-t2&gt;2*pi):</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_4 = ((__pyx_v_t2 &lt; __pyx_v_t1) != 0);
    if (__pyx_t_4) {
    } else {
      __pyx_t_1 = __pyx_t_4;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_t1 - __pyx_v_t2) &gt; (2.0 * M_PI)) != 0);
    __pyx_t_1 = __pyx_t_4;
    __pyx_L12_bool_binop_done:;
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">460</span>:         t2=t2 + 2*pi</pre>
<pre class='cython code score-0 '>    __pyx_v_t2 = (__pyx_v_t2 + (2.0 * M_PI));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">461</span>:     while (t2&gt;t1):</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = ((__pyx_v_t2 &gt; __pyx_v_t1) != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">462</span>:         t2=t2 - 2*pi</pre>
<pre class='cython code score-0 '>    __pyx_v_t2 = (__pyx_v_t2 - (2.0 * M_PI));
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">463</span>:     return (t1, t2)</pre>
<pre class='cython code score-18 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_t1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 463, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_t2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 463, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 463, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_6);
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
  __pyx_r = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">464</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">465</span>: cpdef long get_compressor_CV_index(object _key) except *:</pre>
<pre class='cython code score-18 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_33get_compressor_CV_index(PyObject *__pyx_self, PyObject *__pyx_v__key); /*proto*/
static long __pyx_f_5PDSim_6scroll_17common_scroll_geo_get_compressor_CV_index(PyObject *__pyx_v__key, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_v_key = 0;
  long __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_compressor_CV_index", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_compressor_CV_index", __pyx_f[0], 465, 0, <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.get_compressor_CV_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_key);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_33get_compressor_CV_index(PyObject *__pyx_self, PyObject *__pyx_v__key); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_32get_compressor_CV_index[] = "get_compressor_CV_index(_key) -&gt; long\n\n    Returns the index defined in the ``compressor_CV_indices`` enum. \n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_33get_compressor_CV_index(PyObject *__pyx_self, PyObject *__pyx_v__key) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_compressor_CV_index (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_32get_compressor_CV_index(__pyx_self, ((PyObject *)__pyx_v__key));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_32get_compressor_CV_index(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v__key) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_compressor_CV_index", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_compressor_CV_index (wrapper)", __pyx_f[0], 465, 0, <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_get_compressor_CV_index(__pyx_v__key, 0); if (unlikely(__pyx_t_1 == ((long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.get_compressor_CV_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">466</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">467</span>:     Returns the index defined in the ``compressor_CV_indices`` enum.</pre>
<pre class="cython line score-0">&#xA0;<span class="">468</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">469</span>:     cdef bytes key</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">470</span>:     try:</pre>
<pre class='cython code score-10 '>  {
    /*try:*/ {
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L8_try_end;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L1_error;
    __pyx_L4_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    __pyx_L8_try_end:;
  }
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">471</span>:         key = _key.encode('utf8')</pre>
<pre class='cython code score-26 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v__key, __pyx_n_s_encode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 471, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        }
      }
      __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_n_s_utf8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_n_s_utf8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_t_4))||((__pyx_t_4) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_4)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L3_error)</span>
      __pyx_v_key = ((PyObject*)__pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">472</span>:     except AttributeError:</pre>
<pre class='cython code score-6 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(__pyx_builtin_AttributeError);
    if (__pyx_t_7) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.get_compressor_CV_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_4, &amp;__pyx_t_5, &amp;__pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 472, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">473</span>:         key = _key</pre>
<pre class='cython code score-15 '>      if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_v__key))||((__pyx_v__key) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_v__key)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 473, __pyx_L5_except_error)</span>
      __pyx_t_8 = __pyx_v__key;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_key, ((PyObject*)__pyx_t_8));
      __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L4_exception_handled;
    }
    goto __pyx_L5_except_error;
    __pyx_L5_except_error:;
</pre><pre class="cython line score-0">&#xA0;<span class="">474</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">475</span>:     if key == b'sa':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_sa, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 475, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">476</span>:         return keyIsa</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIsa;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">477</span>:     elif key == b's1':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_s1, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 477, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">478</span>:         return keyIs1</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIs1;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">479</span>:     elif key == b's2':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_s2, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">480</span>:         return keyIs2</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIs2;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">481</span>:     elif key == b'd1':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_d1, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 481, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">482</span>:         return keyId1</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyId1;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">483</span>:     elif key == b'd2':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_d2, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 483, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">484</span>:         return keyId2</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyId2;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">485</span>:     elif key == b'dd':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_dd, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 485, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">486</span>:         return keyIdd</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIdd;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">487</span>:     elif key == b'ddd':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_ddd, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 487, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">488</span>:         return keyIddd</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIddd;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">489</span>:     elif key == b'c1.1':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c1_1, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 489, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">490</span>:         return keyIc1_1</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_1;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">491</span>:     elif key == b'c2.1':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c2_1, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 491, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">492</span>:         return keyIc2_1</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_1;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">493</span>:     elif key == b'c1.2':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c1_2, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 493, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">494</span>:         return keyIc1_2</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_2;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">495</span>:     elif key == b'c2.2':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c2_2, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 495, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">496</span>:         return keyIc2_2</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_2;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">497</span>:     elif key == b'c1.3':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c1_3, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 497, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">498</span>:         return keyIc1_3</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_3;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">499</span>:     elif key == b'c2.3':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c2_3, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 499, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">500</span>:         return keyIc2_3</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_3;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">501</span>:     elif key == b'c1.4':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c1_4, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 501, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">502</span>:         return keyIc1_4</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_4;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">503</span>:     elif key == b'c2.4':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c2_4, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 503, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">504</span>:         return keyIc2_4</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_4;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">505</span>:     elif key == b'c1.5':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c1_5, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 505, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">506</span>:         return keyIc1_5</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_5;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">507</span>:     elif key == b'c2.5':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c2_5, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 507, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">508</span>:         return keyIc2_5</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_5;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">509</span>:     elif key == b'c1.6':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c1_6, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 509, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">510</span>:         return keyIc1_6</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_6;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">511</span>:     elif key == b'c2.6':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c2_6, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 511, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">512</span>:         return keyIc2_6</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_6;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">513</span>:     elif key == b'c1.7':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c1_7, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">514</span>:         return keyIc1_7</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_7;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">515</span>:     elif key == b'c2.7':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c2_7, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 515, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">516</span>:         return keyIc2_7</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_7;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">517</span>:     elif key == b'c1.8':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c1_8, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 517, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">518</span>:         return keyIc1_8</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_8;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">519</span>:     elif key == b'c2.8':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c2_8, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 519, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">520</span>:         return keyIc2_8</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_8;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">521</span>:     elif key == b'c1.9':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c1_9, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 521, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">522</span>:         return keyIc1_9</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_9;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">523</span>:     elif key == b'c2.9':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c2_9, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 523, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">524</span>:         return keyIc2_9</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_9;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">525</span>:     elif key == b'c1.10':</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c1_10, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_10 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">526</span>:         return keyIc1_10</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc1_10;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">527</span>:     elif key == b'c2.10':</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_kp_b_c2_10, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 527, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_9 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">528</span>:         return keyIc2_10</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_e_5PDSim_6scroll_17common_scroll_geo_keyIc2_10;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">529</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">530</span>:         return -1</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = -1L;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">531</span>: </pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">532</span>: cpdef long get_compression_chamber_index(long path, long alpha):</pre>
<pre class='cython code score-46 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_35get_compression_chamber_index(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static long __pyx_f_5PDSim_6scroll_17common_scroll_geo_get_compression_chamber_index(long __pyx_v_path, long __pyx_v_alpha, CYTHON_UNUSED int __pyx_skip_dispatch) {
  long __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_compression_chamber_index", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_compression_chamber_index", __pyx_f[0], 532, 0, <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.get_compression_chamber_index", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_35get_compression_chamber_index(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_34get_compression_chamber_index[] = "get_compression_chamber_index(long path, long alpha) -&gt; long\n\n    Return the index for the compression chamber with integers\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_35get_compression_chamber_index(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_path;
  long __pyx_v_alpha;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_compression_chamber_index (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_path,&amp;__pyx_n_s_alpha,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_path)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_compression_chamber_index", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_compression_chamber_index") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_path = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[0]); if (unlikely((__pyx_v_path == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L3_error)</span>
    __pyx_v_alpha = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[1]); if (unlikely((__pyx_v_alpha == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_compression_chamber_index", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.get_compression_chamber_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_34get_compression_chamber_index(__pyx_self, __pyx_v_path, __pyx_v_alpha);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_34get_compression_chamber_index(CYTHON_UNUSED PyObject *__pyx_self, long __pyx_v_path, long __pyx_v_alpha) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_compression_chamber_index", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_compression_chamber_index (wrapper)", __pyx_f[0], 532, 0, <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_get_compression_chamber_index(__pyx_v_path, __pyx_v_alpha, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 532, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.get_compression_chamber_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">533</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">534</span>:     Return the index for the compression chamber with integers</pre>
<pre class="cython line score-0">&#xA0;<span class="">535</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">536</span>:     return 1000*path+alpha</pre>
<pre class='cython code score-0 '>  __pyx_r = ((0x3E8 * __pyx_v_path) + __pyx_v_alpha);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">537</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">538</span>: #This is a list of all the members in geoVals</pre>
<pre class="cython line score-93" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">539</span>: geoValsvarlist=['h','ro','rb','t',</pre>
<pre class='cython code score-93 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(41);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 539, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_h);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_h);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_h);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ro);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ro);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_ro);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_rb);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_rb);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_s_rb);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, __pyx_n_s_t);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_fi0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_fi0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, __pyx_n_s_phi_fi0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_fis);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_fis);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, __pyx_n_s_phi_fis);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_fie);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_fie);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 6, __pyx_n_s_phi_fie);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_fo0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_fo0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 7, __pyx_n_s_phi_fo0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_fos);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_fos);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 8, __pyx_n_s_phi_fos);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_foe);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_foe);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 9, __pyx_n_s_phi_foe);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_oi0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_oi0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 10, __pyx_n_s_phi_oi0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_ois);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_ois);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 11, __pyx_n_s_phi_ois);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_oie);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_oie);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 12, __pyx_n_s_phi_oie);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_oo0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_oo0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 13, __pyx_n_s_phi_oo0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_oos);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_oos);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 14, __pyx_n_s_phi_oos);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_ooe);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_ooe);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 15, __pyx_n_s_phi_ooe);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_xa_arc1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_xa_arc1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 16, __pyx_n_s_xa_arc1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ya_arc1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ya_arc1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 17, __pyx_n_s_ya_arc1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ra_arc1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ra_arc1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 18, __pyx_n_s_ra_arc1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t1_arc1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t1_arc1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 19, __pyx_n_s_t1_arc1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t2_arc1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t2_arc1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 20, __pyx_n_s_t2_arc1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_xa_arc2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_xa_arc2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 21, __pyx_n_s_xa_arc2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ya_arc2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ya_arc2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 22, __pyx_n_s_ya_arc2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ra_arc2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ra_arc2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 23, __pyx_n_s_ra_arc2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t1_arc2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t1_arc2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 24, __pyx_n_s_t1_arc2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t2_arc2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t2_arc2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 25, __pyx_n_s_t2_arc2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_b_line);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_b_line);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 26, __pyx_n_s_b_line);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t1_line);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t1_line);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 27, __pyx_n_s_t1_line);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t2_line);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t2_line);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 28, __pyx_n_s_t2_line);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_m_line);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_m_line);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 29, __pyx_n_s_m_line);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_x0_wall);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_x0_wall);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 30, __pyx_n_s_x0_wall);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_y0_wall);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_y0_wall);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 31, __pyx_n_s_y0_wall);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_r_wall);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_r_wall);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 32, __pyx_n_s_r_wall);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_delta_radial);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_delta_radial);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 33, __pyx_n_s_delta_radial);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_delta_flank);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_delta_flank);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 34, __pyx_n_s_delta_flank);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_phi_ie_offset);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_phi_ie_offset);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 35, __pyx_n_s_phi_ie_offset);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_delta_suction_offset);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_delta_suction_offset);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 36, __pyx_n_s_delta_suction_offset);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_cx_scroll);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_cx_scroll);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 37, __pyx_n_s_cx_scroll);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_cy_scroll);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_cy_scroll);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 38, __pyx_n_s_cy_scroll);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_V_scroll);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_V_scroll);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 39, __pyx_n_s_V_scroll);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Vremove);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Vremove);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 40, __pyx_n_s_Vremove);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_geoValsvarlist, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 539, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">540</span>:                 'phi_fi0','phi_fis','phi_fie',</pre>
<pre class="cython line score-0">&#xA0;<span class="">541</span>:                 'phi_fo0','phi_fos','phi_foe',</pre>
<pre class="cython line score-0">&#xA0;<span class="">542</span>:                 'phi_oi0','phi_ois','phi_oie',</pre>
<pre class="cython line score-0">&#xA0;<span class="">543</span>:                 'phi_oo0','phi_oos','phi_ooe',</pre>
<pre class="cython line score-0">&#xA0;<span class="">544</span>:                 'xa_arc1','ya_arc1','ra_arc1','t1_arc1','t2_arc1',</pre>
<pre class="cython line score-0">&#xA0;<span class="">545</span>:                 'xa_arc2','ya_arc2','ra_arc2','t1_arc2','t2_arc2',</pre>
<pre class="cython line score-0">&#xA0;<span class="">546</span>:                 'b_line', 't1_line', 't2_line', 'm_line',</pre>
<pre class="cython line score-0">&#xA0;<span class="">547</span>:                 'x0_wall','y0_wall','r_wall',</pre>
<pre class="cython line score-0">&#xA0;<span class="">548</span>:                 'delta_radial', 'delta_flank',</pre>
<pre class="cython line score-0">&#xA0;<span class="">549</span>:                 'phi_ie_offset','delta_suction_offset',</pre>
<pre class="cython line score-0">&#xA0;<span class="">550</span>:                 'cx_scroll','cy_scroll','V_scroll','Vremove']</pre>
<pre class="cython line score-0">&#xA0;<span class="">551</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">552</span>: def rebuild_geoVals(d):</pre>
<pre class='cython code score-19 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_37rebuild_geoVals(PyObject *__pyx_self, PyObject *__pyx_v_d); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_36rebuild_geoVals[] = "rebuild_geoVals(d)";
static PyMethodDef __pyx_mdef_5PDSim_6scroll_17common_scroll_geo_37rebuild_geoVals = {"rebuild_geoVals", (PyCFunction)__pyx_pw_5PDSim_6scroll_17common_scroll_geo_37rebuild_geoVals, METH_O, __pyx_doc_5PDSim_6scroll_17common_scroll_geo_36rebuild_geoVals};
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_37rebuild_geoVals(PyObject *__pyx_self, PyObject *__pyx_v_d) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rebuild_geoVals (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_36rebuild_geoVals(__pyx_self, ((PyObject *)__pyx_v_d));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_36rebuild_geoVals(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_d) {
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = NULL;
  PyObject *__pyx_v_atr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__11)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rebuild_geoVals", 0);
  <span class='trace'>__Pyx_TraceCall</span>("rebuild_geoVals", __pyx_f[0], 552, 0, <span class='error_goto'>__PYX_ERR(0, 552, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.rebuild_geoVals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_geo);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_atr);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__28 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_d, __pyx_n_s_geo, __pyx_n_s_atr);<span class='error_goto'> if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__28);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_5PDSim_6scroll_17common_scroll_geo_37rebuild_geoVals, NULL, __pyx_n_s_PDSim_scroll_common_scroll_geo);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_rebuild_geoVals, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 552, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__11 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_PDSim_scroll_common_scroll_geo_p, __pyx_n_s_rebuild_geoVals, 552, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">553</span>:     geo = geoVals()</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(((PyObject *)__pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 553, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">554</span>:     for atr in geoValsvarlist:</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_geoValsvarlist);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 554, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 554, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 554, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 554, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 554, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 554, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atr, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">555</span>:         setattr(geo,atr,d[atr])</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_d, __pyx_v_atr);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 555, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyObject_SetAttr</span>(((PyObject *)__pyx_v_geo), __pyx_v_atr, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 555, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">556</span>:     return geo</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_geo));
  __pyx_r = ((PyObject *)__pyx_v_geo);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">557</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">558</span>: cdef class geoVals:</pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_5PDSim_6scroll_17common_scroll_geo_geoVals {
  int (*is_symmetric)(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *, int __pyx_skip_dispatch);
  double (*val_if_symmetric)(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *, double, int __pyx_skip_dispatch);
  PyObject *(*copy_inplace)(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *, int __pyx_skip_dispatch);
};
static struct __pyx_vtabstruct_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_vtabptr_5PDSim_6scroll_17common_scroll_geo_geoVals;
</pre><pre class="cython line score-0">&#xA0;<span class="">559</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">560</span>:     def __init__(self):</pre>
<pre class='cython code score-13 '>/* Python wrapper */
static int __pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals___init__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals___init__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 560, 0, <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">561</span>:         self.phi_ie_offset = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;phi_ie_offset = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">562</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">563</span>:     def __reduce__(self):</pre>
<pre class='cython code score-7 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_3__reduce__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_7geoVals_2__reduce__[] = "geoVals.__reduce__(self)";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_3__reduce__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__reduce__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_2__reduce__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_2__reduce__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self) {
  PyObject *__pyx_v_d = NULL;
  PyObject *__pyx_v_atr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__reduce__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__reduce__", __pyx_f[0], 563, 0, <span class='error_goto'>__PYX_ERR(0, 563, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.__reduce__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_d);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_atr);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">564</span>:         d={}</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 564, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_d = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">565</span>:         for atr in geoValsvarlist:</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_geoValsvarlist);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 565, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 565, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 565, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 565, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 565, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atr, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">566</span>:             d[atr]=getattr(self,atr)</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_v_atr);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_d, __pyx_v_atr, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">567</span>:         return rebuild_geoVals,(d,)</pre>
<pre class='cython code score-17 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_rebuild_geoVals);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_d);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_d);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_d);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_1);
  __pyx_t_2 = 0;
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">568</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">569</span>:     def __repr__(self):</pre>
<pre class='cython code score-8 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_5__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_5__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_4__repr__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_4__repr__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self) {
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_v_atr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__repr__", __pyx_f[0], 569, 0, <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_atr);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">570</span>:         s='geoVals instance at '+str(id(self))+'\n'</pre>
<pre class='cython code score-17 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_id, ((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_geoVals_instance_at, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_kp_s__8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_s = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">571</span>:         for atr in geoValsvarlist:</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_geoValsvarlist);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atr, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">572</span>:             s+=atr+': '+str(getattr(self,atr))+'\n'</pre>
<pre class='cython code score-30 '>    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_atr, __pyx_kp_s__12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_v_atr);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_kp_s__8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">573</span>:         return s</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_s);
  __pyx_r = __pyx_v_s;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">574</span>: </pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">575</span>:     cpdef double val_if_symmetric(self, double val) except *:</pre>
<pre class='cython code score-64 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_7val_if_symmetric(PyObject *__pyx_v_self, PyObject *__pyx_arg_val); /*proto*/
static double __pyx_f_5PDSim_6scroll_17common_scroll_geo_7geoVals_val_if_symmetric(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self, double __pyx_v_val, int __pyx_skip_dispatch) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("val_if_symmetric", 0);
  <span class='trace'>__Pyx_TraceCall</span>("val_if_symmetric", __pyx_f[0], 575, 0, <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_val_if_symmetric);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_7val_if_symmetric)) {
        __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_val);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_5)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          }
        }
        __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_6 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_6 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_6;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.val_if_symmetric", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_7val_if_symmetric(PyObject *__pyx_v_self, PyObject *__pyx_arg_val); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_7geoVals_6val_if_symmetric[] = "geoVals.val_if_symmetric(self, double val) -&gt; double\n Returns the value if symmetric, throws ValueError otherwise ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_7val_if_symmetric(PyObject *__pyx_v_self, PyObject *__pyx_arg_val) {
  double __pyx_v_val;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("val_if_symmetric (wrapper)", 0);
  assert(__pyx_arg_val); {
    __pyx_v_val = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_arg_val); if (unlikely((__pyx_v_val == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.val_if_symmetric", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6val_if_symmetric(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self), ((double)__pyx_v_val));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6val_if_symmetric(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self, double __pyx_v_val) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("val_if_symmetric", 0);
  <span class='trace'>__Pyx_TraceCall</span>("val_if_symmetric (wrapper)", __pyx_f[0], 575, 0, <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_7geoVals_val_if_symmetric(__pyx_v_self, __pyx_v_val, 1);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.val_if_symmetric", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">576</span>:         """ Returns the value if symmetric, throws ValueError otherwise """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">577</span>:         if self.is_symmetric():</pre>
<pre class='cython code score-0 '>  __pyx_t_7 = (((struct __pyx_vtabstruct_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self-&gt;__pyx_vtab)-&gt;is_symmetric(__pyx_v_self, 0) != 0);
  if (likely(__pyx_t_7)) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">578</span>:             return val</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_val;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">579</span>:         else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">580</span>:             raise ValueError('Symmetric angle requested (phi_ie, phi_is, phi_i0, etc.) but the geometry is not symmetric')</pre>
<pre class='cython code score-10 '>  /*else*/ {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 580, __pyx_L1_error)</span>
  }
/* … */
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Symmetric_angle_requested_phi_ie);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
</pre><pre class="cython line score-0">&#xA0;<span class="">581</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">582</span>:     cpdef copy_inplace(self, geoVals target):</pre>
<pre class='cython code score-34 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_9copy_inplace(PyObject *__pyx_v_self, PyObject *__pyx_v_target); /*proto*/
static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo_7geoVals_copy_inplace(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_target, int __pyx_skip_dispatch) {
  PyObject *__pyx_v_atr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("copy_inplace", 0);
  <span class='trace'>__Pyx_TraceCall</span>("copy_inplace", __pyx_f[0], 582, 0, <span class='error_goto'>__PYX_ERR(0, 582, __pyx_L1_error)</span>);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_copy_inplace);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 582, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_9copy_inplace)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_target)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, ((PyObject *)__pyx_v_target));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 582, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_r = __pyx_t_2;
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.copy_inplace", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_atr);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_9copy_inplace(PyObject *__pyx_v_self, PyObject *__pyx_v_target); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_7geoVals_8copy_inplace[] = "geoVals.copy_inplace(self, geoVals target)\n\n        For a provided target class, copy over all attributes\n        ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_9copy_inplace(PyObject *__pyx_v_self, PyObject *__pyx_v_target) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("copy_inplace (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_target), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "target", 0))) <span class='error_goto'>__PYX_ERR(0, 582, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_8copy_inplace(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self), ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_target));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_8copy_inplace(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_target) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("copy_inplace", 0);
  <span class='trace'>__Pyx_TraceCall</span>("copy_inplace (wrapper)", __pyx_f[0], 582, 0, <span class='error_goto'>__PYX_ERR(0, 582, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_7geoVals_copy_inplace(__pyx_v_self, __pyx_v_target, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 582, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.copy_inplace", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">583</span>:         """</pre>
<pre class="cython line score-0">&#xA0;<span class="">584</span>:         For a provided target class, copy over all attributes</pre>
<pre class="cython line score-0">&#xA0;<span class="">585</span>:         """</pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">586</span>:         for atr in geoValsvarlist:</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_geoValsvarlist);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 586, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 586, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atr, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">587</span>:             setattr(target,atr,getattr(self, atr))</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_v_atr);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 587, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='py_c_api'>PyObject_SetAttr</span>(((PyObject *)__pyx_v_target), __pyx_v_atr, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 587, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">588</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">589</span>:     property phi_ie:</pre>
<pre class="cython line score-0">&#xA0;<span class="">590</span>:         """ Inner Ending Angle """</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">591</span>:         def __get__(self):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_ie_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_ie_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_ie___get__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_ie___get__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[0], 591, 0, <span class='error_goto'>__PYX_ERR(0, 591, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.phi_ie.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">592</span>:             return self.val_if_symmetric(self.phi_fie)</pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self-&gt;__pyx_vtab)-&gt;val_if_symmetric(__pyx_v_self, __pyx_v_self-&gt;phi_fie, 0);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 592, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 592, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">593</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">594</span>:     property phi_is:</pre>
<pre class="cython line score-0">&#xA0;<span class="">595</span>:         """ Inner Starting Angle """</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">596</span>:         def __get__(self):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_is_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_is_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_is___get__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_is___get__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[0], 596, 0, <span class='error_goto'>__PYX_ERR(0, 596, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.phi_is.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">597</span>:             return self.val_if_symmetric(self.phi_fis)</pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self-&gt;__pyx_vtab)-&gt;val_if_symmetric(__pyx_v_self, __pyx_v_self-&gt;phi_fis, 0);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">598</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">599</span>:     property phi_i0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">600</span>:         """ Inner Initial Angle """</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">601</span>:         def __get__(self):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_i0_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_i0_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_i0___get__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_i0___get__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[0], 601, 0, <span class='error_goto'>__PYX_ERR(0, 601, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.phi_i0.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">602</span>:             return self.val_if_symmetric(self.phi_fi0)</pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self-&gt;__pyx_vtab)-&gt;val_if_symmetric(__pyx_v_self, __pyx_v_self-&gt;phi_fi0, 0);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 602, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 602, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">603</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">604</span>:     property phi_oe:</pre>
<pre class="cython line score-0">&#xA0;<span class="">605</span>:         """ Outer Ending Angle """</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">606</span>:         def __get__(self):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_oe_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_oe_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_oe___get__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_oe___get__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[0], 606, 0, <span class='error_goto'>__PYX_ERR(0, 606, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.phi_oe.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">607</span>:             return self.val_if_symmetric(self.phi_foe)</pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self-&gt;__pyx_vtab)-&gt;val_if_symmetric(__pyx_v_self, __pyx_v_self-&gt;phi_foe, 0);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 607, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 607, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">608</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">609</span>:     property phi_os:</pre>
<pre class="cython line score-0">&#xA0;<span class="">610</span>:         """ Outer Starting Angle """</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">611</span>:         def __get__(self):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_os_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_os_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_os___get__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_os___get__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[0], 611, 0, <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.phi_os.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">612</span>:             return self.val_if_symmetric(self.phi_fos)</pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self-&gt;__pyx_vtab)-&gt;val_if_symmetric(__pyx_v_self, __pyx_v_self-&gt;phi_fos, 0);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 612, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 612, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">613</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">614</span>:     property phi_o0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">615</span>:         """ Outer Initial Angle """</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">616</span>:         def __get__(self):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_o0_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_o0_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_o0___get__(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_6phi_o0___get__(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[0], 616, 0, <span class='error_goto'>__PYX_ERR(0, 616, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.phi_o0.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">617</span>:             return self.val_if_symmetric(self.phi_fo0)</pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self-&gt;__pyx_vtab)-&gt;val_if_symmetric(__pyx_v_self, __pyx_v_self-&gt;phi_fo0, 0);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 617, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 617, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">618</span>: </pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">619</span>:     cpdef bint is_symmetric(self):</pre>
<pre class='cython code score-41 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_11is_symmetric(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static int __pyx_f_5PDSim_6scroll_17common_scroll_geo_7geoVals_is_symmetric(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_symmetric", 0);
  <span class='trace'>__Pyx_TraceCall</span>("is_symmetric", __pyx_f[0], 619, 0, <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L1_error)</span>);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_is_symmetric);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_11is_symmetric)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.geoVals.is_symmetric", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_11is_symmetric(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_7geoVals_10is_symmetric[] = "geoVals.is_symmetric(self) -&gt; bool\n\n        Returns true if all the angles for the fixed scroll are the same as for the orbiting scroll\n        ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_7geoVals_11is_symmetric(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_symmetric (wrapper)", 0);
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_10is_symmetric(((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_7geoVals_10is_symmetric(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_symmetric", 0);
  <span class='trace'>__Pyx_TraceCall</span>("is_symmetric (wrapper)", __pyx_f[0], 619, 0, <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_7geoVals_is_symmetric(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.geoVals.is_symmetric", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">620</span>:         """</pre>
<pre class="cython line score-0">&#xA0;<span class="">621</span>:         Returns true if all the angles for the fixed scroll are the same as for the orbiting scroll</pre>
<pre class="cython line score-0">&#xA0;<span class="">622</span>:         """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">623</span>:         return (abs(self.phi_fi0-self.phi_oi0) &lt; 1e-14</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((fabs((__pyx_v_self-&gt;phi_fi0 - __pyx_v_self-&gt;phi_oi0)) &lt; 1e-14) != 0);
  if (__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L3_bool_binop_done;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">624</span>:                 and abs(self.phi_fis-self.phi_ois) &lt; 1e-14</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((fabs((__pyx_v_self-&gt;phi_fis - __pyx_v_self-&gt;phi_ois)) &lt; 1e-14) != 0);
  if (__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L3_bool_binop_done;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">625</span>:                 and abs(self.phi_fie-self.phi_oie) &lt; 1e-14</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((fabs((__pyx_v_self-&gt;phi_fie - __pyx_v_self-&gt;phi_oie)) &lt; 1e-14) != 0);
  if (__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L3_bool_binop_done;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">626</span>:                 and abs(self.phi_fo0-self.phi_oo0) &lt; 1e-14</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((fabs((__pyx_v_self-&gt;phi_fo0 - __pyx_v_self-&gt;phi_oo0)) &lt; 1e-14) != 0);
  if (__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L3_bool_binop_done;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">627</span>:                 and abs(self.phi_fos-self.phi_oos) &lt; 1e-14</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((fabs((__pyx_v_self-&gt;phi_fos - __pyx_v_self-&gt;phi_oos)) &lt; 1e-14) != 0);
  if (__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L3_bool_binop_done;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">628</span>:                 and abs(self.phi_foe-self.phi_ooe) &lt; 1e-14</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((fabs((__pyx_v_self-&gt;phi_foe - __pyx_v_self-&gt;phi_ooe)) &lt; 1e-14) != 0);
  __pyx_t_5 = __pyx_t_6;
  __pyx_L3_bool_binop_done:;
  __pyx_r = __pyx_t_5;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">629</span>:                 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">630</span>: </pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">631</span>: def polyarea(x,y):</pre>
<pre class='cython code score-48 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_39polyarea(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_38polyarea[] = "polyarea(x, y)";
static PyMethodDef __pyx_mdef_5PDSim_6scroll_17common_scroll_geo_39polyarea = {"polyarea", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_5PDSim_6scroll_17common_scroll_geo_39polyarea, METH_VARARGS|METH_KEYWORDS, __pyx_doc_5PDSim_6scroll_17common_scroll_geo_38polyarea};
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_39polyarea(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_y = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("polyarea (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("polyarea", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polyarea") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_x = values[0];
    __pyx_v_y = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("polyarea", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.polyarea", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_38polyarea(__pyx_self, __pyx_v_x, __pyx_v_y);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_38polyarea(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_v_N = NULL;
  PyObject *__pyx_v_area = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__14)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("polyarea", 0);
  <span class='trace'>__Pyx_TraceCall</span>("polyarea", __pyx_f[0], 631, 0, <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.polyarea", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_N);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_area);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_N, __pyx_n_s_area, __pyx_n_s_i, __pyx_n_s_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 631, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_5PDSim_6scroll_17common_scroll_geo_39polyarea, NULL, __pyx_n_s_PDSim_scroll_common_scroll_geo);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 631, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_polyarea, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__14 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_PDSim_scroll_common_scroll_geo_p, __pyx_n_s_polyarea, 631, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 631, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">632</span>:     N=len(x)</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 632, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_v_N = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">633</span>:     area = 0.0</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_0);
  __pyx_v_area = __pyx_float_0_0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">634</span>:     for i in range(N):</pre>
<pre class='cython code score-46 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 634, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_1 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_1 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 634, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 634, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_1 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_1); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_1++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 634, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_1); __pyx_t_1++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 634, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_1 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_1); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_1++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 634, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_1); __pyx_t_1++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 634, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 634, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">635</span>:         j = (i+1) % N</pre>
<pre class='cython code score-9 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_t_2, __pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">636</span>:         area = area + x[i]*y[j] - y[i]*x[j]</pre>
<pre class='cython code score-36 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_x, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y, __pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_area, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_x, __pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_area, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">637</span>:     return area/2.0</pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideObjC</span>(__pyx_v_area, __pyx_float_2_0, 2.0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">638</span>: </pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">639</span>: def polycentroid(xi,yi):</pre>
<pre class='cython code score-50 '>/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_41polycentroid(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_40polycentroid[] = "polycentroid(xi, yi)";
static PyMethodDef __pyx_mdef_5PDSim_6scroll_17common_scroll_geo_41polycentroid = {"polycentroid", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_5PDSim_6scroll_17common_scroll_geo_41polycentroid, METH_VARARGS|METH_KEYWORDS, __pyx_doc_5PDSim_6scroll_17common_scroll_geo_40polycentroid};
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_41polycentroid(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_xi = 0;
  PyObject *__pyx_v_yi = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("polycentroid (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xi,&amp;__pyx_n_s_yi,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xi)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_yi)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("polycentroid", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polycentroid") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_xi = values[0];
    __pyx_v_yi = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("polycentroid", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.polycentroid", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_40polycentroid(__pyx_self, __pyx_v_xi, __pyx_v_yi);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_40polycentroid(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_xi, PyObject *__pyx_v_yi) {
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_v_sumx = NULL;
  PyObject *__pyx_v_sumy = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__15)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("polycentroid", 0);
  <span class='trace'>__Pyx_TraceCall</span>("polycentroid", __pyx_f[0], 639, 0, <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.polycentroid", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sumx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sumy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__30 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_xi, __pyx_n_s_yi, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_sumx, __pyx_n_s_sumy, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__30);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_5PDSim_6scroll_17common_scroll_geo_41polycentroid, NULL, __pyx_n_s_PDSim_scroll_common_scroll_geo);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_polycentroid, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__15 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__30, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_PDSim_scroll_common_scroll_geo_p, __pyx_n_s_polycentroid, 639, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">640</span>:     # Add additional element if needed to close polygon</pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">641</span>:     if not xi[0]==xi[-1] or not yi[0]==yi[-1]:</pre>
<pre class='cython code score-28 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_xi, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_xi, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_1 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_yi, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_yi, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = ((!__pyx_t_6) != 0);
  __pyx_t_1 = __pyx_t_5;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">642</span>:         x=np.r_[xi,xi[-1]]</pre>
<pre class='cython code score-19 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 642, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_r);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 642, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_xi, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 642, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 642, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xi);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xi);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_xi);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 642, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_x = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">643</span>:         y=np.r_[yi,yi[-1]]</pre>
<pre class='cython code score-19 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_r);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_yi, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_yi);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_yi);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_yi);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_y = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">644</span>:     else:</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">645</span>:         x=xi</pre>
<pre class='cython code score-1 '>  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xi);
    __pyx_v_x = __pyx_v_xi;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">646</span>:         y=yi</pre>
<pre class='cython code score-1 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_yi);
    __pyx_v_y = __pyx_v_yi;
  }
  __pyx_L3:;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">647</span>:     sumx=0.0</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_0);
  __pyx_v_sumx = __pyx_float_0_0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">648</span>:     sumy=0.0</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_0);
  __pyx_v_sumy = __pyx_float_0_0;
</pre><pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">649</span>:     for i in range(len(x)-1):</pre>
<pre class='cython code score-57 '>  __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 649, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_t_7 - 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 649, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 649, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_2 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 649, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_8 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 649, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 649, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 649, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 649, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 649, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_8(__pyx_t_2);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 649, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">650</span>:         sumx=sumx+(x[i]+x[i+1])*(x[i]*y[i+1]-x[i+1]*y[i])</pre>
<pre class='cython code score-63 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_x, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_x, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_x, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_x, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_sumx, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sumx, __pyx_t_10);
    __pyx_t_10 = 0;
</pre><pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">651</span>:         sumy=sumy+(y[i]+y[i+1])*(x[i]*y[i+1]-x[i+1]*y[i])</pre>
<pre class='cython code score-63 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_x, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_x, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_10, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_11, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_sumy, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sumy, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-104" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">652</span>:     return sumx/(6*polyarea(x,y)),sumy/(6*polyarea(x,y))</pre>
<pre class='cython code score-104 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_polyarea);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_9 = NULL;
  __pyx_t_12 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_12 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_v_x, __pyx_v_y};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_v_x, __pyx_v_y};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else
  #endif
  {
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (__pyx_t_9) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_12, __pyx_v_x);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_12, __pyx_v_y);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_sumx, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_polyarea);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_9 = NULL;
  __pyx_t_12 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
      __pyx_t_12 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_11)) {
    PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_v_x, __pyx_v_y};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_11, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_11)) {
    PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_v_x, __pyx_v_y};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_11, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else
  #endif
  {
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (__pyx_t_9) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_9); __pyx_t_9 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_12, __pyx_v_x);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_12, __pyx_v_y);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_sumy, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_r = __pyx_t_11;
  __pyx_t_11 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">653</span>: </pre>
<pre class="cython line score-83" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">654</span>: cpdef tuple _coords_inv_np(np.ndarray[np.float_t] phi, geoVals geo,double theta, flag=""):</pre>
<pre class='cython code score-83 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_43_coords_inv_np(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_np(PyArrayObject *__pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_5PDSim_6scroll_17common_scroll_geo__coords_inv_np *__pyx_optional_args) {
  PyObject *__pyx_v_flag = ((PyObject *)__pyx_kp_s_);
  double __pyx_v_rb;
  double __pyx_v_ro;
  double __pyx_v_om;
  PyObject *__pyx_v_key = 0;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_y = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_phi;
  __Pyx_Buffer __pyx_pybuffer_phi;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_coords_inv_np", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_coords_inv_np", __pyx_f[0], 654, 0, <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_flag = __pyx_optional_args-&gt;flag;
    }
  }
  __pyx_pybuffer_phi.pybuffer.buf = NULL;
  __pyx_pybuffer_phi.refcount = 0;
  __pyx_pybuffernd_phi.data = NULL;
  __pyx_pybuffernd_phi.rcbuffer = &amp;__pyx_pybuffer_phi;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_phi, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_phi.diminfo[0].strides = __pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_phi.diminfo[0].shape = __pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo._coords_inv_np", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_key);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_43_coords_inv_np(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_42_coords_inv_np[] = "_coords_inv_np(ndarray phi, geoVals geo, double theta, flag='') -&gt; tuple\n\n    Internal function that does the calculation if phi is definitely a 1D numpy vector\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_43_coords_inv_np(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_phi = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  PyObject *__pyx_v_flag = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_coords_inv_np (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_phi,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_flag,0};
    PyObject* values[4] = {0,0,0,0};
    values[3] = ((PyObject *)__pyx_kp_s_);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_coords_inv_np", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_coords_inv_np", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_flag);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_coords_inv_np") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_phi = ((PyArrayObject *)values[0]);
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L3_error)</span>
    __pyx_v_flag = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_coords_inv_np", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo._coords_inv_np", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_phi), __pyx_ptype_5numpy_ndarray, 1, "phi", 0))) <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_42_coords_inv_np(__pyx_self, __pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_flag);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_42_coords_inv_np(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, PyObject *__pyx_v_flag) {
  __Pyx_LocalBuf_ND __pyx_pybuffernd_phi;
  __Pyx_Buffer __pyx_pybuffer_phi;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_coords_inv_np", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_coords_inv_np (wrapper)", __pyx_f[0], 654, 0, <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L1_error)</span>);
  __pyx_pybuffer_phi.pybuffer.buf = NULL;
  __pyx_pybuffer_phi.refcount = 0;
  __pyx_pybuffernd_phi.data = NULL;
  __pyx_pybuffernd_phi.rcbuffer = &amp;__pyx_pybuffer_phi;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_phi, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_phi.diminfo[0].strides = __pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_phi.diminfo[0].shape = __pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer.shape[0];
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.flag = __pyx_v_flag;
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_np(((PyArrayObject *)__pyx_v_phi), __pyx_v_geo, __pyx_v_theta, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo._coords_inv_np", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">655</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">656</span>:     Internal function that does the calculation if phi is definitely a 1D numpy vector</pre>
<pre class="cython line score-0">&#xA0;<span class="">657</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">658</span>:     rb = geo.rb</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_geo-&gt;rb;
  __pyx_v_rb = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">659</span>:     ro = rb*(pi - geo.phi_fi0 + geo.phi_oo0)</pre>
<pre class='cython code score-0 '>  __pyx_v_ro = (__pyx_v_rb * ((M_PI - __pyx_v_geo-&gt;phi_fi0) + __pyx_v_geo-&gt;phi_oo0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">660</span>:     om = geo.phi_fie - theta + 3.0*pi/2.0</pre>
<pre class='cython code score-0 '>  __pyx_v_om = ((__pyx_v_geo-&gt;phi_fie - __pyx_v_theta) + ((3.0 * M_PI) / 2.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">661</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">662</span>:     cdef bytes key</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">663</span>:     try:</pre>
<pre class='cython code score-10 '>  {
    /*try:*/ {
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L8_try_end;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/* … */
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);
    goto __pyx_L1_error;
    __pyx_L4_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);
    __pyx_L8_try_end:;
  }
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">664</span>:         key = flag.encode('utf8')</pre>
<pre class='cython code score-26 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_flag, __pyx_n_s_encode);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 664, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        }
      }
      __pyx_t_5 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_n_s_utf8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_n_s_utf8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 664, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_t_5))||((__pyx_t_5) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_5)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 664, __pyx_L3_error)</span>
      __pyx_v_key = ((PyObject*)__pyx_t_5);
      __pyx_t_5 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">665</span>:     except AttributeError:</pre>
<pre class='cython code score-6 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(__pyx_builtin_AttributeError);
    if (__pyx_t_8) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo._coords_inv_np", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_5, &amp;__pyx_t_6, &amp;__pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 665, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">666</span>:         key = flag</pre>
<pre class='cython code score-15 '>      if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_v_flag))||((__pyx_v_flag) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_v_flag)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 666, __pyx_L5_except_error)</span>
      __pyx_t_9 = __pyx_v_flag;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_key, ((PyObject*)__pyx_t_9));
      __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L4_exception_handled;
    }
    goto __pyx_L5_except_error;
    __pyx_L5_except_error:;
</pre><pre class="cython line score-0">&#xA0;<span class="">667</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">668</span>:     if key == b"fi":</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_fi, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 668, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_10 != 0);
  if (__pyx_t_11) {
/* … */
    goto __pyx_L11;
  }
</pre><pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">669</span>:         x = rb*np.cos(phi)+rb*(phi-geo.phi_fi0)*np.sin(phi)</pre>
<pre class='cython code score-87 '>    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rb);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_5, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rb);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;phi_fi0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_phi), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
      }
    }
    __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_6, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_v_x = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">670</span>:         y = rb*np.sin(phi)-rb*(phi-geo.phi_fi0)*np.cos(phi)</pre>
<pre class='cython code score-87 '>    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rb);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    __pyx_t_12 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_9, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rb);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;phi_fi0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_phi), __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_12, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_9 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_12, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_7, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_y = __pyx_t_9;
    __pyx_t_9 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">671</span>:     elif key == b"fo":</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_fo, Py_EQ)); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 671, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_11 != 0);
  if (__pyx_t_10) {
/* … */
    goto __pyx_L11;
  }
</pre><pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">672</span>:         x = rb*np.cos(phi)+rb*(phi-geo.phi_fo0)*np.sin(phi)</pre>
<pre class='cython code score-87 '>    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rb);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_6 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rb);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;phi_fo0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_phi), __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
      }
    }
    __pyx_t_7 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_6, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_v_x = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">673</span>:         y = rb*np.sin(phi)-rb*(phi-geo.phi_fo0)*np.cos(phi)</pre>
<pre class='cython code score-87 '>    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rb);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    __pyx_t_12 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_5, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rb);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;phi_fo0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_phi), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_12, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_5 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_12, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_y = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">674</span>:     elif key == b"oi":</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_oi, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 674, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_10 != 0);
  if (__pyx_t_11) {
/* … */
    goto __pyx_L11;
  }
</pre><pre class="cython line score-131" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">675</span>:         x = -rb*np.cos(phi)-rb*(phi-geo.phi_oi0)*np.sin(phi)+ro*np.cos(om)</pre>
<pre class='cython code score-131 '>    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((-__pyx_v_rb));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_9, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rb);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;phi_oi0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_phi), __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
      }
    }
    __pyx_t_9 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_6, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_7, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ro);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_om);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_13 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_7 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_13, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_x = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-131" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">676</span>:         y = -rb*np.sin(phi)+rb*(phi-geo.phi_oi0)*np.cos(phi)+ro*np.sin(om)</pre>
<pre class='cython code score-131 '>    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((-__pyx_v_rb));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
      }
    }
    __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_9, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rb);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;phi_oi0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_phi), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_9 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_12, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ro);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_om);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_13 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_12 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_13, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_y = __pyx_t_12;
    __pyx_t_12 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">677</span>:     elif key == b"oo":</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_oo, Py_EQ)); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 677, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_11 != 0);
  if (likely(__pyx_t_10)) {
/* … */
    goto __pyx_L11;
  }
</pre><pre class="cython line score-131" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">678</span>:         x = -rb*np.cos(phi)-rb*(phi-geo.phi_oo0)*np.sin(phi)+ro*np.cos(om)</pre>
<pre class='cython code score-131 '>    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>((-__pyx_v_rb));<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_9, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rb);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;phi_oo0);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_phi), __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    __pyx_t_9 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_6, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_5, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ro);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_12, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_om);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_13 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_5 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_13, __pyx_t_12) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_x = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-131" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">679</span>:         y = -rb*np.sin(phi)+rb*(phi-geo.phi_oo0)*np.cos(phi)+ro*np.sin(om)</pre>
<pre class='cython code score-131 '>    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((-__pyx_v_rb));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_9, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rb);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_geo-&gt;phi_oo0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_phi), __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
      }
    }
    __pyx_t_9 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_6, ((PyObject *)__pyx_v_phi)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, ((PyObject *)__pyx_v_phi));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ro);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_om);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_13 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_7 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_13, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_y = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">680</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">681</span>:         raise ValueError('flag not valid')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 681, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L1_error)</span>
  }
  __pyx_L11:;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">682</span>:     return (x,y)</pre>
<pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_y);
  __pyx_r = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">683</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">684</span>: cdef _coords_inv_d_int(double phi, geoVals geo,double theta, int flag, double *x, double *y):</pre>
<pre class='cython code score-4 '>static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d_int(double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, int __pyx_v_flag, double *__pyx_v_x, double *__pyx_v_y) {
  double __pyx_v_rb;
  double __pyx_v_ro;
  double __pyx_v_om;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_coords_inv_d_int", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_coords_inv_d_int", __pyx_f[0], 684, 0, <span class='error_goto'>__PYX_ERR(0, 684, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo._coords_inv_d_int", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">685</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">686</span>:     Internal function that does the calculation if phi is a double variable</pre>
<pre class="cython line score-0">&#xA0;<span class="">687</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">688</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">689</span>:     rb = geo.rb</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_geo-&gt;rb;
  __pyx_v_rb = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">690</span>:     ro = rb*(pi - geo.phi_fi0 + geo.phi_oo0)</pre>
<pre class='cython code score-0 '>  __pyx_v_ro = (__pyx_v_rb * ((M_PI - __pyx_v_geo-&gt;phi_fi0) + __pyx_v_geo-&gt;phi_oo0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">691</span>:     om = geo.phi_fie - theta + 3.0*pi/2.0</pre>
<pre class='cython code score-0 '>  __pyx_v_om = ((__pyx_v_geo-&gt;phi_fie - __pyx_v_theta) + ((3.0 * M_PI) / 2.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">692</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">693</span>:     if flag == INVOLUTE_FI:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_flag) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">694</span>:         x[0] = rb*cos(phi)+rb*(phi-geo.phi_fi0)*sin(phi)</pre>
<pre class='cython code score-0 '>    (__pyx_v_x[0]) = ((__pyx_v_rb * cos(__pyx_v_phi)) + ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_fi0)) * sin(__pyx_v_phi)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">695</span>:         y[0] = rb*sin(phi)-rb*(phi-geo.phi_fi0)*cos(phi)</pre>
<pre class='cython code score-0 '>    (__pyx_v_y[0]) = ((__pyx_v_rb * sin(__pyx_v_phi)) - ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_fi0)) * cos(__pyx_v_phi)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">696</span>:     elif flag == INVOLUTE_FO:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">697</span>:         x[0] = rb*cos(phi)+rb*(phi-geo.phi_fo0)*sin(phi)</pre>
<pre class='cython code score-0 '>    (__pyx_v_x[0]) = ((__pyx_v_rb * cos(__pyx_v_phi)) + ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_fo0)) * sin(__pyx_v_phi)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">698</span>:         y[0] = rb*sin(phi)-rb*(phi-geo.phi_fo0)*cos(phi)</pre>
<pre class='cython code score-0 '>    (__pyx_v_y[0]) = ((__pyx_v_rb * sin(__pyx_v_phi)) - ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_fo0)) * cos(__pyx_v_phi)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">699</span>:     elif flag == INVOLUTE_OI:</pre>
<pre class='cython code score-0 '>    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">700</span>:         x[0] = -rb*cos(phi)-rb*(phi-geo.phi_oi0)*sin(phi)+ro*cos(om)</pre>
<pre class='cython code score-0 '>    (__pyx_v_x[0]) = ((((-__pyx_v_rb) * cos(__pyx_v_phi)) - ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_oi0)) * sin(__pyx_v_phi))) + (__pyx_v_ro * cos(__pyx_v_om)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">701</span>:         y[0] = -rb*sin(phi)+rb*(phi-geo.phi_oi0)*cos(phi)+ro*sin(om)</pre>
<pre class='cython code score-0 '>    (__pyx_v_y[0]) = ((((-__pyx_v_rb) * sin(__pyx_v_phi)) + ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_oi0)) * cos(__pyx_v_phi))) + (__pyx_v_ro * sin(__pyx_v_om)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">702</span>:     elif flag == INVOLUTE_OO:</pre>
<pre class='cython code score-0 '>    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">703</span>:         x[0] = -rb*cos(phi)-rb*(phi-geo.phi_oo0)*sin(phi)+ro*cos(om)</pre>
<pre class='cython code score-0 '>    (__pyx_v_x[0]) = ((((-__pyx_v_rb) * cos(__pyx_v_phi)) - ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_oo0)) * sin(__pyx_v_phi))) + (__pyx_v_ro * cos(__pyx_v_om)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">704</span>:         y[0] = -rb*sin(phi)+rb*(phi-geo.phi_oo0)*cos(phi)+ro*sin(om)</pre>
<pre class='cython code score-0 '>    (__pyx_v_y[0]) = ((((-__pyx_v_rb) * sin(__pyx_v_phi)) + ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_oo0)) * cos(__pyx_v_phi))) + (__pyx_v_ro * sin(__pyx_v_om)));
</pre><pre class="cython line score-0">&#xA0;<span class="">705</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">706</span>:         raise ValueError('flag not valid')</pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 706, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 706, __pyx_L1_error)</span>
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">707</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">708</span>: cdef _dcoords_inv_dphi_int(double phi, geoVals geo,double theta, int flag, double *dxdphi, double *dydphi):</pre>
<pre class='cython code score-4 '>static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo__dcoords_inv_dphi_int(double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, CYTHON_UNUSED double __pyx_v_theta, int __pyx_v_flag, double *__pyx_v_dxdphi, double *__pyx_v_dydphi) {
  double __pyx_v_phi_0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_dcoords_inv_dphi_int", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_dcoords_inv_dphi_int", __pyx_f[0], 708, 0, <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo._dcoords_inv_dphi_int", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">709</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">710</span>:     Internal function that does the calculation for derivatives with respect to phi</pre>
<pre class="cython line score-0">&#xA0;<span class="">711</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">712</span>:     cdef double phi_0</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">713</span>:     if flag == INVOLUTE_FI or flag == INVOLUTE_FO:</pre>
<pre class='cython code score-0 '>  switch (__pyx_v_flag) {
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI:
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FO:
/* … */
    break;
    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">714</span>:         if flag == INVOLUTE_FI:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_flag == __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_FI) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L3;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">715</span>:             phi_0 = geo.phi_fi0</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_geo-&gt;phi_fi0;
      __pyx_v_phi_0 = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">716</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">717</span>:             phi_0 = geo.phi_fo0</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_2 = __pyx_v_geo-&gt;phi_fo0;
      __pyx_v_phi_0 = __pyx_t_2;
    }
    __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">718</span>:         dxdphi[0] = geo.rb*(phi-phi_0)*cos(phi)</pre>
<pre class='cython code score-0 '>    (__pyx_v_dxdphi[0]) = ((__pyx_v_geo-&gt;rb * (__pyx_v_phi - __pyx_v_phi_0)) * cos(__pyx_v_phi));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">719</span>:         dydphi[0] = geo.rb*(phi-phi_0)*sin(phi)</pre>
<pre class='cython code score-0 '>    (__pyx_v_dydphi[0]) = ((__pyx_v_geo-&gt;rb * (__pyx_v_phi - __pyx_v_phi_0)) * sin(__pyx_v_phi));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">720</span>:     elif flag == INVOLUTE_OI or flag == INVOLUTE_OO:</pre>
<pre class='cython code score-0 '>    case __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OO:
/* … */
    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">721</span>:         if flag == INVOLUTE_OI:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_flag == __pyx_e_5PDSim_6scroll_17common_scroll_geo_INVOLUTE_OI) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">722</span>:             phi_0 = geo.phi_oi0</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_geo-&gt;phi_oi0;
      __pyx_v_phi_0 = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">723</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">724</span>:             phi_0 = geo.phi_oo0</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_2 = __pyx_v_geo-&gt;phi_oo0;
      __pyx_v_phi_0 = __pyx_t_2;
    }
    __pyx_L4:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">725</span>:         dxdphi[0] = -geo.rb*(phi-phi_0)*cos(phi)</pre>
<pre class='cython code score-0 '>    (__pyx_v_dxdphi[0]) = (((-__pyx_v_geo-&gt;rb) * (__pyx_v_phi - __pyx_v_phi_0)) * cos(__pyx_v_phi));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">726</span>:         dydphi[0] = -geo.rb*(phi-phi_0)*sin(phi)</pre>
<pre class='cython code score-0 '>    (__pyx_v_dydphi[0]) = (((-__pyx_v_geo-&gt;rb) * (__pyx_v_phi - __pyx_v_phi_0)) * sin(__pyx_v_phi));
</pre><pre class="cython line score-0">&#xA0;<span class="">727</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">728</span>:         raise ValueError('flag not valid')</pre>
<pre class='cython code score-5 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">729</span>: </pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">730</span>: cpdef tuple _coords_inv_d(double phi, geoVals geo,double theta, flag=""):</pre>
<pre class='cython code score-67 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_45_coords_inv_d(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d(double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_5PDSim_6scroll_17common_scroll_geo__coords_inv_d *__pyx_optional_args) {
  PyObject *__pyx_v_flag = ((PyObject *)__pyx_kp_s_);
  double __pyx_v_rb;
  double __pyx_v_ro;
  double __pyx_v_om;
  PyObject *__pyx_v_key = 0;
  double __pyx_v_x;
  double __pyx_v_y;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_coords_inv_d", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_coords_inv_d", __pyx_f[0], 730, 0, <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_flag = __pyx_optional_args-&gt;flag;
    }
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo._coords_inv_d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_45_coords_inv_d(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_44_coords_inv_d[] = "_coords_inv_d(double phi, geoVals geo, double theta, flag='') -&gt; tuple\n\n    Internal function that does the calculation if phi is a double variable \n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_45_coords_inv_d(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_phi;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  PyObject *__pyx_v_flag = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_coords_inv_d (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_phi,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_flag,0};
    PyObject* values[4] = {0,0,0,0};
    values[3] = ((PyObject *)__pyx_kp_s_);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_coords_inv_d", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_coords_inv_d", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_flag);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_coords_inv_d") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_phi = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_phi == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L3_error)</span>
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L3_error)</span>
    __pyx_v_flag = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_coords_inv_d", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo._coords_inv_d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_44_coords_inv_d(__pyx_self, __pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_flag);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_44_coords_inv_d(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, PyObject *__pyx_v_flag) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_coords_inv_d", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_coords_inv_d (wrapper)", __pyx_f[0], 730, 0, <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.flag = __pyx_v_flag;
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d(__pyx_v_phi, __pyx_v_geo, __pyx_v_theta, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo._coords_inv_d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">731</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">732</span>:     Internal function that does the calculation if phi is a double variable</pre>
<pre class="cython line score-0">&#xA0;<span class="">733</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">734</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">735</span>:     rb = geo.rb</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_geo-&gt;rb;
  __pyx_v_rb = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">736</span>:     ro = rb*(pi - geo.phi_fi0 + geo.phi_oo0)</pre>
<pre class='cython code score-0 '>  __pyx_v_ro = (__pyx_v_rb * ((M_PI - __pyx_v_geo-&gt;phi_fi0) + __pyx_v_geo-&gt;phi_oo0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">737</span>:     om = geo.phi_fie - theta + 3.0*pi/2.0</pre>
<pre class='cython code score-0 '>  __pyx_v_om = ((__pyx_v_geo-&gt;phi_fie - __pyx_v_theta) + ((3.0 * M_PI) / 2.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">738</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">739</span>:     cdef bytes key</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">740</span>:     try:</pre>
<pre class='cython code score-10 '>  {
    /*try:*/ {
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L8_try_end;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/* … */
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);
    goto __pyx_L1_error;
    __pyx_L4_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);
    __pyx_L8_try_end:;
  }
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">741</span>:         key = flag.encode('utf8')</pre>
<pre class='cython code score-26 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_flag, __pyx_n_s_encode);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 741, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        }
      }
      __pyx_t_5 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_n_s_utf8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_n_s_utf8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 741, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_t_5))||((__pyx_t_5) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_5)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 741, __pyx_L3_error)</span>
      __pyx_v_key = ((PyObject*)__pyx_t_5);
      __pyx_t_5 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">742</span>:     except AttributeError:</pre>
<pre class='cython code score-6 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(__pyx_builtin_AttributeError);
    if (__pyx_t_8) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo._coords_inv_d", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_5, &amp;__pyx_t_6, &amp;__pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 742, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">743</span>:         key = flag</pre>
<pre class='cython code score-15 '>      if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_v_flag))||((__pyx_v_flag) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_v_flag)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 743, __pyx_L5_except_error)</span>
      __pyx_t_9 = __pyx_v_flag;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_key, ((PyObject*)__pyx_t_9));
      __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L4_exception_handled;
    }
    goto __pyx_L5_except_error;
    __pyx_L5_except_error:;
</pre><pre class="cython line score-0">&#xA0;<span class="">744</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">745</span>:     if key == b"fi":</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_fi, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_10 != 0);
  if (__pyx_t_11) {
/* … */
    goto __pyx_L11;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">746</span>:         x = rb*cos(phi)+rb*(phi-geo.phi_fi0)*sin(phi)</pre>
<pre class='cython code score-0 '>    __pyx_v_x = ((__pyx_v_rb * cos(__pyx_v_phi)) + ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_fi0)) * sin(__pyx_v_phi)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">747</span>:         y = rb*sin(phi)-rb*(phi-geo.phi_fi0)*cos(phi)</pre>
<pre class='cython code score-0 '>    __pyx_v_y = ((__pyx_v_rb * sin(__pyx_v_phi)) - ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_fi0)) * cos(__pyx_v_phi)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">748</span>:     elif key == b"fo":</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_fo, Py_EQ)); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 748, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_11 != 0);
  if (__pyx_t_10) {
/* … */
    goto __pyx_L11;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">749</span>:         x = rb*cos(phi)+rb*(phi-geo.phi_fo0)*sin(phi)</pre>
<pre class='cython code score-0 '>    __pyx_v_x = ((__pyx_v_rb * cos(__pyx_v_phi)) + ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_fo0)) * sin(__pyx_v_phi)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">750</span>:         y = rb*sin(phi)-rb*(phi-geo.phi_fo0)*cos(phi)</pre>
<pre class='cython code score-0 '>    __pyx_v_y = ((__pyx_v_rb * sin(__pyx_v_phi)) - ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_fo0)) * cos(__pyx_v_phi)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">751</span>:     elif key == b"oi":</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_oi, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 751, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_10 != 0);
  if (__pyx_t_11) {
/* … */
    goto __pyx_L11;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">752</span>:         x = -rb*cos(phi)-rb*(phi-geo.phi_oi0)*sin(phi)+ro*cos(om)</pre>
<pre class='cython code score-0 '>    __pyx_v_x = ((((-__pyx_v_rb) * cos(__pyx_v_phi)) - ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_oi0)) * sin(__pyx_v_phi))) + (__pyx_v_ro * cos(__pyx_v_om)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">753</span>:         y = -rb*sin(phi)+rb*(phi-geo.phi_oi0)*cos(phi)+ro*sin(om)</pre>
<pre class='cython code score-0 '>    __pyx_v_y = ((((-__pyx_v_rb) * sin(__pyx_v_phi)) + ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_oi0)) * cos(__pyx_v_phi))) + (__pyx_v_ro * sin(__pyx_v_om)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">754</span>:     elif key == b"oo":</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyBytes_Equals</span>(__pyx_v_key, __pyx_n_b_oo, Py_EQ)); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 754, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_11 != 0);
  if (likely(__pyx_t_10)) {
/* … */
    goto __pyx_L11;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">755</span>:         x = -rb*cos(phi)-rb*(phi-geo.phi_oo0)*sin(phi)+ro*cos(om)</pre>
<pre class='cython code score-0 '>    __pyx_v_x = ((((-__pyx_v_rb) * cos(__pyx_v_phi)) - ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_oo0)) * sin(__pyx_v_phi))) + (__pyx_v_ro * cos(__pyx_v_om)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">756</span>:         y = -rb*sin(phi)+rb*(phi-geo.phi_oo0)*cos(phi)+ro*sin(om)</pre>
<pre class='cython code score-0 '>    __pyx_v_y = ((((-__pyx_v_rb) * sin(__pyx_v_phi)) + ((__pyx_v_rb * (__pyx_v_phi - __pyx_v_geo-&gt;phi_oo0)) * cos(__pyx_v_phi))) + (__pyx_v_ro * sin(__pyx_v_om)));
</pre><pre class="cython line score-0">&#xA0;<span class="">757</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">758</span>:         raise ValueError('flag not valid')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 758, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='error_goto'>__PYX_ERR(0, 758, __pyx_L1_error)</span>
  }
  __pyx_L11:;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">759</span>:     return (x,y)</pre>
<pre class='cython code score-18 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 759, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 759, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 759, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_6);
  __pyx_t_7 = 0;
  __pyx_t_6 = 0;
  __pyx_r = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">760</span>: </pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">761</span>: cpdef tuple coords_inv(phi,geoVals geo,double theta,flag="fi"):</pre>
<pre class='cython code score-53 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_47coords_inv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(PyObject *__pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_5PDSim_6scroll_17common_scroll_geo_coords_inv *__pyx_optional_args) {
  PyObject *__pyx_v_flag = ((PyObject *)__pyx_n_s_fi);
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("coords_inv", 0);
  <span class='trace'>__Pyx_TraceCall</span>("coords_inv", __pyx_f[0], 761, 0, <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_flag = __pyx_optional_args-&gt;flag;
    }
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.coords_inv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_47coords_inv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_46coords_inv[] = "coords_inv(phi, geoVals geo, double theta, flag='fi') -&gt; tuple\n \n    \n    def coords_inv(phi,geo,theta,flag=\"fi\")\n    \n    The involute angles corresponding to the points along the involutes\n    (fixed inner [fi], fixed scroll outer involute [fo], orbiting\n    scroll outer involute [oo], and orbiting scroll inner involute [oi] )\n    \n    Arguments:\n        phi_vec : 1D numpy array or double\n            vector of involute angles\n        geo : geoVals class\n            scroll compressor geometry\n        theta : float\n            crank angle in the range 0 to :math: `2\\pi`\n        flag : string\n            involute of interest, possible values are 'fi','fo','oi','oo'\n            \n    Returns:\n        (x,y) : tuple of coordinates on the scroll\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_47coords_inv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_phi = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  PyObject *__pyx_v_flag = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("coords_inv (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_phi,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_flag,0};
    PyObject* values[4] = {0,0,0,0};
    values[3] = ((PyObject *)__pyx_n_s_fi);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("coords_inv", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("coords_inv", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_flag);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "coords_inv") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_phi = values[0];
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L3_error)</span>
    __pyx_v_flag = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("coords_inv", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.coords_inv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_46coords_inv(__pyx_self, __pyx_v_phi, __pyx_v_geo, __pyx_v_theta, __pyx_v_flag);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_46coords_inv(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_phi, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, PyObject *__pyx_v_flag) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("coords_inv", 0);
  <span class='trace'>__Pyx_TraceCall</span>("coords_inv (wrapper)", __pyx_f[0], 761, 0, <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.flag = __pyx_v_flag;
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_inv(__pyx_v_phi, __pyx_v_geo, __pyx_v_theta, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.coords_inv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">762</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">763</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">764</span>:     def coords_inv(phi,geo,theta,flag="fi")</pre>
<pre class="cython line score-0">&#xA0;<span class="">765</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">766</span>:     The involute angles corresponding to the points along the involutes</pre>
<pre class="cython line score-0">&#xA0;<span class="">767</span>:     (fixed inner [fi], fixed scroll outer involute [fo], orbiting</pre>
<pre class="cython line score-0">&#xA0;<span class="">768</span>:     scroll outer involute [oo], and orbiting scroll inner involute [oi] )</pre>
<pre class="cython line score-0">&#xA0;<span class="">769</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">770</span>:     Arguments:</pre>
<pre class="cython line score-0">&#xA0;<span class="">771</span>:         phi_vec : 1D numpy array or double</pre>
<pre class="cython line score-0">&#xA0;<span class="">772</span>:             vector of involute angles</pre>
<pre class="cython line score-0">&#xA0;<span class="">773</span>:         geo : geoVals class</pre>
<pre class="cython line score-0">&#xA0;<span class="">774</span>:             scroll compressor geometry</pre>
<pre class="cython line score-0">&#xA0;<span class="">775</span>:         theta : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">776</span>:             crank angle in the range 0 to :math: `2\pi`</pre>
<pre class="cython line score-0">&#xA0;<span class="">777</span>:         flag : string</pre>
<pre class="cython line score-0">&#xA0;<span class="">778</span>:             involute of interest, possible values are 'fi','fo','oi','oo'</pre>
<pre class="cython line score-0">&#xA0;<span class="">779</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">780</span>:     Returns:</pre>
<pre class="cython line score-0">&#xA0;<span class="">781</span>:         (x,y) : tuple of coordinates on the scroll</pre>
<pre class="cython line score-0">&#xA0;<span class="">782</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">783</span>:     if type(phi) is np.ndarray:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((PyObject *)Py_TYPE(__pyx_v_phi)) == ((PyObject *)__pyx_ptype_5numpy_ndarray));
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">784</span>:         return _coords_inv_np(phi,geo,theta,flag)</pre>
<pre class='cython code score-3 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (!(likely(((__pyx_v_phi) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_phi, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 784, __pyx_L1_error)</span>
    __pyx_t_4.__pyx_n = 1;
    __pyx_t_4.flag = __pyx_v_flag;
    __pyx_t_3 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_np(((PyArrayObject *)__pyx_v_phi), __pyx_v_geo, __pyx_v_theta, 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 784, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">785</span>:     else:</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">786</span>:         return _coords_inv_d(phi,geo,theta,flag)</pre>
<pre class='cython code score-11 '>  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 786, __pyx_L1_error)</span>
    __pyx_t_6.__pyx_n = 1;
    __pyx_t_6.flag = __pyx_v_flag;
    __pyx_t_3 = __pyx_f_5PDSim_6scroll_17common_scroll_geo__coords_inv_d(__pyx_t_5, __pyx_v_geo, __pyx_v_theta, 0, &amp;__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">787</span>: </pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">788</span>: cpdef tuple coords_norm(phi_vec, geoVals geo, double theta,flag="fi"):</pre>
<pre class='cython code score-63 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_49coords_norm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_norm(PyObject *__pyx_v_phi_vec, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, CYTHON_UNUSED double __pyx_v_theta, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_5PDSim_6scroll_17common_scroll_geo_coords_norm *__pyx_optional_args) {
  PyObject *__pyx_v_flag = ((PyObject *)__pyx_n_s_fi);
  CYTHON_UNUSED double __pyx_v_rb;
  PyObject *__pyx_v_nx = NULL;
  PyObject *__pyx_v_ny = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_phi = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("coords_norm", 0);
  <span class='trace'>__Pyx_TraceCall</span>("coords_norm", __pyx_f[0], 788, 0, <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_flag = __pyx_optional_args-&gt;flag;
    }
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_phi_vec);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.coords_norm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_phi);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_phi_vec);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_49coords_norm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_48coords_norm[] = "coords_norm(phi_vec, geoVals geo, double theta, flag='fi') -&gt; tuple\n \n    The x and y coordinates of a unit normal vector pointing towards\n    the scroll involute for the the involutes\n    (fixed inner [fi], fixed scroll outer involute [fo], orbiting\n    scroll outer involute [oo], and orbiting scroll inner involute [oi])\n    \n    Arguments:\n        phi_vec : 1D numpy array\n            vector of involute angles\n        geo : geoVals class\n            scroll compressor geometry\n        theta : float\n            crank angle in the range 0 to :math: `2\\pi`\n        flag : string\n            involute of interest, possible values are 'fi','fo','oi','oo'\n            \n    Returns:\n        (nx,ny) : tuple of unit normal coordinates pointing towards scroll wrap\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_49coords_norm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_phi_vec = 0;
  struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo = 0;
  double __pyx_v_theta;
  PyObject *__pyx_v_flag = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("coords_norm (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_phi_vec,&amp;__pyx_n_s_geo,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_flag,0};
    PyObject* values[4] = {0,0,0,0};
    values[3] = ((PyObject *)__pyx_n_s_fi);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi_vec)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_geo)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("coords_norm", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_theta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("coords_norm", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_flag);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "coords_norm") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_phi_vec = values[0];
    __pyx_v_geo = ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)values[1]);
    __pyx_v_theta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_theta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L3_error)</span>
    __pyx_v_flag = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("coords_norm", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.coords_norm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_48coords_norm(__pyx_self, __pyx_v_phi_vec, __pyx_v_geo, __pyx_v_theta, __pyx_v_flag);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_48coords_norm(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_phi_vec, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, double __pyx_v_theta, PyObject *__pyx_v_flag) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("coords_norm", 0);
  <span class='trace'>__Pyx_TraceCall</span>("coords_norm (wrapper)", __pyx_f[0], 788, 0, <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.flag = __pyx_v_flag;
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_coords_norm(__pyx_v_phi_vec, __pyx_v_geo, __pyx_v_theta, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 788, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.coords_norm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">789</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">790</span>:     The x and y coordinates of a unit normal vector pointing towards</pre>
<pre class="cython line score-0">&#xA0;<span class="">791</span>:     the scroll involute for the the involutes</pre>
<pre class="cython line score-0">&#xA0;<span class="">792</span>:     (fixed inner [fi], fixed scroll outer involute [fo], orbiting</pre>
<pre class="cython line score-0">&#xA0;<span class="">793</span>:     scroll outer involute [oo], and orbiting scroll inner involute [oi])</pre>
<pre class="cython line score-0">&#xA0;<span class="">794</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">795</span>:     Arguments:</pre>
<pre class="cython line score-0">&#xA0;<span class="">796</span>:         phi_vec : 1D numpy array</pre>
<pre class="cython line score-0">&#xA0;<span class="">797</span>:             vector of involute angles</pre>
<pre class="cython line score-0">&#xA0;<span class="">798</span>:         geo : geoVals class</pre>
<pre class="cython line score-0">&#xA0;<span class="">799</span>:             scroll compressor geometry</pre>
<pre class="cython line score-0">&#xA0;<span class="">800</span>:         theta : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">801</span>:             crank angle in the range 0 to :math: `2\pi`</pre>
<pre class="cython line score-0">&#xA0;<span class="">802</span>:         flag : string</pre>
<pre class="cython line score-0">&#xA0;<span class="">803</span>:             involute of interest, possible values are 'fi','fo','oi','oo'</pre>
<pre class="cython line score-0">&#xA0;<span class="">804</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">805</span>:     Returns:</pre>
<pre class="cython line score-0">&#xA0;<span class="">806</span>:         (nx,ny) : tuple of unit normal coordinates pointing towards scroll wrap</pre>
<pre class="cython line score-0">&#xA0;<span class="">807</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">808</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">809</span>:     rb=geo.rb</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_geo-&gt;rb;
  __pyx_v_rb = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">810</span>:     if not type(phi_vec) is np.ndarray:</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((PyObject *)Py_TYPE(__pyx_v_phi_vec)) != ((PyObject *)__pyx_ptype_5numpy_ndarray));
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">811</span>:         if type(phi_vec) is list:</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = (((PyObject *)Py_TYPE(__pyx_v_phi_vec)) == ((PyObject *)(&amp;PyList_Type)));
    __pyx_t_2 = (__pyx_t_3 != 0);
    if (__pyx_t_2) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">812</span>:             phi_vec=np.array(phi_vec)</pre>
<pre class='cython code score-20 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 812, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 812, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        }
      }
      __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_v_phi_vec) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_phi_vec);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_phi_vec, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">813</span>:         else:</pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">814</span>:             phi_vec=np.array([phi_vec])</pre>
<pre class='cython code score-28 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_phi_vec);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_phi_vec);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_phi_vec);
      __pyx_t_7 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        }
      }
      __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 814, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_phi_vec, __pyx_t_4);
      __pyx_t_4 = 0;
    }
    __pyx_L4:;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">815</span>:     nx=np.zeros(np.size(phi_vec))</pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 815, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 815, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 815, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 815, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
    }
  }
  __pyx_t_5 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_7, __pyx_v_phi_vec) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_v_phi_vec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 815, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_4 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_8, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 815, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_nx = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">816</span>:     ny=np.zeros(np.size(phi_vec))</pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_6 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_8, __pyx_v_phi_vec) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_v_phi_vec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_ny = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">817</span>: </pre>
<pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">818</span>:     for i in xrange(np.size(phi_vec)):</pre>
<pre class='cython code score-66 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_v_phi_vec) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_phi_vec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_xrange, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_6)) {
    __pyx_t_4 = __pyx_t_6; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_9 = 0;
    __pyx_t_10 = NULL;
  } else {
    __pyx_t_9 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_10 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  for (;;) {
    if (likely(!__pyx_t_10)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_9++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 818, __pyx_L1_error)</span>
        #else
        __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        #endif
      } else {
        if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_9++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 818, __pyx_L1_error)</span>
        #else
        __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        #endif
      }
    } else {
      __pyx_t_6 = __pyx_t_10(__pyx_t_4);
      if (unlikely(!__pyx_t_6)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 818, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_6);
    __pyx_t_6 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">819</span>:         phi=phi_vec[i]</pre>
<pre class='cython code score-3 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_phi_vec, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 819, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_phi, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">820</span>:         if flag=="fi":</pre>
<pre class='cython code score-2 '>    __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_flag, __pyx_n_s_fi, Py_EQ)); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 820, __pyx_L1_error)</span>
    if (__pyx_t_2) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">821</span>:             nx[i] = +sin(phi)</pre>
<pre class='cython code score-21 '>      __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 821, __pyx_L1_error)</span>
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(sin(__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 821, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_nx, __pyx_v_i, __pyx_t_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 821, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">822</span>:             ny[i] = -cos(phi)</pre>
<pre class='cython code score-21 '>      __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 822, __pyx_L1_error)</span>
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((-cos(__pyx_t_1)));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 822, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_ny, __pyx_v_i, __pyx_t_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 822, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">823</span>:         elif flag=="fo":</pre>
<pre class='cython code score-2 '>    __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_flag, __pyx_n_s_fo, Py_EQ)); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 823, __pyx_L1_error)</span>
    if (__pyx_t_2) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">824</span>:             nx[i] = -sin(phi)</pre>
<pre class='cython code score-21 '>      __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 824, __pyx_L1_error)</span>
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((-sin(__pyx_t_1)));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 824, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_nx, __pyx_v_i, __pyx_t_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 824, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">825</span>:             ny[i] = +cos(phi)</pre>
<pre class='cython code score-21 '>      __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 825, __pyx_L1_error)</span>
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(cos(__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 825, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_ny, __pyx_v_i, __pyx_t_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 825, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">826</span>:         elif flag=="oi":</pre>
<pre class='cython code score-2 '>    __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_flag, __pyx_n_s_oi, Py_EQ)); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 826, __pyx_L1_error)</span>
    if (__pyx_t_2) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">827</span>:             nx[i] = -sin(phi)</pre>
<pre class='cython code score-21 '>      __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 827, __pyx_L1_error)</span>
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((-sin(__pyx_t_1)));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 827, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_nx, __pyx_v_i, __pyx_t_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 827, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">828</span>:             ny[i] = +cos(phi)</pre>
<pre class='cython code score-21 '>      __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 828, __pyx_L1_error)</span>
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(cos(__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 828, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_ny, __pyx_v_i, __pyx_t_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 828, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">829</span>:         elif flag=="oo":</pre>
<pre class='cython code score-2 '>    __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_flag, __pyx_n_s_oo, Py_EQ)); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 829, __pyx_L1_error)</span>
    if (__pyx_t_2) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">830</span>:             nx[i] = +sin(phi)</pre>
<pre class='cython code score-21 '>      __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 830, __pyx_L1_error)</span>
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(sin(__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 830, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_nx, __pyx_v_i, __pyx_t_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 830, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">831</span>:             ny[i] = -cos(phi)</pre>
<pre class='cython code score-21 '>      __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_phi); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 831, __pyx_L1_error)</span>
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((-cos(__pyx_t_1)));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_ny, __pyx_v_i, __pyx_t_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 831, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">832</span>:         else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">833</span>:             print("Uh oh... error in coords_norm")</pre>
<pre class='cython code score-2 '>    /*else*/ {
      if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_Uh_oh_error_in_coords_norm) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 833, __pyx_L1_error)</span>
    }
    __pyx_L7:;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">834</span>:     return (nx,ny)</pre>
<pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 834, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_ny);
  __pyx_r = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">835</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">836</span>: cdef double x_antideriv(double phi, double phi_0):</pre>
<pre class='cython code score-2 '>static double __pyx_f_5PDSim_6scroll_17common_scroll_geo_x_antideriv(double __pyx_v_phi, double __pyx_v_phi_0) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("x_antideriv", 0);
  <span class='trace'>__Pyx_TraceCall</span>("x_antideriv", __pyx_f[0], 836, 0, <span class='error_goto'>__PYX_ERR(0, 836, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.x_antideriv", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">837</span>:     """ Antiderivative of function for x for scroll_wrap """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">838</span>:     return -cos(phi)*((phi_0-phi)**2-3)-3*sin(phi)*(phi_0-phi)</pre>
<pre class='cython code score-0 '>  __pyx_r = (((-cos(__pyx_v_phi)) * (pow((__pyx_v_phi_0 - __pyx_v_phi), 2.0) - 3.0)) - ((3.0 * sin(__pyx_v_phi)) * (__pyx_v_phi_0 - __pyx_v_phi)));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">839</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">840</span>: cdef double y_antideriv(double phi, double phi_0):</pre>
<pre class='cython code score-2 '>static double __pyx_f_5PDSim_6scroll_17common_scroll_geo_y_antideriv(double __pyx_v_phi, double __pyx_v_phi_0) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("y_antideriv", 0);
  <span class='trace'>__Pyx_TraceCall</span>("y_antideriv", __pyx_f[0], 840, 0, <span class='error_goto'>__PYX_ERR(0, 840, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.y_antideriv", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">841</span>:     """ Antiderivative of function for y for scroll_wrap """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">842</span>:     return +3*cos(phi)*(phi_0-phi)-sin(phi)*((phi_0-phi)**2-3)</pre>
<pre class='cython code score-0 '>  __pyx_r = (((3.0 * cos(__pyx_v_phi)) * (__pyx_v_phi_0 - __pyx_v_phi)) - (sin(__pyx_v_phi) * (pow((__pyx_v_phi_0 - __pyx_v_phi), 2.0) - 3.0)));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">843</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">844</span>: @cython.cdivision(True)</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">845</span>: cpdef tuple scroll_wrap(geoVals geo):</pre>
<pre class='cython code score-12 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_51scroll_wrap(PyObject *__pyx_self, PyObject *__pyx_v_geo); /*proto*/
static PyObject *__pyx_f_5PDSim_6scroll_17common_scroll_geo_scroll_wrap(struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_phi_0;
  double __pyx_v_phi_e;
  double __pyx_v_Vwrap;
  double __pyx_v_xstar;
  double __pyx_v_ystar;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scroll_wrap", 0);
  <span class='trace'>__Pyx_TraceCall</span>("scroll_wrap", __pyx_f[0], 845, 0, <span class='error_goto'>__PYX_ERR(0, 845, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.scroll_wrap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_51scroll_wrap(PyObject *__pyx_self, PyObject *__pyx_v_geo); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_50scroll_wrap[] = "scroll_wrap(geoVals geo) -&gt; tuple\n\n    Calculate the scroll wrap centroid and volume\n    ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_51scroll_wrap(PyObject *__pyx_self, PyObject *__pyx_v_geo) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scroll_wrap (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_geo), __pyx_ptype_5PDSim_6scroll_17common_scroll_geo_geoVals, 1, "geo", 0))) <span class='error_goto'>__PYX_ERR(0, 845, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_50scroll_wrap(__pyx_self, ((struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *)__pyx_v_geo));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_50scroll_wrap(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_5PDSim_6scroll_17common_scroll_geo_geoVals *__pyx_v_geo) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scroll_wrap", 0);
  <span class='trace'>__Pyx_TraceCall</span>("scroll_wrap (wrapper)", __pyx_f[0], 845, 0, <span class='error_goto'>__PYX_ERR(0, 845, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5PDSim_6scroll_17common_scroll_geo_scroll_wrap(__pyx_v_geo, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 845, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.scroll_wrap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">846</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">847</span>:     Calculate the scroll wrap centroid and volume</pre>
<pre class="cython line score-0">&#xA0;<span class="">848</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">849</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">850</span>:     # Initial angle of the centerline of the orbiting scroll wrap</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">851</span>:     cdef double phi_0 = (geo.phi_oi0 + geo.phi_oo0)/2</pre>
<pre class='cython code score-0 '>  __pyx_v_phi_0 = ((__pyx_v_geo-&gt;phi_oi0 + __pyx_v_geo-&gt;phi_oo0) / 2.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">852</span>:     # Ending angle of the centerline of the orbiting scroll wrap</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">853</span>:     cdef double phi_e = (geo.phi_oie + geo.phi_ooe)/2</pre>
<pre class='cython code score-0 '>  __pyx_v_phi_e = ((__pyx_v_geo-&gt;phi_oie + __pyx_v_geo-&gt;phi_ooe) / 2.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">854</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">855</span>:     Vwrap = geo.h*geo.rb*geo.t*(phi_e**2/2.0-phi_0**2/2.0-(phi_e-phi_0)*phi_0)</pre>
<pre class='cython code score-0 '>  __pyx_v_Vwrap = (((__pyx_v_geo-&gt;h * __pyx_v_geo-&gt;rb) * __pyx_v_geo-&gt;t) * (((pow(__pyx_v_phi_e, 2.0) / 2.0) - (pow(__pyx_v_phi_0, 2.0) / 2.0)) - ((__pyx_v_phi_e - __pyx_v_phi_0) * __pyx_v_phi_0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">856</span>:     xstar = geo.h*geo.rb**2*geo.t/Vwrap*(x_antideriv(phi_e, phi_0)-x_antideriv(phi_0, phi_0))</pre>
<pre class='cython code score-0 '>  __pyx_v_xstar = ((((__pyx_v_geo-&gt;h * pow(__pyx_v_geo-&gt;rb, 2.0)) * __pyx_v_geo-&gt;t) / __pyx_v_Vwrap) * (__pyx_f_5PDSim_6scroll_17common_scroll_geo_x_antideriv(__pyx_v_phi_e, __pyx_v_phi_0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_x_antideriv(__pyx_v_phi_0, __pyx_v_phi_0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">857</span>:     ystar = geo.h*geo.rb**2*geo.t/Vwrap*(y_antideriv(phi_e, phi_0)-y_antideriv(phi_0, phi_0))</pre>
<pre class='cython code score-0 '>  __pyx_v_ystar = ((((__pyx_v_geo-&gt;h * pow(__pyx_v_geo-&gt;rb, 2.0)) * __pyx_v_geo-&gt;t) / __pyx_v_Vwrap) * (__pyx_f_5PDSim_6scroll_17common_scroll_geo_y_antideriv(__pyx_v_phi_e, __pyx_v_phi_0) - __pyx_f_5PDSim_6scroll_17common_scroll_geo_y_antideriv(__pyx_v_phi_0, __pyx_v_phi_0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">858</span>: </pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">859</span>:     return Vwrap, xstar, ystar</pre>
<pre class='cython code score-24 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_Vwrap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_xstar);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ystar);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_r = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">860</span>: </pre>
<pre class="cython line score-183" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">861</span>: cpdef double involute_heat_transfer(double hc, double hs, double  rb,</pre>
<pre class='cython code score-183 '>static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_53involute_heat_transfer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_5PDSim_6scroll_17common_scroll_geo_involute_heat_transfer(double __pyx_v_hc, double __pyx_v_hs, double __pyx_v_rb, double __pyx_v_phi1, double __pyx_v_phi2, double __pyx_v_phi0, double __pyx_v_T_scroll, double __pyx_v_T_CV, double __pyx_v_dT_dphi, double __pyx_v_phim, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_term1;
  double __pyx_v_term2;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("involute_heat_transfer", 0);
  <span class='trace'>__Pyx_TraceCall</span>("involute_heat_transfer", __pyx_f[0], 861, 0, <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.involute_heat_transfer", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_53involute_heat_transfer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5PDSim_6scroll_17common_scroll_geo_52involute_heat_transfer[] = "involute_heat_transfer(double hc, double hs, double rb, double phi1, double phi2, double phi0, double T_scroll, double T_CV, double dT_dphi, double phim) -&gt; double\n\n        This function evaluates the anti-derivative of \n        the differential of involute heat transfer, and returns the amount of scroll-\n        wall heat transfer in kW\n        \n        Parameters\n        ----------\n        hc : float\n            Heat transfer coefficient [kW/m2/K]\n        hs : float\n            Scroll wrap height [m]\n        rb : float\n            Base circle radius [m]\n        phi1 : float\n            Larger involute angle [rad]\n        phi2 : float\n            Smaller involute angle [rad]\n        phi0 : float\n            Initial involute angle [rad]\n        T_scroll : float\n            Lump temperature of the scroll wrap [K]\n        T_CV : float\n            Temperature of the gas in the CV [K]\n        dT_dphi : float\n            Derivative of the temperature along the scroll wrap [K/rad]\n        phim : float\n            Mean involute angle of wrap used for heat transfer [rad]\n        \n        Notes\n        -----\n        ``phi1`` and ``phi2`` are defined such that ``phi1`` is always the\n        larger involute angle in value\n        ";
static PyObject *__pyx_pw_5PDSim_6scroll_17common_scroll_geo_53involute_heat_transfer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_hc;
  double __pyx_v_hs;
  double __pyx_v_rb;
  double __pyx_v_phi1;
  double __pyx_v_phi2;
  double __pyx_v_phi0;
  double __pyx_v_T_scroll;
  double __pyx_v_T_CV;
  double __pyx_v_dT_dphi;
  double __pyx_v_phim;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("involute_heat_transfer (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_hc,&amp;__pyx_n_s_hs,&amp;__pyx_n_s_rb,&amp;__pyx_n_s_phi1,&amp;__pyx_n_s_phi2,&amp;__pyx_n_s_phi0,&amp;__pyx_n_s_T_scroll,&amp;__pyx_n_s_T_CV,&amp;__pyx_n_s_dT_dphi,&amp;__pyx_n_s_phim,0};
    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_hc)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_hs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("involute_heat_transfer", 1, 10, 10, 1); <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_rb)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("involute_heat_transfer", 1, 10, 10, 2); <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("involute_heat_transfer", 1, 10, 10, 3); <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("involute_heat_transfer", 1, 10, 10, 4); <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("involute_heat_transfer", 1, 10, 10, 5); <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_T_scroll)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("involute_heat_transfer", 1, 10, 10, 6); <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_T_CV)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("involute_heat_transfer", 1, 10, 10, 7); <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dT_dphi)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("involute_heat_transfer", 1, 10, 10, 8); <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("involute_heat_transfer", 1, 10, 10, 9); <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "involute_heat_transfer") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 10) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
    }
    __pyx_v_hc = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_hc == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
    __pyx_v_hs = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_hs == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
    __pyx_v_rb = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_rb == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
    __pyx_v_phi1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_phi1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
    __pyx_v_phi2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_phi2 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
    __pyx_v_phi0 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_phi0 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
    __pyx_v_T_scroll = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]); if (unlikely((__pyx_v_T_scroll == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L3_error)</span>
    __pyx_v_T_CV = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[7]); if (unlikely((__pyx_v_T_CV == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L3_error)</span>
    __pyx_v_dT_dphi = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[8]); if (unlikely((__pyx_v_dT_dphi == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L3_error)</span>
    __pyx_v_phim = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[9]); if (unlikely((__pyx_v_phim == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 864, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("involute_heat_transfer", 1, 10, 10, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.involute_heat_transfer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5PDSim_6scroll_17common_scroll_geo_52involute_heat_transfer(__pyx_self, __pyx_v_hc, __pyx_v_hs, __pyx_v_rb, __pyx_v_phi1, __pyx_v_phi2, __pyx_v_phi0, __pyx_v_T_scroll, __pyx_v_T_CV, __pyx_v_dT_dphi, __pyx_v_phim);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5PDSim_6scroll_17common_scroll_geo_52involute_heat_transfer(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_hc, double __pyx_v_hs, double __pyx_v_rb, double __pyx_v_phi1, double __pyx_v_phi2, double __pyx_v_phi0, double __pyx_v_T_scroll, double __pyx_v_T_CV, double __pyx_v_dT_dphi, double __pyx_v_phim) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("involute_heat_transfer", 0);
  <span class='trace'>__Pyx_TraceCall</span>("involute_heat_transfer (wrapper)", __pyx_f[0], 861, 0, <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_5PDSim_6scroll_17common_scroll_geo_involute_heat_transfer(__pyx_v_hc, __pyx_v_hs, __pyx_v_rb, __pyx_v_phi1, __pyx_v_phi2, __pyx_v_phi0, __pyx_v_T_scroll, __pyx_v_T_CV, __pyx_v_dT_dphi, __pyx_v_phim, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 861, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("PDSim.scroll.common_scroll_geo.involute_heat_transfer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">862</span>:                                   double phi1, double phi2, double phi0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">863</span>:                                   double T_scroll, double T_CV, double dT_dphi,</pre>
<pre class="cython line score-0">&#xA0;<span class="">864</span>:                                   double phim):</pre>
<pre class="cython line score-0">&#xA0;<span class="">865</span>:         """</pre>
<pre class="cython line score-0">&#xA0;<span class="">866</span>:         This function evaluates the anti-derivative of</pre>
<pre class="cython line score-0">&#xA0;<span class="">867</span>:         the differential of involute heat transfer, and returns the amount of scroll-</pre>
<pre class="cython line score-0">&#xA0;<span class="">868</span>:         wall heat transfer in kW</pre>
<pre class="cython line score-0">&#xA0;<span class="">869</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">870</span>:         Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">871</span>:         ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">872</span>:         hc : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">873</span>:             Heat transfer coefficient [kW/m2/K]</pre>
<pre class="cython line score-0">&#xA0;<span class="">874</span>:         hs : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">875</span>:             Scroll wrap height [m]</pre>
<pre class="cython line score-0">&#xA0;<span class="">876</span>:         rb : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">877</span>:             Base circle radius [m]</pre>
<pre class="cython line score-0">&#xA0;<span class="">878</span>:         phi1 : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">879</span>:             Larger involute angle [rad]</pre>
<pre class="cython line score-0">&#xA0;<span class="">880</span>:         phi2 : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">881</span>:             Smaller involute angle [rad]</pre>
<pre class="cython line score-0">&#xA0;<span class="">882</span>:         phi0 : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">883</span>:             Initial involute angle [rad]</pre>
<pre class="cython line score-0">&#xA0;<span class="">884</span>:         T_scroll : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">885</span>:             Lump temperature of the scroll wrap [K]</pre>
<pre class="cython line score-0">&#xA0;<span class="">886</span>:         T_CV : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">887</span>:             Temperature of the gas in the CV [K]</pre>
<pre class="cython line score-0">&#xA0;<span class="">888</span>:         dT_dphi : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">889</span>:             Derivative of the temperature along the scroll wrap [K/rad]</pre>
<pre class="cython line score-0">&#xA0;<span class="">890</span>:         phim : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">891</span>:             Mean involute angle of wrap used for heat transfer [rad]</pre>
<pre class="cython line score-0">&#xA0;<span class="">892</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">893</span>:         Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">894</span>:         -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">895</span>:         ``phi1`` and ``phi2`` are defined such that ``phi1`` is always the</pre>
<pre class="cython line score-0">&#xA0;<span class="">896</span>:         larger involute angle in value</pre>
<pre class="cython line score-0">&#xA0;<span class="">897</span>:         """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">898</span>:         term1=hc*hs*rb*( (phi1*phi1/2.0-phi0*phi1)*(T_scroll-T_CV)</pre>
<pre class='cython code score-0 '>  __pyx_v_term1 = (((__pyx_v_hc * __pyx_v_hs) * __pyx_v_rb) * (((((__pyx_v_phi1 * __pyx_v_phi1) / 2.0) - (__pyx_v_phi0 * __pyx_v_phi1)) * (__pyx_v_T_scroll - __pyx_v_T_CV)) + (__pyx_v_dT_dphi * (((((__pyx_v_phi1 * __pyx_v_phi1) * __pyx_v_phi1) / 3.0) - ((((__pyx_v_phi0 + __pyx_v_phim) * __pyx_v_phi1) * __pyx_v_phi1) / 2.0)) + ((__pyx_v_phi0 * __pyx_v_phim) * __pyx_v_phi1)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">899</span>:             +dT_dphi*(phi1*phi1*phi1/3.0-(phi0+phim)*phi1*phi1/2.0+phi0*phim*phi1))</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">900</span>:         term2=hc*hs*rb*( (phi2*phi2/2.0-phi0*phi2)*(T_scroll-T_CV)</pre>
<pre class='cython code score-0 '>  __pyx_v_term2 = (((__pyx_v_hc * __pyx_v_hs) * __pyx_v_rb) * (((((__pyx_v_phi2 * __pyx_v_phi2) / 2.0) - (__pyx_v_phi0 * __pyx_v_phi2)) * (__pyx_v_T_scroll - __pyx_v_T_CV)) + (__pyx_v_dT_dphi * (((((__pyx_v_phi2 * __pyx_v_phi2) * __pyx_v_phi2) / 3.0) - ((((__pyx_v_phi0 + __pyx_v_phim) * __pyx_v_phi2) * __pyx_v_phi2) / 2.0)) + ((__pyx_v_phi0 * __pyx_v_phim) * __pyx_v_phi2)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">901</span>:             +dT_dphi*(phi2*phi2*phi2/3.0-(phi0+phim)*phi2*phi2/2.0+phi0*phim*phi2))</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">902</span>:         return term1-term2;</pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_term1 - __pyx_v_term2);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">903</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">904</span>: cdef bint overlap(double minv1, double maxv1, double minv2, double maxv2, double *min, double *max):</pre>
<pre class='cython code score-2 '>static int __pyx_f_5PDSim_6scroll_17common_scroll_geo_overlap(double __pyx_v_minv1, double __pyx_v_maxv1, double __pyx_v_minv2, double __pyx_v_maxv2, double *__pyx_v_min, double *__pyx_v_max) {
  double __pyx_v_e;
  double __pyx_v__min;
  double __pyx_v__max;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("overlap", 0);
  <span class='trace'>__Pyx_TraceCall</span>("overlap", __pyx_f[0], 904, 0, <span class='error_goto'>__PYX_ERR(0, 904, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("PDSim.scroll.common_scroll_geo.overlap", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">905</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">906</span>:     Returns True if the ranges overlap, with the pointers to the overlap range</pre>
<pre class="cython line score-0">&#xA0;<span class="">907</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">908</span>:     cdef double e = 1e-14 #epsilon to deal with floating point accuracy</pre>
<pre class='cython code score-0 '>  __pyx_v_e = 1e-14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">909</span>:     cdef double _min = max2(minv1, minv2)</pre>
<pre class='cython code score-0 '>  __pyx_v__min = __pyx_f_5PDSim_6scroll_17common_scroll_geo_max2(__pyx_v_minv1, __pyx_v_minv2, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">910</span>:     cdef double _max = min2(maxv1, maxv2)</pre>
<pre class='cython code score-0 '>  __pyx_v__max = __pyx_f_5PDSim_6scroll_17common_scroll_geo_min2(__pyx_v_maxv1, __pyx_v_maxv2, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">911</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">912</span>:     if minv1-e &lt;= _max &lt;= maxv1+e and minv2-e &lt;= _max &lt;= maxv2+e and minv1-e &lt;= _min &lt;= maxv2+e and minv2-e &lt;= _min &lt;= maxv2+e:</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_minv1 - __pyx_v_e) &lt;= __pyx_v__max);
  if (__pyx_t_2) {
    __pyx_t_2 = (__pyx_v__max &lt;= (__pyx_v_maxv1 + __pyx_v_e));
  }
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
  } else {
    __pyx_t_1 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = ((__pyx_v_minv2 - __pyx_v_e) &lt;= __pyx_v__max);
  if (__pyx_t_3) {
    __pyx_t_3 = (__pyx_v__max &lt;= (__pyx_v_maxv2 + __pyx_v_e));
  }
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_minv1 - __pyx_v_e) &lt;= __pyx_v__min);
  if (__pyx_t_2) {
    __pyx_t_2 = (__pyx_v__min &lt;= (__pyx_v_maxv2 + __pyx_v_e));
  }
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
  } else {
    __pyx_t_1 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = ((__pyx_v_minv2 - __pyx_v_e) &lt;= __pyx_v__min);
  if (__pyx_t_3) {
    __pyx_t_3 = (__pyx_v__min &lt;= (__pyx_v_maxv2 + __pyx_v_e));
  }
  __pyx_t_2 = (__pyx_t_3 != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">913</span>:         min[0] = _min</pre>
<pre class='cython code score-0 '>    (__pyx_v_min[0]) = __pyx_v__min;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">914</span>:         max[0] = _max</pre>
<pre class='cython code score-0 '>    (__pyx_v_max[0]) = __pyx_v__max;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">915</span>:         return True</pre>
<pre class='cython code score-0 '>    __pyx_r = 1;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">916</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">917</span>:         return False</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = 0;
    goto __pyx_L0;
  }
</pre></div></body></html>
